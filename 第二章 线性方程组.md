# 第二章 线性方程组

### 矩阵乘法

本章中我们将考察更加一般的线性方程组：
$$
\begin{cases} a_{1, 1} x_1 + \cdots + a_{1, n} x_n = b_1 \\ \cdots \\ a_{m, 1} x_1 + \cdots + a_{m, n} x_n = b_n \end{cases}
$$
记其系数矩阵为：
$$
\mathbf{A} = \begin{bmatrix} a_{1, 1} & \cdots & a_{1, n} \\ \vdots & & \vdots \\ a_{m, 1} & \cdots & a_{m, n} \end{bmatrix}
$$
记向量乘法：
$$
\mathbf{a}_i = \begin{bmatrix} a_{i, 1} & \cdots & a_{i, n} \end{bmatrix} \\
\mathbf{x} = \begin{bmatrix} x_1 & \cdots & x_n \end{bmatrix}^T \\
\mathbf{a}_i \mathbf{x} = \sum_{j = 1}^n a_{i, j} x_j
$$
等号右侧的数可以视作 $1 \times 1$ 矩阵。把 $m$ 行拼起来有：
$$
\mathbf{b} = \begin{bmatrix} b_1 & \cdots & b_m \end{bmatrix}^T \\
\mathbf{A} \mathbf{x} = \mathbf{b}
$$
考虑进一步一般化：对于一些**系数矩阵一致**的线性方程组，我们可以将它们的 $x, b$ 拼起来吗？
$$
\mathbf{C} = \begin{bmatrix} \mathbf{c}_1 & \cdots & \mathbf{c}_k \end{bmatrix} \\
\mathbf{B} = \begin{bmatrix} \mathbf{b}_1 & \cdots & \mathbf{b}_k \end{bmatrix} \\
\mathbf{A} \mathbf{C} = \mathbf{B}
$$

- 为确保字母不冲突，这里用 $\mathbf{c}_i$ 表示未知数列向量。

注意到 $\mathbf{A}, \mathbf{C}, \mathbf{B}$ 的大小分别为 $m \times n, n \times k, m \times k$。

------

定义：$\mathbf{A} = (a_{i, j})_{m \times n}$ 与 $\mathbf{U} = (u_{i, j})_{n \times p}$ 的积为一个 $m \times p$ 的矩阵，记作 $\mathbf{V} = (v_{i, j})_{m \times p}$，满足 $v_{i, j} \equiv \displaystyle\sum_{k = 1}^n a_{i, k} u_{k, j}$。

计算口诀：行左列右，横山倒出。（见讲义 P44）

------

下面是初等行 / 列变换的矩阵，称作**初等变换阵**：
$$
\mathbf{P}_i(\lambda)_{m \times m} = \begin{bmatrix} 1 \\ & \ddots \\ & & \lambda \\ & & & \ddots \\ & & & & 1 \end{bmatrix} \\
\mathbf{P}_i(\lambda) \cdot \mathbf{A} = P_i(\lambda)(\mathbf{A})
$$

- 如 $\mathbf{P}_i(1)_{m \times m} = \mathbf{I}_m$，乘了以后不变。
- 同理有 $\mathbf{A} \cdot \mathbf{P}_i(\lambda) = Q_i(\lambda)(\mathbf{A})$。

$$
\mathbf{P}_{p, q}(\lambda)_{m \times m} = \begin{bmatrix} 1 \\ & \ddots \\ & & 1 \\ & & & \ddots \\ & & \lambda & & 1 \\ & & & & & \ddots \\ & & & & & & 1 \end{bmatrix} \\
\mathbf{P}_{p, q}(\lambda) \cdot \mathbf{A} = P_{p, q}(\lambda)(\mathbf{A})
$$

- 这里不妨钦定 $p < q$。**注意是下三角处为 $\lambda$！**
- 一个更直观的理解方式是将 $\mathbf{A}$ 写成行向量沿列堆叠的形式。
- 同理有 $\mathbf{A} \cdot \mathbf{P}_{q, p}(\lambda) = Q_{p, q}(\lambda)(\mathbf{P})$。**想一想为什么反过来了？**

$$
\mathbf{P}_{p, q}(\lambda)_{m \times m} = \begin{bmatrix} 1 \\ & \ddots \\ & & 1 \\ & & & 0 & & & & 1 \\ & & & & 1 \\ & & & & & \ddots \\ & & & & & & 1 \\ & & & 1 & & & & 0 \\ & & & & & & & & 1 \\ & & & & & & & & & \ddots \\ & & & & & & & & & & 1 \end{bmatrix} \\
\mathbf{P}_{p, q}(\lambda) \cdot \mathbf{A} = P_{p, q}(\lambda)(\mathbf{A})
$$

- 同样，这里不妨钦定 $p < q$。
- 同样，一个更直观的理解方式是将 $\mathbf{A}$ 写成行向量沿列堆叠的形式。
- 同理有 $\mathbf{A} \cdot \mathbf{P}_{p, q} = Q_{p, q}(\mathbf{A})$。

------

$$
\mathbf{A}_{m \times n} \cdot \mathbf{U}_{n \times p} = \begin{bmatrix} \mathbf{a}_1 \\ \vdots \\ \mathbf{a}_m \end{bmatrix} \begin{bmatrix} \tilde{\mathbf{u}}_1 & \cdots & \tilde{\mathbf{u}}_p \end{bmatrix} =  \begin{bmatrix} \tilde{\mathbf{a}}_1 & \cdots & \tilde{\mathbf{a}}_n \end{bmatrix} \begin{bmatrix} \mathbf{u}_1 \\ \vdots \\ \mathbf{u}_n \end{bmatrix}
$$

- 想一想，为什么？
- 前者行列向量之积 $\mathbf{a}_i \tilde{\mathbf{u}}_j$ 恰为我们期待的 $v_{i, j}$。
- 后者行列向量之积 $\tilde{\mathbf{a}}_k \mathbf{u}_k$ 恰好给每个 $v_{i, j}$ 提供了 $a_{i, k} u_{k, j}$ 的贡献。
- 感性地说，前者等价于对 $(i, j)$ 分别求和，后者等价于枚举 $k$ 贡献给 $(i, j)$。
- **注意每种表示乘出来的矩阵大小。**

#### 矩阵乘法与转置

$(\mathbf{A} \mathbf{B})^T = \mathbf{B}^T \mathbf{A}^T$（依据定义证明）。

### 高斯消去法

考虑增广矩阵 $[\mathbf{A} \mid \mathbf{b}]_{m \times (n + 1)}$，现在我们关心原方程组的解集。

#### 同解变换

若 $[\mathbf{A} \mid \mathbf{b}], [\hat{\mathbf{A}} \mid \hat{\mathbf{b}}]$ 对应的方程组同解，则该变换为同解变换，记作 $[\mathbf{A} \mid \mathbf{b}] \sim [\hat{\mathbf{A}} \mid \hat{\mathbf{b}}]$。

- 自反性：$a \sim a$。
- 对称性：$a \sim b \Leftrightarrow b \sim a$。
- 传递性：$a \sim b \sim c \Rightarrow a \sim c$。

#### 定理：初等行变换都是同解变换。

- 证明思路：前的解均为后的解，后的解均为前的解。
- 感性地说，原因在于变换可逆。

- **不能直接说前后等价，因为这里就是要证明它们等价**

------

#### 求解流程

[例] 讲义 P51 例 2.1

![](pictures/2-1.jpg)

下面形式化地描述高斯消去法。

经初等行变换，将增广矩阵变为阶梯阵 $[\mathbf{A} \mid \mathbf{b}]_{m \times (n + 1)}$。

设 $r$ 为变换后阶梯阵中系数矩阵中存在非零项的最后一行。对于 $i \in \mathbb{N}_+ \land i \leq r$，设 $s_i$ 表示阶梯阵第 $i$ 行首个非零的列指标。

1. $r < m \land b_{r + 1} \neq 0$：第 $r + 1$ 个方程为 $0 = b_{r + 1}$，不可能成立，无解。
2. $r = m \lor b_{r + 1} = 0$

此时称前 $r$ 个方程为有效方程。

- 2.1. 若 $r = n$，此时 $\forall i \in \mathbb{N}_+, i \leq n$，有 $a_{i, i} \neq 0$，则系数矩阵的行列式非 $0$，由 **Cramer 法则** 知原方程组有唯一解。
- 2.2. 若 $r < n$，记 $1 \sim n$ 中其他指标位于 $1 \leq s_{r + 1} < \cdots < s_n \leq n$，则将系数矩阵按**列**拆分为指标 $s_{\leq r}$ 和指标 $s_{> r}$ 的两个子式（记作 $\mathbf{A}_1, \mathbf{A}_2$），将未知数向量同样拆分为 $\mathbf{x}_1, \mathbf{x}_2$，令 $\mathbf{b}' = \begin{bmatrix} b_1 & \cdots & b_r \end{bmatrix}^T$，则 $\mathbf{A}_1 \mathbf{x}_1 = \mathbf{b}' - \mathbf{A}_2 \mathbf{x}_2$。此时 $\mathbf{A}_1$ 为 $r \times r$ 的**方阵**，故当我们确定了 $\mathbf{x}_2 \in \mathbb{R}^{n - r}$，由 **Cramer 法则** 知我们可以给出唯一的 $\mathbf{x}_1$。

最后有一个小问题：**自由变量 $s_{r + 1}, \cdots, s_n$ 的选取方式唯一吗？**

- 考虑方程 $x_1 + x_2 = 0$，你把哪个作为自由变量都是可以的。
- 但在消去过程中，我们并没有进行初等列变换，所以消出来的自由变量是唯一的。

### $n$ 维代数向量空间 $\mathbb{F}^n$

- 这里的 $\mathbb{F}$ 是一个数域 number field，比如 $\mathbb{R}, \mathbb{C}$。

记向量 $\mathbf{a} = (a_1, \cdots, a_n) \in \mathbb{F}^n$，其中 $a_i \in \mathbb{F}$。

#### 加法

交换律：$\mathbf{a} + \mathbf{b} = \mathbf{b} + \mathbf{a}$。

结合律：$\mathbf{a} + (\mathbf{b} + \mathbf{c}) = (\mathbf{a} + \mathbf{b}) + \mathbf{c}$。

零元：$\exists \mathbf{0} = (0, \cdots, 0) \in \mathbb{F}^n, \text{s.t. } \forall a \in \mathbb{F}^n, \mathbf{a} + \mathbf{0} = \mathbf{0} + \mathbf{a} = \mathbf{a}$。

负元 / 逆元：$\forall \mathbf{a} \in \mathbb{F}^n, \exists (-\mathbf{a}) \in \mathbb{F}^n, \text{s.t. } \mathbf{a} + (-\mathbf{a}) = (-\mathbf{a}) + \mathbf{a} = \mathbf{0}$。

- 注意：负元的存在性是**被定义**的，但这里的 $-\mathbf{a}$ 是记号而非一种对 $\mathbf{a}$ 的运算，因为我们还没有证明其唯一性。

#### 数乘

关于**向量**的分配律：$\lambda (\mathbf{a} + \mathbf{b}) = \lambda \mathbf{a} + \lambda \mathbf{b}$。

关于**标量**的分配律：$(\lambda + \mu) \mathbf{a} = \lambda \mathbf{a} + \mu \mathbf{a}$。

关于**标量**的结合律：$\lambda (\mu \mathbf{a}) = (\lambda \mu) \mathbf{a}$。

单位元 unit：$\exists 1 \in \mathbb{F}, \text{s.t. } \forall \mathbf{a} \in \mathbb{F}^n, 1 \cdot \mathbf{a} = \mathbf{a}$。

#### 基本性质

##### 性质 1

内容：$\mathbf{0}$ 为唯一零元。

证明：假设 $\mathbf{0}^*$ 也是，则用两次单位元性质可知 $\mathbf{0} = \mathbf{0}^*$。

##### 性质 2

内容：$\mathbf{0}^*$ 为单位元 $\Leftrightarrow \exists \mathbf{a}^* \in \mathbb{F}^n, \text{s.t. } \mathbf{a}^* + \mathbf{0}^* = \mathbf{a}^*$。

证明（**尽可能不使用数域自身的性质，而是用抽象出来的向量性质处理。**）：

- 前推后易证，下证后推前：

$$
\begin{align}
\forall \mathbf{a} \in \mathbb{F}^n, \mathbf{a} + \mathbf{0}^* &= \mathbf{a} + \mathbf{0} + \mathbf{0}^* \\
&= \mathbf{a} + (\mathbf{a}^* + (-\mathbf{a}^*)) + \mathbf{0}^* \\
&= \mathbf{a} + \mathbf{a}^* + ((-\mathbf{a}^*) + \mathbf{0}^*) \\
&= \mathbf{a} + \mathbf{a}^* + (-\mathbf{a}^*) \\
&= \mathbf{a} + (\mathbf{a}^* + (-\mathbf{a}^*)) \\
&= \mathbf{a} + \mathbf{0} \\
&= \mathbf{a}
\end{align}
$$

##### 性质 3

内容：$\forall a \in \mathbb{F}^n$，$a$ 的负元唯一。

证明：

- 假设 $\mathbf{a} \in \mathbb{F}^n$ 有不相等的两个逆元 $(-\mathbf{a}), \mathbf{b}$，则：

$$
\mathbf{b} = \mathbf{b} + (\mathbf{a} + (-\mathbf{a})) = (\mathbf{b} + \mathbf{a}) + (-\mathbf{a}) = \mathbf{0} + (-\mathbf{a}) = -\mathbf{a}
$$
- 故 $-\mathbf{b} = (-\mathbf{a})$，即假设不成立。又由逆元的存在性可知 $\mathbf{a}$ 的逆元唯一。

##### 性质 4

内容：$0 \cdot \mathbf{a} = \mathbf{0}$。

证明：
$$
\forall \mathbf{a} \in \mathbb{F}^n, 1 \cdot \mathbf{a} = (1 + 0) \cdot \mathbf{a} = 1 \cdot \mathbf{a} + 0 \cdot \mathbf{a} \Rightarrow 0 \cdot \mathbf{a} = \mathbf{0}
$$

##### 性质 5

内容：$\lambda \cdot \mathbf{0} = \mathbf{0}$。

证明：
$$
\lambda \cdot \mathbf{0} = \lambda \cdot (\mathbf{0} + \mathbf{0}) = \lambda \cdot \mathbf{0} + \lambda \cdot \mathbf{0} \Rightarrow \lambda \cdot \mathbf{0} = \mathbf{0}
$$

##### 性质 6

内容：$\lambda \cdot \mathbf{a} = \mathbf{0} \Leftrightarrow \lambda = 0 \lor \mathbf{a} = \mathbf{0}$。

证明：

- 后推前由性质 4, 5 易证，下证前推后：
- 考虑反证法，取 $\lambda \neq 0, \mathbf{a} \neq \mathbf{0}$，则 $\mathbf{a} = 1 \cdot \mathbf{a} = (\dfrac{1}{\lambda} \cdot \lambda) \cdot \mathbf{a} = \dfrac{1}{\lambda} \cdot (\lambda \cdot \mathbf{a}) = \dfrac{1}{\lambda} \cdot \mathbf{0} = \mathbf{0}$，与 $\mathbf{a} \neq \mathbf{0}$ 矛盾。

#### 减法

定义 $\mathbf{a} - \mathbf{b} \equiv \mathbf{a} + (-\mathbf{b})$。在实数中我们也是这样定义减法的。

#### 单位向量

定义单位向量 $\mathbf{e}_i \in \mathbb{F}^n$ 满足第 $j$ 个分量为 $[j = i]$，则我们可以将 $\mathbf{a} = (a_1, a_2, \cdots, a_n) \in \mathbb{F}^n$ **唯一地**表示为 $\displaystyle\sum_{i = 1}^n a_i \mathbf{e}_i$。

### 线性相关性

#### 线性相关

$\mathbf{a}_1, \mathbf{a}_2, \cdots, \mathbf{a}_m \in \mathbb{F}^n$，若 $\exists \lambda_1, \cdots, \lambda_m \in \mathbb{F}$ **不全**为 $0$，使得 $\displaystyle\sum_{i = 1}^m \lambda_i \mathbf{a}_i = \mathbf{0}$，则称 $\mathbf{a}_1, \cdots, \mathbf{a}_m$ 线性相关 linearly dependent，也可以说向量组 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}$ 线性相关。

- e.g. $\{\mathbf{a}_1, \cdots, \mathbf{a}_m, \mathbf{0}\}$ 线性相关。

#### 关于线性方程组

有解增广矩阵的列向量线性相关，因为可以取 $\lambda_1 = x_1, \cdots, \lambda_n = x_n, \lambda_{n + 1} = -1$。

#### 命题：$\mathbf{a}_1, \cdots, \mathbf{a}_m \in \mathbb{F}^n, m > n$，则 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}$ 线性相关。

设 $\mathbf{a}_i = (a_{1, i}, \cdots, a_{n, i})$，考察线性方程组 $\forall j \in \mathbb{N}_+ \land j \leq n, \displaystyle\sum_{i = 1}^m a_{j, i} x_i = 0$。

由于 $m > n$，未知数数量小于方程数量，由高斯消元法可知原方程有无数解。

因此，任取一组解，可得 $\displaystyle\sum_{i = 1}^m x_i \mathbf{a}_i = \mathbf{0}$，即 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}$ 线性相关。

#### 线性表出

$\mathbf{a}_1, \cdots, \mathbf{a}_m, \mathbf{b} \in \mathbb{F}^n$，若 $\exists \lambda_1, \cdots, \lambda_m \in \mathbb{F}$，使得 $\displaystyle\sum_{i = 1}^m \lambda_i \mathbf{a}_i = \mathbf{b}$，则称 $\mathbf{b}$ 可由 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}$ 线性表出。

若 $\{\mathbf{b}_1, \cdots, \mathbf{b}_s\}$ 中每一项均可由 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}$ 线性表出，则称 $\{\mathbf{b}_1, \cdots, \mathbf{b}_s\}$ 可由 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}$ 线性表出。

若 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\}, \{\mathbf{b}_1, \cdots, \mathbf{b}_s\}$ 分别可以线性表出对方，则称两者等价，即 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m\} \sim \{\mathbf{b}_1, \cdots, \mathbf{b}_s\}$。

- “同解变换”描述的就是“等价”。
