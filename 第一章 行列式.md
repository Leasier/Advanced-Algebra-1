# 第一章 行列式

### 矩阵 matrix

$n \times m$ 的数字阵列，第 $i$ 行第 $j$ 列为 $a_{i, j}$，方阵用 $[]$ 左右括起来，右下角加上下标 $n \times m$。也可记作 $\mathbf{A} = (a_{i, j})_{n \times m}$。其为 $n \times m$ 矩阵或 $(n, m)$ 阶矩阵。

任取一个 $a_{i, j}$ 称之为元素 entry / 分量 component。

------

矩阵可以被用来表示线性方程组，如：
$$
\begin{cases}
1 \cdot x_1 + 2 \cdot x_2 + 3 \cdot x_3 = 5 \\
3 \cdot x_1 - 2 \cdot x_2 - 4 \cdot x_3 = 7
\end{cases}
$$
可以被记作：
$$
\begin{bmatrix}
1 &2 &3 &5 \\
3 &-2 &4 &7
\end{bmatrix}
$$

------

$n = m$ 可称为方阵 square matrix。

$\forall i \neq j, a_{i, j} = 0$ 的方阵可称为对角阵 diagonal matrix。

$a_{i, i} = 1$ 的对角阵 $\mathbf{I}_n$ 可称为单位阵。

$a_{i, j} = 0$ 的方阵 $\mathbf{O}_n$ 可称为零矩阵。

$\forall i > j, a_{i, j} = 0$ 的方阵可称为上三角阵 upper triangular matrix，与之对应的是下三角阵。

### 向量 vector

列向量 column vector：$n \times 1$ 的数字阵列，一般在小写字母上加波浪号，可以视作矩阵的特殊情况，也可以视作截取矩阵列所得：
$$
\begin{align}
&\tilde{\mathbf{a}}_i = \begin{bmatrix}
a_{1, i} \\
a_{2, i} \\
\cdots \\
a_{n, i}
\end{bmatrix} \\
\Rightarrow &\mathbf{A} = [\tilde{\mathbf{a}}_1, \tilde{\mathbf{a}}_2, \cdots, \tilde{\mathbf{a}}_m]
\end{align}
$$
行向量 row vector：$1 \times n$ 的数字阵列。

### 矩阵转置 transpose

$(a_{i, j})_{n \times m} \to (b_{i, j})_{m \times n}$，$b_{i, j} = a_{j, i}$，记 $\mathbf{B} = \mathbf{A}^T$。

### 行列式 determinant

$\forall 1 \leq i \leq n, \displaystyle\sum_{j = 1}^n a_{i, j} x_j = b_i$，记其系数阵为方阵 $\mathbf{A} = (a_{i, j})_{n \times n}$，另取 $\mathbf{P} = (p_{i, j})_{n \times n + 1}$：$\forall j \leq n, p_{i, j} = a_{i, j}$，$p_{i, n + 1} = b_i$。

当 $n = 2$，解出：
$$
\begin{cases}
x_1 = \dfrac{a_{2, 2} b_1 - a_{1, 2} b_2}{a_{1, 1} a_{2, 2} - a_{1, 2} a_{2, 1}} \\
x_2 = \dfrac{-a_{2, 1} b_1 + a_{1, 1} b_2}{a_{1, 1} a_{2, 2} - a_{1, 2} a_{2, 1}}
\end{cases}
$$
注意到分母是一样的，定义这个 $\mathbf{A}$ 的行列式为 $a_{1, 1} a_{2, 2} - a_{1, 2} a_{2, 1}$。

-------

构造两个平面向量 $(a_{1, 1}, a_{2, 1})$ 和 $(a_{1, 2}, a_{2, 2})$，求平行四边形面积。

------

对于一个一般的 $n$ 阶方阵 $\mathbf{A} = (a_{i, j})_{n \times n}$，定义其行列式为：
$$
|\mathbf{A}| = \det(\mathbf{A}) = \sum_{\{j_1, j_2, \cdots, j_n\} = \{1, 2, \cdots, n\}} (-1)^{\tau(j)} \prod_{k = 1}^n a_{k, j_k}
$$
其中 $\tau(j)$ 为 $j$ 的逆序数，即逆序对的数量 $\# \{(p, q) \mid p < q, j_p > j_q\}$，此处 $\# S$ 表示集合 $S$ 的元素数量。

- 当 $n = 2$，$\det(\mathbf{A}) = a_{1, 1} a_{2, 2} - a_{1, 2} a_{2, 1}$。

- 当 $n = 3$，$\det(\mathbf{A}) = a_{1, 1} a_{2, 2} a_{3, 3} - a_{1, 1} a_{2, 3} a_{3, 2} - a_{1, 2} a_{2, 1} a_{3, 3} + a_{1, 2} a_{2, 3} a_{3, 1} + a_{1, 3} a_{2, 1} a_{3, 2} - a_{1, 3} a_{2, 2} a_{3, 1}$。

当 $\tau(j)$ 为奇数，称 $j$ 为奇排列；当 $\tau(j)$ 为偶数，称 $j$ 为偶排列。

------

[例] 求 $\begin{vmatrix} a_{1, 1} & & & \\ & a_{2, 2} & & \\ & & a_{3, 3} & \\  & & & a_{4, 4} \end{vmatrix}$。

由于非对角元均为 $0$，故仅有 $j_1 = 1, j_2 = 2, j_3 = 3, j_4 = 4$ 的单项可能非 $0$。

而 $\tau(1, 2, 3, 4) = 0$，则答案为 $(-1)^0 a_{1, 1} a_{2, 2} a_{3, 3} a_{4, 4} = a_{1, 1} a_{2, 2} a_{3, 3} a_{4, 4}$。

------

[例] 求 $\begin{vmatrix} & & & a_{1, 4} \\ & & a_{2, 3} & \\ & a_{3, 2} & & \\ a_{4, 1} & & & \end{vmatrix}$。

由于不在反对角线上的元素均为 $0$，故仅有 $j_1 = 4, j_2 = 3, j_3 = 2, j_4 = 1$ 的单项可能非 $0$。

而 $\tau(4, 3, 2, 1) = \#\{(1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)\} = 6$，则答案为 $(-1)^6 a_{1, 4} a_{2, 3} a_{3, 2} a_{4, 1} = a_{1, 4} a_{2, 3} a_{3, 2} a_{4, 1}$。

------

[例] 求证：
$$
\begin{vmatrix}
a_{1, 1} & \cdots & a_{1, n} & c_{1, 1} & \cdots & c_{1, m} \\
\vdots & \ddots & \vdots & \vdots & & \vdots \\
a_{n, 1} & \cdots & a_{n, n} & c_{n, 1} & \cdots & c_{n, m} \\
0 & \cdots & 0 & b_{1, 1} & \cdots & b_{1, m} \\
\vdots & \ddots & \vdots & \vdots & & \vdots \\
0 & \cdots & 0 & b_{m, 1} & \cdots & b_{m, m}
\end{vmatrix}
=
\begin{vmatrix}
a_{1, 1} & \cdots & a_{1, n} \\
\vdots & \ddots & \vdots \\
a_{n, 1} & \cdots & a_{n, n}
\end{vmatrix}
\begin{vmatrix}
b_{1, 1} & \cdots & b_{1, m} \\
\vdots & \ddots & \vdots \\
b_{n, 1} & \cdots & b_{m, m}
\end{vmatrix}
$$
记 $\begin{cases} d_{i, j} = a_{i, j} \quad & i = 1, 2, \cdots, n, j = 1, 2, \cdots, n \\ d_{i + n, j + n} = b_{i, j} \quad & i = 1, 2, \cdots, m, j = 1, 2, \cdots, m \\ d_{i, j + n} = c_{i, j} \quad & i = 1, 2, \cdots, n, j = 1, 2, \cdots, m \\ d_{i + n, j} = 0 \quad & i = 1, 2, \cdots, m, j = 1, 2, \cdots, n \end{cases}$，该 $(n + m) \times (n + m)$ 矩阵记为 $\mathbf{D}$。

若 $j_{n + 1}, j_{n + 2}, \cdots, j_{n + m}$ 中有一项属于 $\{1, 2, \cdots, n\}$，则该项为 $0$。

换言之，非零项必有 $\{j_{n + 1}, j_{n + 2}, \cdots, j_{n + m}\} \subset \{n + 1, n + 2, \cdots, n + m\}$。

又由于 $\#\{j_{n + 1}, j_{n + 2}, \cdots, j_{n + m}\} = \#\{n + 1, n + 2, \cdots, n + m\}$，故 $\{j_{n + 1}, j_{n + 2}, \cdots, j_{n + m}\} = \{n + 1, n + 2, \cdots, n + m\}$，即 $j_{n + 1}, j_{n + 2}, \cdots, j_{n + m}$ 为 $n + 1, n + 2, \cdots, n + m$ 的一个排列。

进而，有 $j_1, j_2, \cdots, j_n$ 为 $1, 2, \cdots, n$ 的一个排列。

故而：
$$
\begin{align}
\tau(j_1, \cdots, j_n, j_{n + 1}, \cdots, j_{n + m}) &= \#\{(j_p, j_q) \text{ 为逆序对}\} \\
&= \#\{(j_p, j_q) \text{ 为逆序对}, 1 \leq p, q \leq n\} + \#\{(j_p, j_q) \text{ 为逆序对}, n + 1 \leq p, q \leq n + m\} \\
&= \tau(j_1, \cdots, j_n) + \tau(j_{n + 1}, \cdots, j_{n + m})
\end{align}
$$
即：
$$
\begin{align}
\det(\mathbf{D}) &= \sum_{\{j_1, j_2, \cdots j_n\} = \{1, 2, \cdots, n\}, \{j_{n + 1}, j_{n + 2}, \cdots j_{n + m}\} = \{n + 1, n + 2, \cdots, n + m\}} (-1)^{\tau(j_1, \cdots, j_n, j_{n + 1}, \cdots, j_{n + m})} \prod_{k = 1}^{n + m} d_{k, j_k} \\
&= \sum_{\{j_1, j_2, \cdots j_n\} = \{1, 2, \cdots, n\}, \{j_{n + 1}, j_{n + 2}, \cdots j_{n + m}\} = \{n + 1, n + 2, \cdots, n + m\}} ((-1)^{\tau(j_1, \cdots, j_n)} \prod_{k = 1}^n d_{k, j_k})((-1)^{\tau(j_{n + 1}, \cdots, j_{n + m})} \prod_{k = n + 1}^{n + m} d_{k, j_k}) \\
&= \sum_{\{j_1, j_2, \cdots j_n\} = \{1, 2, \cdots, n\}} ((-1)^{\tau(j_1, \cdots, j_n)} \prod_{k = 1}^n a_{k, j_k}) \sum_{\{j_{n + 1}, j_{n + 2}, \cdots j_{n + m}\} = \{n + 1, n + 2, \cdots, n + m\}} ((-1)^{\tau(j_{n + 1}, \cdots, j_{n + m})} \prod_{k = n + 1}^{n + m} b_{k - n, j_k - n}) \\
&= \sum_{\{j_1, j_2, \cdots j_n\} = \{1, 2, \cdots, n\}} ((-1)^{\tau(j_1, \cdots, j_n)} \prod_{k = 1}^n a_{k, j_k}) \sum_{\{j'_1, j'_2, \cdots j'_m\} = \{1, 2, \cdots, m\}} ((-1)^{\tau(j'_1, \cdots, j'_m)} \prod_{k = 1}^m b_{k, j'_k}) \\
&= \det(\mathbf{A}) \det(\mathbf{B})
\end{align}
$$
这一结论简记为 $\begin{vmatrix} \mathbf{A}_{n \times n} & \mathbf{C}_{n \times m} \\ \mathbf{O}_{m \times n} & \mathbf{B}_{m \times m} \end{vmatrix} = |\mathbf{A}_{n \times n}||\mathbf{B}_{m \times m}|$。

### 定理：对换改变排列的奇偶性 parity。

形式化地，若 $(j_1, j_2, \cdots, j_n)$ 是 $(1, 2, \cdots, n)$ 的排列，不妨令 $s < t$，定义 $E_{s, t}(j_1, j_2, \cdots, j_n) = E_{s, t}(j_1, \cdots, j_s, \cdots, j_t, \cdots, j_n) = (j_1, \cdots, j_{s - 1}, j_t, j_{s + 1}, \cdots, j_{t - 1}, j_s, j_{t + 1}, \cdots, j_n)$，则 $\forall 1 \leq s < t \leq n, \tau(E_{s, t}(j_1, j_2, \cdots, j_n)) \neq \tau(j_1, j_2, \cdots, j_n)$。

记 $S_1 = (j_1, \cdots, j_{s - 1}), S_2 = (j_{s + 1}, \cdots, j_{t - 1}), S_3 = (j_{t + 1}, \cdots, j_n)$。
$$
\begin{align}
&\tau(S_1, j_s, S_2, j_t, S_3) \\
= &\tau(S_1, j_s) + \tau(S_1, S_2) + \tau(S_1, j_t) + \tau(S_1, S_3) + \tau(j_s, S_2) + \tau(j_s, j_t) + \tau(j_s, S_3) + \tau(S_2, j_t) + \tau(S_2, S_3) + \tau(j_t, S_3) - 3(\tau(S_1) + \tau(S_2) + \tau(S_3)) \\
&\tau(S_1, j_t, S_2, j_s, S_3) \\
= &\tau(S_1, j_t) + \tau(S_1, S_2) + \tau(S_1, j_s) + \tau(S_1, S_3) + \tau(j_t, S_2) + \tau(j_t, j_s) + \tau(j_t, S_3) + \tau(S_2, j_s) + \tau(S_2, S_3) + \tau(j_s, S_3) - 3(\tau(S_1) + \tau(S_2) + \tau(S_3)) \\
&\tau(S_1, j_t, S_2, j_s, S_3) - \tau(S_1, j_s, S_2, j_t, S_3) \\
= &(\tau(S_2, j_s) - \tau(j_s, S_2)) + (\tau(j_t, S_2) - \tau(S_2, j_t)) + (\tau(j_t, j_s) - \tau(j_s, j_t)) \\ 
\equiv &(\tau(S_2, j_s) + \tau(j_s, S_2)) + (\tau(j_t, S_2) + \tau(S_2, j_t)) + (\tau(j_t, j_s) + \tau(j_s, j_t)) \pmod 2 \\
\equiv &\binom{\#(S_2) + 1}{2} + \binom{\#(S_2) + 1}{2} + 1 \pmod 2 \\
\equiv &1 \pmod 2
\end{align}
$$

### 定理：在 $m$（$m \geq 2$）阶排列中，奇偶排列数相等。

记 $\sigma_m$ 表示 $1 \sim m$ 的所有排列的集合，记 $\sigma_m^0, \sigma_m^1$ 表示其中的偶、奇排列。

考虑映射 $E_{1, 2} : \sigma^0_m \to \sigma^1_m$，则其为**一一映射**（这两个集合也可称作互相“同构”）。

如何严格证明这一结论？

- 考虑 $x = y \Leftrightarrow x \geq y \land y \geq x$。
- 由**对换改变排列奇偶性**可知：$\forall j \in \sigma^0_m, E_{1, 2}(j) \in \sigma^1_m$，且所得的 $E_{1, 2}(j)$ 两两不同（若相同，由于 $E_{s, t}(E_{s, t}(j)) = j$，则对应的 $j$ 相同，矛盾）。因此 $\#(\sigma_m^0) \geq \#(\sigma_m^1)$。
- 同理 $\#(\sigma_m^1) \geq \#(\sigma_m^0)$，故 $\#(\sigma_m^0) = \#(\sigma_m^1)$。

由于 $\#(\sigma_m) = m!$，有 $\#(\sigma_m^0) = \#(\sigma_m^1) = \dfrac{m!}{2}$。

### 定理：对于每一个 $(1, 2, \cdots, n)$ 的排列 $(j_1, j_2, \cdots, j_n)$，必定存在一组对换 $E_{s_1, t_1}, E_{s_2, t_2}, \cdots, E_{s_m, t_m}$，使得 $E_{s_m, t_m}(\cdots(E_{s_1, t_1}(1, 2, \cdots, n))) = (j_1, \cdots, j_n)$，且对于任意合法对换，$m$ 与 $\tau(j_1, \cdots, j_n)$ 同奇偶。

若 $j_1 \neq 1$，则 $\exists k \neq 1$ 使得 $j_k = 1$，此时施对换 $E_{1, k}(j_1, \cdots, j_n) = (1, \cdots)$。

如此续行，至多经过 $n - 1$ 次操作，必可得到 $(1, 2, \cdots, n)$。

由对换改变排列奇偶性可知 $\tau(1, \cdots, n) + m \equiv \tau(j_1, \cdots, j_n) \pmod 2 \Rightarrow \tau(j_1, \cdots, j_n) \equiv m \pmod 2$。

### 行列对称性

$$
\begin{align}
\det(\mathbf{A}) &= \sum_{\{j_1, j_2, \cdots, j_n\} = \{1, 2, \cdots, n\}} (-1)^{\tau(j)} \prod_{k = 1}^n a_{k, j_k} \\
&= \sum_{\{i_1, i_2, \cdots, i_n\} = \{1, 2, \cdots, n\}} (-1)^{\tau(i)} \prod_{k = 1}^n a_{i_k, k} \\
&= \sum_{\binom{i_1, \cdots, i_n}{j_1, \cdots, j_n}} (-1)^{\tau(i) + \tau(j)} \prod_{k = 1}^n a_{i_k, j_k}
\end{align}
$$

证明：

- 考察最后一种形式中的一组排列 $(i_1, \cdots, i_n), (j_1, \cdots, j_n)$。
- 记将 $(i_1, \cdots, i_n)$ 变换为 $(1, \cdots, n)$ 的一组变换为 $E_{s_1, t_1}, \cdots, E_{s_m, t_m}$。
- 记 $E_{s_m, t_m} (\cdots (E_{s_1, t_1} (j_1, \cdots, j_n)) \cdots) = (j'_1, \cdots, j'_n)$。
- 则 $\tau(i) + m \equiv 0 \pmod 2, \tau(j) + m \equiv \tau(j') \pmod 2$。
- 将两者相加可得 $\tau(i) + \tau(j) \equiv \tau(j') \pmod 2$。
- 由于 $\displaystyle\prod_{k = 1}^n a_{i_k, j_k}$ 和 $\displaystyle\prod_{k = 1}^n a_{k, j'_k}$ 本质上就是采取了两种不同的顺序将同样的单项乘起来，其结果相等，故第一、三种形式相等。
- 同理可证第二、三种形式相等，故原式得证。

------

感性地，注意到上面三种形式都可以被看作：

- 构造一个平面直角坐标系，把 $(i_k, j_k)$ 放上去。
- 计算 $x_{k_1} < x_{k_2}, y_{k_1} > y_{k_2}$ 的“一个在另一个的右下方”的无序点对数量。

转置不会改变这样的无序点对数量，进而可以推知 $\det(\mathbf{A}^T) = \det(\mathbf{A})$（转置不改变行列式）。

### 行列式的性质

- 多线性性 multi-linearity

$$
\det(
\begin{bmatrix}
\mathbf{a}_1 \\
\vdots \\
\mathbf{a}_{i - 1} \\
\lambda \mathbf{a}_i + \mu \mathbf{b} \\
\mathbf{a}_{i + 1} \\
\vdots \\
\mathbf{a}_n
\end{bmatrix})
= \lambda \det(
\begin{bmatrix}
\mathbf{a}_1 \\
\vdots \\
\mathbf{a}_{i - 1} \\
\mathbf{a}_i \\
\mathbf{a}_{i + 1} \\
\vdots \\
\mathbf{a}_n
\end{bmatrix}
) + \mu \det(
\begin{bmatrix}
\mathbf{a}_1 \\
\vdots \\
\mathbf{a}_{i - 1} \\
\mathbf{b} \\
\mathbf{a}_{i + 1} \\
\vdots \\
\mathbf{a}_n
\end{bmatrix}
)
$$

其一个直接推论为：将某一行乘上 $\lambda$，行列式也变为原来的 $\lambda$ 倍。

- 交错性

$$
\det(
\begin{bmatrix}
\mathbf{a}_1 \\
\vdots \\
\mathbf{a}_{s - 1} \\
\mathbf{a}_s \\
\mathbf{a}_{s + 1} \\
\vdots \\
\mathbf{a}_{t - 1} \\
\mathbf{a}_t \\
\mathbf{a}_{t + 1} \\
\vdots \\
\mathbf{a}_n
\end{bmatrix}
)
= -\det(
\begin{bmatrix}
\mathbf{a}_1 \\
\vdots \\
\mathbf{a}_{s - 1} \\
\mathbf{a}_t \\
\mathbf{a}_{s + 1} \\
\vdots \\
\mathbf{a}_{t - 1} \\
\mathbf{a}_s \\
\mathbf{a}_{t + 1} \\
\vdots \\
\mathbf{a}_n
\end{bmatrix}
)
$$

相当于在行列式求和中将 $\tau(j)$ 替换为了 $\tau(E_{s, t}(j))$，奇偶性改变。

这里更严谨的写法是记 $\mathbf{b}_i = \begin{cases} \mathbf{a}_i, &\quad i \neq s, t \\ \mathbf{a}_t, &\quad i = s \\ \mathbf{a}_s, &\quad i = t \end{cases}$。

[例] 证明：若 $\exists s \neq t, \text{s.t. } \mathbf{a}_s = \mathbf{a}_t$，则 $\det(A) = 0$。

交换两行取相反数；但交换两行后矩阵不变，则行列式不变。故行列式为 $0$。

- 单位性：$\det(\mathbf{I}_n) = 1$。

### 行列式的公理化定义

对于给定的 $n$，一个有趣的事实是，我们可以依据上面的三条性质唯一确定一个 $\mathbb{R}^{n^2} \to \mathbb{R}$ 的映射，而它正好就是 $\det(\mathbf{A}_{n \times n})$。

证明：

- 下面记这个映射为 $\hat{\det}(\mathbf{A}_{n \times n})$。

- 对于 $i = 1, 2, \cdots, n$，定义 $1 \times n$ 行向量 $e_i$，其第 $i$ 项为 $1$，其余项为 $0$，则由**多线性性**可知：

$$
\begin{align}
\hat{\det}(\mathbf{A}_{n \times n}) &= \hat{\det} \begin{bmatrix} \displaystyle\sum_{j_1 = 1}^n a_{1, j_1} \mathbf{e}_{j_1} \\ \mathbf{a}_2 \\ \vdots \\ \mathbf{a}_n \end{bmatrix} \\
&= \sum_{j_1 = 1}^n a_{1, j_1} \hat{\det} \begin{bmatrix} \mathbf{e}_{j_1} \\ \mathbf{a}_2 \\ \vdots \\ \mathbf{a}_n \end{bmatrix} \\
&= \cdots \\
&= \sum_{j_1 = 1}^n a_{1, j_1} \cdots \sum_{j_n = 1}^n a_{n, j_n} \hat{\det} \begin{bmatrix} \mathbf{e}_{j_1} \\ \mathbf{e}_{j_2} \\ \vdots \\ \mathbf{e}_{j_n} \end{bmatrix} \\
\end{align}
$$

- 由**交错性推论**可知：若 $\exists k_1 \neq k_2, \text{s.t. } j_{k_1} = j_{k_2}$，则 $\hat{\det} \begin{bmatrix} \mathbf{e}_{j_1} \\ \mathbf{e}_{j_2} \\ \vdots \\ \mathbf{e}_{j_n} \end{bmatrix} = 0$，故我们要求 $j$ 是一个 $1 \sim n$ 的排列。
- 对于一个排列 $j$，考虑一个将 $(1, 2, \cdots, n)$ 变换为 $j$ 的长为 $m$ 的对换序列，则由**交错性和单位性**可知 $\hat{\det} \begin{bmatrix} \mathbf{e}_{j_1} \\ \mathbf{e}_{j_2} \\ \vdots \\ \mathbf{e}_{j_n} \end{bmatrix} = (-1)^m \hat{\det} \begin{bmatrix} \mathbf{e}_1 \\ \mathbf{e}_2 \\ \vdots \\ \mathbf{e}_n \end{bmatrix} = (-1)^{\tau(j)} \hat{\det}(\mathbf{I}_n) = (-1)^{\tau(j)}$。
- 代入原式即可得到 $\hat{\det}(\mathbf{A}_{n \times n}) = \det(\mathbf{A}_{n \times n})$，即我们用这三条规则唯一确定了行列式。

### 行列式的计算

定义下面三种初等行变换（不限于方阵）：

- (1) $\lambda \neq 0, P_i(\lambda)$：把第 $i$ 行乘上 $\lambda$。
- (2) $p \neq q, P_{p, q}(\lambda)$：把第 $p$ 行乘上 $\lambda$ 加到第 $q$ 行。

- (3) $p < q, P_{p, q}$：交换第 $p, q$ 行。

对方阵而言：

- (1) **线性性**：$|P_i(\lambda)(\mathbf{A})| = \lambda |\mathbf{A}|$。
- (2) **多线性性 & 交错性推论**：$|P_{p, q}(\lambda)(\mathbf{A})| = |\mathbf{A}|$。
- (3) **交错性**：$|P_{p, q}(\mathbf{A})| = -|\mathbf{A}|$。

同理有初等列变换及其作用于行列式上的性质。

------

反复运用上述变换将 $\mathbf{A}$ 消成上 / 下三角矩阵即可。

另一个解法是在左下角的 $\dfrac{1}{4}$ 全零后拆成左上右下两部分，然后乘起来。

该方法俗称“打洞法”，正式地称作高斯消去法。

[例] P21. 例 1.5

---

#### 定理：对于非纯零阵，一定可以通过有限次初等行变换，使之变为阶梯阵 echelon。

- 阶梯阵的定义：除第一行外，任一行的首个非零元素所在列的指标大于上一行这样元素的列指标。上三角矩阵是其特例。

证明（**有限归纳**，构造）：

- 记 $\mathbf{A}^{(1)} = \mathbf{A}$，考察第一列。
- (1) 若第一列元素全为 $0$，记 $\mathbf{A}^{(1)}$ 删去第一列后所得 $n \times (m - 1)$ 的子矩阵为 $\mathbf{A}^{(2)}$。
- (2) 对 $a_{1, 1} \neq 0$（记之为中枢 pivot）的 $\mathbf{A}^{(1)}$ 考察其 $(i, 1)$ 元（$i = 2, \cdots, n$）：若 $a_{i, 1} \neq 0$，作 $P_{1, i}(-\dfrac{a_{i, 1}}{a_{1, 1}})$ 则其 $(i, 1)$ 元变为零；若 $a_{i, 1} = 0$，保持不变。所得矩阵仍记为 $\mathbf{A}^{(1)} = (\mathbf{A}^{(1)}_{i, j})$，其满足 $\mathbf{A}^{(1)}_{1, 1} \neq 0$，对于 $i \neq 1$ 有 $\mathbf{A}^{(1)}_{i, 1} = 0$。
- 对所有 $i$ 的操作完成后，记 $\mathbf{A}^{(1)}$ 删去第一行、第一列后所得 $(n - 1) \times (m - 1)$ 的子矩阵为 $\mathbf{A}^{(2)}$。
- (3) 若 $a_{1, 1} = 0$，但第一列含非零元素，任选其一 $a_{i, 1} \neq 0$（$i \neq 1$），作 $P_{1, i}(\mathbf{A}^{(1)})$ 则其 $(1, 1)$ 元非零，为 $a_{i, 1}$，仍记为 $\mathbf{A}^{(1)}$，转化为 (2) 的情况，得到 $\mathbf{A}^{(2)}$。
- 对 $\mathbf{A}^{(2)}$ 同样操作，其中第一列至多只有 $(1, 1)$ 元非零，且过程中相应的 $\mathbf{A}^{(1)}$ 第一列的元素不变。
- 于是第二行、第三行的第一个非零元素的列指标分别大于第一行、第二行。
- 如此续行至多 $n - 1$ 次，得到定理所述的阶梯阵。

#### 按照行 / 列展开

1. 取第 $i$ 行，则 $|\mathbf{A}| = \displaystyle\sum_{j = 1}^n a_{i, j} A_{i, j}$，其中 $A_{i, j}$ 表示将 $\mathbf{A}$ 删去第 $i$ 行、第 $j$ 列所得方阵的行列式乘上 $(-1)^{i + j}$，称作代数余子式。按照列展开同理。

考虑行列式的无序数对定义：这里的 $i, j$ 赋值给 $i_1, j_1$。相较 $\tau(i_2, \cdots, i_n)$，$\tau(i_1, i_2, \cdots, i_n)$ 增加了 $i_1 - 1$；列的逆序对数同理。

故需乘上 $(-1)^{(i_1 - 1) + (j_1 - 1)} = (-1)^{i + j}$。

- 方便起见，$(1, \cdots, n)$ 中删去 $i$ 记作 $(1, \cdots, \hat{i}, \cdots, n)$。

2. 要是我们将 $a_{i, j} A_{i, j}$ 换成 $a_{i, j} A_{i', j}$，其中 $i' \neq i$？

这一项中就丢失第 $i'$ 行的信息了！

考虑**构造新矩阵** $\mathbf{A}' = (a'_{i, j})$，其中 $a'_{s, t} = \begin{cases} a_{i', t}, &\quad s = i \\ a_{s, t}, &\quad s \neq i \end{cases}$，则可以发现我们求的正是 $|A'|$。

由于 $\mathbf{A}'$ 中有两行相同，其行列式为 $0$。

------

可得 $\displaystyle\sum_{j = 1}^n a_{i, j} A_{i', j} = \delta_{i, i'} |\mathbf{A}|$，其中 $\delta_{i, i'} = [i = i']$ 为克罗克内尔符号 Kronecker symbol。

#### 范德蒙德 van der Monde 行列式

$$
V_n = \begin{vmatrix}
1 & 1 & \cdots & 1 \\
a_1 & a_2 & \cdots & a_n \\
\vdots & \vdots & \ddots & \vdots \\
a_1^{n - 1} & a_2^{n - 1} & \cdots & a_n^{n - 1}
\end{vmatrix}
$$

考虑**逐个消元**：

- 从下到上依次 $P_{i, i + 1}(-a_1)$，让每个第 $i \neq 1$ 列的第 $j \neq 1$ 行们具有 $(a_i - a_1)$ 这一公因数，得到：

$$
\begin{vmatrix}
1 & 1 & \cdots & 1 \\
0 & a_2 - a_1 & \cdots & a_n - a_1 \\
\vdots & \vdots & \ddots & \vdots \\
0 & a_2^{n - 2} (a_2 - a_1) & \cdots & a_n^{n - 2} (a_n - a_1)
\end{vmatrix}
$$

- 按照第一列展开，得到：

$$
\begin{vmatrix}
a_2 - a_1 & \cdots & a_n - a_1 \\
\vdots & \ddots & \vdots \\
a_2^{n - 2} (a_2 - a_1) & \cdots & a_n^{n - 2} (a_n - a_1)
\end{vmatrix}
$$

- 可以发现我们成功消去了第一行和第一列！接下来考虑提出公因数，转化为规模为 $n - 1$ 的原问题：

$$
\prod_{j = 2}^n (a_j - a_1) \begin{vmatrix}
1 & \cdots & 1 \\
\vdots & \ddots & \vdots \\
a_2^{n - 2} & \cdots & a_n^{n - 2}
\end{vmatrix}
$$

- 如此续行 $n - 2$ 次，最终得到：

$$
V_n = \prod_{i = 1}^n \prod_{j = i + 1}^n (a_j - a_i)
$$

#### 稀疏矩阵

概念：非零项数“少”的矩阵。

有时我们可以利用这一性质简化行列式计算，如下所示。

[例] 求下面 $D_n$ 的通项公式：
$$
D_n = \det(\operatorname{tridag}(1, -2, 1)_n) =
\begin{vmatrix}
-2 & 1 & & & \\
1 & -2 & 1 & & \\
& \ddots & \ddots & \ddots \\
& & 1 & -2 & 1 \\
& & & 1 & -2
\end{vmatrix}_{n \times n}
$$
按第一行展开，容易推知：
$$
\begin{aligned}
D_n &= (-1)^{1 + 1} \times (-2) \times 
\begin{vmatrix}
-2 & 1 & & & \\
1 & -2 & 1 & & \\
& \ddots & \ddots & \\
& & 1 & -2 & 1 \\
& & & 1 & -2
\end{vmatrix}_{(n - 1) \times (n - 1)}
+ (-1)^{1 + 2} \times 1 \times 
\begin{vmatrix}
1 & 1 & & & & \\
& -2 & 1 & & & \\
& 1 & -2 & 1 & & \\
& & \ddots & \ddots & \ddots & \\
& & & 1 & -2 & 1 \\
& & & & 1 & -2
\end{vmatrix}_{(n - 1) \times (n - 1)} \\
&= -2 D_{n - 1} - (-1)^{1 + 1} \times 1 \times \begin{vmatrix}
-2 & 1 & & & \\
1 & -2 & 1 & & \\
& \ddots & \ddots & \ddots & \\
& & 1 & -2 & 1 \\
& & & 1 & -2
\end{vmatrix}_{(n - 2) \times (n - 2)} \\
&= -2 D_{n - 1} - D_{n - 2}
\end{aligned}
$$
考虑 $D_n$ 的特征方程 $x^2 + 2x + 1 = 0 \Rightarrow x = -1$，则通项公式形如 $D_n = \alpha (-1)^n + \beta n (-1)^n$。

易知 $D_1 = -2, D_2 = 3$，解得 $\alpha = \beta = -1$，故 $D_n = (-1)^n (n + 1)$。

#### 拉普拉斯 Laplace 展开定理——单行 / 列展开的推广

内容：对于方阵 $\mathbf{A}_{n \times n}$，任取 $p$ 行 $t_1 < \cdots < t_p$，其余 $n - p$ 行依次为 $t_{p + 1} < \cdots < t_n$，则行列式可展开为：
$$
\det(\mathbf{A}) = \sum_{1 \leq s_1 < \cdots < s_p \leq n} (-1)^{\sum_{i = 1}^p (t_i + s_i)} \begin{vmatrix} \mathbf{A} \dbinom{t_1, \cdots, t_p}{s_1, \cdots, s_p} \end{vmatrix} \begin{vmatrix} \mathbf{A} \dbinom{t_{p + 1}, \cdots, t_n}{s_{p + 1}, \cdots, s_n} \end{vmatrix}
$$
其中 $\mathbf{A} \dbinom{t_1, \cdots, t_p}{s_1, \cdots, s_p}$ 表示 $A$ 的一个子矩阵，即将 $\mathbf{A}$ 的第 $t_1, \cdots, t_p$ 行第 $s_1, \cdots, s_p$ 列的元按此顺序形成的方阵。其行列式为 $\mathbf{A}$ 的一个子式 minor。这里我们要求 $t, s$ 单调递增。

证明（**排列 $j$ 的拆分**）：

- 考虑将 $j$ 拆成 $(j_{t_1}, \cdots, j_{t_p}), (j_{t_{p + 1}}, \cdots, j_{t_n})$ 两段，分别为 $(s_1, \cdots, s_p), (s_{p + 1}, \cdots, s_n)$ 的排列。

- 则我们可以将原行列式表示为：

$$
\begin{align}
\det(\mathbf{A}) &= \sum_{1 \leq s_1 < \cdots < s_p \leq n} \sum_{\{j_{t_1}, \cdots, j_{t_p}\} = \{s_1, \cdots, s_p\}} \sum_{\{j_{t_{p + 1}}, \cdots, j_{t_n}\} = \{s_{p + 1}, \cdots, s_n\}} (-1)^{\tau(j)} \prod_{k = 1}^n a_{k, j_k} \\
&= \sum_{1 \leq s_1 < \cdots < s_p \leq n} \sum_{\{j_{t_1}, \cdots, j_{t_p}\} = \{s_1, \cdots, s_p\}} ((-1)^{\tau(j_{t_1}, \cdots, j_{t_p})} \prod_{k = 1}^p a_{t_k, j_{t_k}}) \sum_{\{j_{t_{p + 1}}, \cdots, j_{t_n}\} = \{s_{p + 1}, \cdots, s_n\}} ((-1)^{\tau(j_{t_{p + 1}}, \cdots, j_{t_n})} \prod_{k = p + 1}^n a_{t_k, j_{t_k}}) \times (-1)^{\sum_{1 \leq x \leq p < y \leq n} [[t_x < t_y] = [j_{t_x} < j_{t_y}]]}
\end{align}
$$

- 前面部分已经是两个行列式相乘的形式，考虑在 $\bmod 2$ 意义下化简后面的幂次。

$$
\begin{align}
&\sum_{1 \leq x \leq p < y \leq n} [[t_x < t_y] = [j_{t_x} < j_{t_y}]] \\
\equiv &\sum_{1 \leq x \leq p < y \leq n} ([t_x < t_y] + [j_{t_x} < j_{t_y}]) \pmod 2 \\
\equiv &\sum_{1 \leq x \leq p < y \leq n} [t_x < t_y] + \sum_{1 \leq x \leq p < y \leq n} [s_x < s_y] \pmod 2 \\
\end{align}
$$

- 不妨考虑前面那坨，可以发现：固定 $x$ 时，满足 $t_x < t_y$ 的 $y$ 的集合正好就是 $\{i \mid t_x < i \leq n, i \in \mathbb{N}\} / \{t_i \mid t_x < t_i, i \in \mathbb{N}\}$，前者包含后者，且前者大小为 $n - t_x$、后者大小为 $p - x$。因此这坨的贡献为 $\displaystyle\sum_{x = 1}^p ((n - t_x) - (p - x)) = (n - p) p + S_1(p) - \sum_{x = 1}^p t_x$。
- 后面那坨同理为 $(n - p) p + S_1(p) - \displaystyle\sum_{x = 1}^p s_x$，两者加起来 $\bmod 2$ 意义下与 $\displaystyle\sum_{i = 1}^p (t_i + s_i)$ 同余。
- 将此与行列式形式带回前式即得证。

------

我们称 $(-1)^{\sum_{i = 1}^p (t_i + s_i)} \begin{vmatrix} \mathbf{A} \dbinom{t_{p + 1}, \cdots, t_n}{s_{p + 1}, \cdots, s_n} \end{vmatrix}$ 为 $\begin{vmatrix} \mathbf{A} \dbinom{t_1, \cdots, t_p}{s_1, \cdots, s_p} \end{vmatrix}$ 的代数余子式。

### 克拉姆 Cramer 法则

内容：考察线性方程组 $\begin{cases} a_{1, 1} x_1 + \cdots + a_{1, n} x_n = b_1 \\ \cdots \\ a_{n, 1} x_1 + \cdots + a_{n, n} x_n = b_n \end{cases}$，设其系数矩阵为 $\mathbf{A} = (a_{i, j})_{n \times n}$，列向量 $\mathbf{b} = \begin{bmatrix} b_1 & \cdots & b_n \end{bmatrix}^T$。

若其**特征行列式** $d = |\mathbf{A}| \neq 0$，则称 $\mathbf{A}$ **非奇异** nonsingular，此时方程有**唯一**解 $\begin{cases} x_1 = \dfrac{d_1}{d} \\ \cdots \\ x_n = \dfrac{d_n}{d} \end{cases}$，其中 $d_i = \det(\begin{bmatrix} \tilde{\mathbf{a}}_1 & \cdots & \tilde{\mathbf{a}}_{i - 1} & \mathbf{b} & \tilde{\mathbf{a}}_{i + 1} & \cdots & \tilde{\mathbf{a}}_n \end{bmatrix})$。

证明：

- 考虑计算 $d_i$，此时我们可以按第 $i$ 列展开，可知 $d_i = \displaystyle\sum_{j = 1}^n b_j A_{i, j}$。

- 进而考察第 $i$ 组方程，有：

$$
\text{LHS} = \displaystyle\sum_{j = 1}^n a_{i, j} x_j = \frac{1}{d} \sum_{j = 1}^n a_{i, j} \sum_{k = 1}^n b_k A_{i, k} = \frac{1}{d} \sum_{k = 1}^n b_k \sum_{j = 1}^n a_{i, j} A_{i, k} = \frac{1}{d} \sum_{k = 1}^n b_k (\delta_{j, k} d) = b_j = \text{RHS}
$$

- 因此这样可以构造出一组可行解，下面讨论其唯一性。

- 记第 $p$ 个方程为 $[p]$，则对于任意 $i$，我们要求：

$$
\begin{align}
\sum_{j = 1}^n A_{j, i} [j] &\Leftrightarrow \sum_{j = 1}^n A_{j, i} \sum_{k = 1}^n a_{j, k} x_k = \sum_{j = 1}^n A_{j, i} b_j \\
&\Leftrightarrow \sum_{k = 1}^n x_k \sum_{j = 1}^n a_{j, k} A_{j, i} = d_i \\
&\Leftrightarrow d x_i = d_i \\
&\Leftrightarrow d \neq 0, x_i = \frac{d_i}{d}
\end{align}
$$

- 因此，有解时，$x_i$ 的取值唯一确定，即解唯一。

---

一个有趣的问题是，为什么我们既需要构造可行解，也需要说明其唯一性？

- 前者给出一组可行解，说明解数 $\geq 1$。
- 后者事实上给出了若干可行解的**必要**条件，只能说明解数 $\leq 1$。

#### 齐次线性方程组

下面考察齐次线性方程组 $\begin{cases} a_{1, 1} x_1 + \cdots + a_{1, n} x_n = 0 \\ \cdots \\ a_{n, 1} x_1 + \cdots + a_{n, n} x_n = 0 \end{cases}$。

一个显然的解是 $x_i$ 全 $0$，但什么情况下存在 $x_i$ 非全 $0$ 的解？

事实上，若 $d = 0$，我们称 $\mathbb{A}$ **奇异** singular，此时存在 $x_i$ 非全 $0$ 的解。当然，是无穷组。

- 根据上面我们证明可行解若存在则唯一的步骤，可知 $dx_i = 0 \not\Rightarrow x_i = 0$ 的条件为 $d = 0$，这是一个必要条件。
- *进行高斯消元，若存在 $a_{i, i} = 0$ 则不受限制，即不止非零解，而这等价于 $d = 0$。*

- _下一章将会有详细证明。_
