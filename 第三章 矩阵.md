# 第三章 矩阵

### 矩阵的加法、乘法与转置

#### 加法

定义：两个大小相同的矩阵逐分量相加。

跟向量一致，矩阵“传承”了原数域关于加法的性质，具有交换律、结合律、零元、负元。

加法关于转置有分配律：$(\mathbf{A} + \mathbf{B})^T = \mathbf{A}^T + \mathbf{B}^T$。

##### 定理：$\operatorname{rank}(\mathbf{A} + \mathbf{B}) \leq \operatorname{rank}(\mathbf{A}) + \operatorname{rank}(\mathbf{B})$

证明：

- 取 $\mathbf{A}$ 的行向量的极大无关组 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}\}$，$\mathbf{B}$ 的向量极大无关组 $\{\mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}$。
- $\forall i \in \mathbb{N}_+ \land i \leq m$，有 $\exists \lambda_1, \cdots, \lambda_x \in \mathbb{F}, \text{s.t. } \mathbf{a}_i = \displaystyle\sum_{k = 1}^x \lambda_k \mathbf{a}_{i_k}$ 且 $\exists \mu_1, \cdots, \mu_y \in \mathbb{F}, \text{s.t. } \mathbf{b}_i = \displaystyle\sum_{k = 1}^y \mu_k \mathbf{b}_{j_k}$。
- 则 $\mathbf{a}_i + \mathbf{b}_i = \displaystyle\sum_{k = 1}^x \lambda_k \mathbf{a}_{i_k} + \sum_{k = 1}^y \mu_k \mathbf{b}_{j_k}$，即 $\mathbf{a}_i + \mathbf{b}_i$ 可被 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}, \mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}$，线性表出。
- 故 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}, \mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}$ 可以线性表出 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m, \mathbf{b}_1, \cdots, \mathbf{b}_m\}$，于是 $\operatorname{rank}(\mathbf{C}) = \operatorname{rank}(\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}, \mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}) \leq x + y = \operatorname{rank}(\mathbf{A}) + \operatorname{rank}(\mathbf{B})$。

##### 推论（“三角不等式”）：$|\operatorname{rank}(\mathbf{A}) - \operatorname{rank}(\mathbf{B})| \leq \operatorname{rank}(\mathbf{A} \pm \mathbf{B}) \leq \operatorname{rank}(\mathbf{A}) + \operatorname{rank}(\mathbf{B})$。

#### 乘法

##### 线性性：$\mathbf{A} (\lambda \mathbf{x} + \mu \mathbf{y}) = \lambda (\mathbf{A} \mathbf{x}) + \mu (\mathbf{A} \mathbf{y})$，$(\lambda \mathbf{A} + \mu \mathbf{B}) \mathbf{x} = \lambda (\mathbf{A} \mathbf{x}) + \mu (\mathbf{B} \mathbf{x})$。

证明略。

##### 定理：若 $\mathbf{D}_{m \times n}, \tilde{\mathbf{D}}_{m \times n}$ 满足 $\forall \mathbf{x} \in \mathbf{F}^m, \mathbf{D} \mathbf{x} = \tilde{\mathbf{D}} \mathbf{x}$，则 $\mathbf{D} = \tilde{\mathbf{D}}$。

证明略。

- 我们最初引入矩阵与向量的乘法时，本质上只是一个用来表示线性方程组的记号，有关矩阵的更多性质，实际上是“未定义”的。
- 这个定理告诉我们，矩阵本身是可以由矩阵与向量的乘法定义的。

##### 对角阵

记对角阵 $\mathbf{A}_{n \times n} = \text{diag}(\lambda_1, \cdots, \lambda_n)$，即其主对角线上的数分别为 $\lambda_1, \cdots, \lambda_n$。

考察任一方阵 $\mathbf{B}_{n \times n}$ 左 / 右乘它的结果：

- $\mathbf{A} \mathbf{B} = \begin{bmatrix} \lambda_1 \mathbf{b}_1 \\ \vdots \\ \lambda_n \mathbf{b}_n \end{bmatrix}$。
- $\mathbf{B} \mathbf{A} = \begin{bmatrix} \lambda_1 \tilde{\mathbf{b}}_1 & \cdots & \lambda_n \tilde{\mathbf{b}}_n \end{bmatrix}$。

特别地，当 $\lambda_1 = \cdots = \lambda_n = \lambda$，称 $\mathbf{A}$ 为纯量阵，且有 $\mathbf{A} = \lambda \mathbf{I}_n$。

##### 结合律：设 $\mathbf{A}_{n \times m}, \mathbf{B}_{m \times k}, \mathbf{C}_{k \times s}$，则 $(\mathbf{A} \mathbf{B}) \mathbf{C} = \mathbf{A} (\mathbf{B} \mathbf{C})$。

思路一：直接展开矩阵乘法，交换求和符号即可得证。

思路二：

- 考虑贯彻**由矩阵与向量的乘法定义矩阵本身**的思想。
- 引理：$(\mathbf{A} \mathbf{B}) \mathbf{x} = \mathbf{A} (\mathbf{B} \mathbf{x})$。同思路一易证。
- 即证：$\forall \mathbf{x} \in \mathbb{F}^s, ((\mathbf{A} \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} (\mathbf{B} \mathbf{C})) \mathbf{x}$。
- 考虑利用引理转移括号，可得 $((\mathbf{A} \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} \mathbf{B}) (\mathbf{C} \mathbf{x}) = \mathbf{A} (\mathbf{B} (\mathbf{C} \mathbf{x})) = \mathbf{A} ((\mathbf{B} \mathbf{C}) \mathbf{x}) = (\mathbf{A} (\mathbf{B} \mathbf{C})) \mathbf{x}$，进而得证。

##### 关于加法的分配律

- 设 $\mathbf{A}_{n \times m}, \mathbf{B}_{n \times m}, \mathbf{C}_{m \times k}$，则 $(\mathbf{A} + \mathbf{B}) \mathbf{C} = \mathbf{A} \mathbf{C} + \mathbf{B} \mathbf{C}$。
- 设 $\mathbf{A}_{n \times m}, \mathbf{B}_{m \times k}, \mathbf{C}_{m \times k}$，则 $\mathbf{A} (\mathbf{B} + \mathbf{C}) = \mathbf{A} \mathbf{B} + \mathbf{A} \mathbf{C}$。

下证前者。

思路一：同上思路一，略。

思路二：

- 我们类似上面思路二地做。
- 即证：$\forall \mathbf{x} \in \mathbb{F}^k, ((\mathbf{A} + \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} \mathbf{C} + \mathbf{B} \mathbf{C}) \mathbf{x}$。
- 仍考虑利用引理转移括号，可得 $((\mathbf{A} + \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} + \mathbf{B}) (\mathbf{C} \mathbf{x}) = \mathbf{A} (\mathbf{C} \mathbf{x}) + \mathbf{B} (\mathbf{C} \mathbf{x}) = (\mathbf{A} \mathbf{C}) \mathbf{x} + (\mathbf{B} \mathbf{C}) \mathbf{x} = (\mathbf{A} \mathbf{C} + \mathbf{B} \mathbf{C}) \mathbf{x}$，进而得证。

#### 转置

##### 对合性：$(\mathbf{A}^T)^T = \mathbf{A}$

由定义易证。

##### 关于加法的分配律：$(\mathbf{A} + \mathbf{B})^T = \mathbf{A}^T + \mathbf{B}^T$

- 引理：$(\mathbf{x} + \mathbf{y})^T = \mathbf{x}^T + \mathbf{y}^T$，$\mathbf{A}^T \mathbf{x} = (\mathbf{x}^T \mathbf{A})^T$。
- 即证：$\forall \mathbf{x} \in \mathbb{F}^n, (\mathbf{A} + \mathbf{B})^T \mathbf{x} = (\mathbf{A}^T + \mathbf{B}^T) \mathbf{x}$。
- 还是考虑利用引理转移括号，可得 $(\mathbf{A} + \mathbf{B})^T \mathbf{x} = (\mathbf{x}^T (\mathbf{A} + \mathbf{B}))^T = (\mathbf{x}^T \mathbf{A} + \mathbf{x}^T \mathbf{B})^T = (\mathbf{x}^T \mathbf{A})^T + (\mathbf{x}^T \mathbf{B})^T = \mathbf{A}^T \mathbf{x} + \mathbf{B}^T \mathbf{x} = (\mathbf{A}^T + \mathbf{B}^T) \mathbf{x}$，进而得证。

##### 关于乘法的逆序律：$(\mathbf{A} \mathbf{B})^T = \mathbf{B}^T \mathbf{A}^T$

- 即证：$\forall \mathbf{x} \in \mathbb{F}^n, (\mathbf{A} \mathbf{B})^T \mathbf{x} = (\mathbf{B}^T \mathbf{A}^T) \mathbf{x}$。
- 依旧考虑利用引理转移括号，可得 $(\mathbf{A} \mathbf{B})^T \mathbf{x} = (\mathbf{x}^T (\mathbf{A} \mathbf{B}))^T = ((\mathbf{x}^T \mathbf{A}) \mathbf{B})^T = \mathbf{B}^T (\mathbf{x}^T \mathbf{A}))^T = \mathbf{B}^T (\mathbf{A}^T \mathbf{x}) = (\mathbf{B}^T \mathbf{A}^T) \mathbf{x}$，进而得证。

##### 对称性

当 $\mathbf{A} = \mathbf{A}^T$，称 $\mathbf{A}$ 具有**对称性**；当 $\mathbf{A} = -\mathbf{A}^T$，称 $\mathbf{A}$ 具有**反对称性**。

事实上我们可以将任意方阵 $\mathbf{A}$ 分解为对称阵和反对称阵之和：

$$
\mathbf{A} = \frac{\mathbf{A} + \mathbf{A}^T}{2} + \frac{\mathbf{A} - \mathbf{A}^T}{2}
$$

其中前者为对称阵，后者为反对称阵。

### 乘法的秩与行列式

#### 秩与乘法的性质：$\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \min(\operatorname{rank}(\mathbf{A}), \operatorname{rank}(\mathbf{B}))$

证明：

- $\mathbf{A} \mathbf{B}$ 的各列都能用 $\mathbf{A}$ 的各列线性表出，则 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \operatorname{rank}(\mathbf{A})$。
- _理由是线性表出不会增加线性无关组的大小，因为新向量组仍可由原线性无关组表出。_
- $\mathbf{A} \mathbf{B}$ 的各行都能用 $\mathbf{B}$ 的各行线性表出，则 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \operatorname{rank}(\mathbf{B})$。
- 综上，有 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \min(\operatorname{rank}(\mathbf{A}), \operatorname{rank}(\mathbf{B}))$。

#### 行列式对乘法的分配律：$|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$

思路一：

- 考虑**行列式的全排列定义**，写出等式两边的结果：

$$
\begin{align}
|\mathbf{A} \mathbf{B}| &= \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{i = 1}^n \sum_{j = 1}^n a_{i, j} b_{j, k_i} = \sum_{j_1 = 1}^n \cdots \sum_{j_n = 1}^n \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{i = 1}^n a_{i, j_i} b_{j_i, k_i} \\
|\mathbf{A}| |\mathbf{B}| &= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} (-1)^{\tau(j)} \prod_{i = 1}^n a_{i, j_i} \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{l = 1}^n b_{l, k_l}
\end{align}
$$

- 自然地，若我们要证明两个求和相等，有时可以考虑**项数相等**。等式左边有 $n! n^n$ 项，但右边只有 $(n!)^2$ 项。这暗示我们，左边可能有一些项是可以消掉的。
- 假设 $x < y, j_x = j_y$，若交换 $k_x, k_y$（即令 $k' = E_{x, y}(k)$），注意到 $(-1)^{\tau(k)} + (-1)^{\tau(k')} = 0$，交换前后的贡献加起来为 $0$，原因在于 $b_{j_x, k_x} b_{j_y, k_y} = b_{j_x, k_y} b_{j_y, k_x}$。
- 一般地，定义二元组的比较：$(x_1, y_1) < (x_2, y_2) \Leftrightarrow x_1 < x_2 \lor (x_1 = x_2 \land y_1 < y_2)$。
- 当 $(j_1, \cdots, j_n)$ 不是排列，取最小的二元组 $(x, y)$，使得 $x < y, j_x = j_y$，则此时 $\forall \{k_1, \cdots, k_n\} = \{1, \cdots, n\}$，$k, E_{x, y}(k)$ 产生的贡献可以相消。
- 因此，只需考虑 $(j_1, \cdots, j_n)$ 为排列的情况，即：

$$
|\mathbf{A} \mathbf{B}| = \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{i = 1}^n a_{i, j_i} b_{j_i, k_i}
$$

- 接下来考虑对等式右边做一些调整：

$$
\begin{align}
|\mathbf{A}| |\mathbf{B}| &= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} (-1)^{\tau(j)} \prod_{i = 1}^n a_{i, j_i} \sum_{\{\tilde{k}_1, \cdots, \tilde{k}_n\} = \{1, \cdots, n\}} (-1)^{\tau(j) + \tau(\tilde{k})} \prod_{l = 1}^n a_{j_l, \tilde{k}_l} \\
&= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} \prod_{i = 1}^n a_{i, j_i} \sum_{\{\tilde{k}_1, \cdots, \tilde{k}_n\} = \{1, \cdots, n\}} (-1)^{\tau(\tilde{k})} \prod_{l = 1}^n a_{j_l, \tilde{k}_l} \\
&= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} \sum_{\{\tilde{k}_1, \cdots, \tilde{k}_n\} = \{1, \cdots, n\}} (-1)^{\tau(\tilde{k})} \prod_{i = 1}^n a_{i, j_i} b_{j_i, \tilde{k}_i}
\end{align}
$$

- 进而可证 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。

思路二：

- 考察 $|\mathbf{C}| = \begin{vmatrix} \mathbf{A} & \mathbf{I} \\ \mathbf{O} & \mathbf{B} \end{vmatrix}$。
- 一方面，我们在第一章中已经证明，它就是 $|\mathbf{A}| |\mathbf{B}|$。
- 另一方面，考虑将下面两个 $n \times n$ 的“块”对应地减去上面两个 $n \times n$ 的“块”乘上 $\mathbf{B}$ 得到的矩阵；或者严格地说，$\forall i \in \mathbb{N}_+ \land i \leq n$，进行初等行变换 $P_{i, i + n}(-1)$，可得 $|\mathbf{C}| = \begin{vmatrix} \mathbf{A} & \mathbf{I} \\ -\mathbf{A} \mathbf{B} & \mathbf{O} \end{vmatrix}$。
- 接下来，$\forall i \in \mathbb{N}_+ \land i \leq n$，进行初等列变换 $Q_{i, i + n}$，可得 $|\mathbf{C}| = (-1)^n \begin{vmatrix} \mathbf{I} & \mathbf{A} \\ \mathbf{O} & -\mathbf{A} \mathbf{B} \end{vmatrix} = (-1)^n |\mathbf{I}| |-\mathbf{A} \mathbf{B}| = (-1)^n \cdot 1 \cdot (-1)^n |\mathbf{A} \mathbf{B}| = |\mathbf{A} \mathbf{B}|$。
- 因此可证 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。

思路三：

- 考虑**行列式的公理化定义**，可以发现关于行列式，更加本质的不是包含 $(-1)^{\tau}$ 的式子，而是**初等行列变换**。
- 先考察 $\mathbf{A}, \mathbf{B}$ 为**阶梯阵**的情况，不难发现：(1) $|\mathbf{A}| = \displaystyle\prod_{i = 1}^n a_{i, i}, |\mathbf{B}| = \prod_{i = 1}^n b_{i, i}$；(2) $\mathbf{A} \mathbf{B}$ 也为阶梯阵，其主对角线上的值为 $\mathbf{A}, \mathbf{B}$ 对应位置的值的积 $\Rightarrow |\mathbf{A} \mathbf{B}| = \displaystyle\prod_{i = 1}^n a_{i, i} b_{i, i}$。因此有 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。
- 对于一般的 $\mathbf{A}, \mathbf{B}$，考虑对 $\mathbf{A}$ 进行**初等行变换**消成阶梯阵（即给 $\mathbf{A}$ **左乘初等变换阵** $\mathbf{P}$）、对 $\mathbf{B}$ 进行**初等列变换**消成阶梯阵（即给 $\mathbf{B}$ **右乘初等变换阵** $\mathbf{Q}$），则可知 $|(\mathbf{P} \mathbf{A}) (\mathbf{B} \mathbf{Q})| = |\mathbf{P} \mathbf{A}| |\mathbf{B} \mathbf{Q}|$。
- 初等行列变换对行列式的改变满足 $|\mathbf{P} \mathbf{A}| = |\mathbf{P}| |\mathbf{A}|, |\mathbf{B} \mathbf{Q}| = |\mathbf{B}| |\mathbf{Q}| \Rightarrow |(\mathbf{P} \mathbf{A}) (\mathbf{B} \mathbf{Q})| = |\mathbf{P}| (|\mathbf{A}| |\mathbf{B}|) |\mathbf{Q}|$。
- 因此 $|(\mathbf{P} \mathbf{A}) (\mathbf{B} \mathbf{Q})| = |\mathbf{P} ((\mathbf{A} \mathbf{B}) \mathbf{Q})| = |\mathbf{P}| |(\mathbf{A} \mathbf{B}) \mathbf{Q}| = |\mathbf{P}| |\mathbf{A} \mathbf{B}| |\mathbf{Q}|$。
- 由于 $|\mathbf{P}|, |\mathbf{Q}| \neq 0$，可知 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。

##### 一个扩展情况：$|\mathbf{A}_{m \times n} \mathbf{B}_{n \times m}|$

上面讨论的是 $m = n$ 的情况，下面考虑 $m \neq n$：

1. $m > n$：由于 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \min(\operatorname{rank}(\mathbf{A}), \operatorname{rank}(\mathbf{B})) \leq n < m$，方阵不满秩，故 $|\mathbf{A} \mathbf{B}| = 0$。
2. $m < n$

- 考虑仿照前面思路一地做，可得：

$$
|\mathbf{A} \mathbf{B}| = \sum_{\{j_1, \cdots, j_m\} \subseteq \{1, \cdots, n\}} \sum_{\{k_1, \cdots, k_m\} = \{1, \cdots, m\}} (-1)^{\tau(k)} \prod_{i = 1}^m a_{i, j_i} b_{j_i, k_i}
$$

- 其中 $j$ 的元素**互不相同**。
- 设 $j$ 为 $1 \leq j^*_1 < \cdots < j^*_m \leq n$ 的**排列**，可得：

$$
|\mathbf{A} \mathbf{B}| = \sum_{1 \leq j^*_1 < \cdots < j^*_m \leq n} \sum_{\{j_1, \cdots, j_m\} = \{j^*_1, \cdots, j^*_m\}} \sum_{\{k_1, \cdots, k_m\} = \{1, \cdots, m\}} (-1)^{\tau(k)} \prod_{i = 1}^m a_{i, j_i} b_{j_i, k_i}
$$

- 可以发现，后面枚举 $j, k$ 那坨就是 $|\mathbf{A} \dbinom{1, \cdots, m}{j^*_1, \cdots, j^*_m} \cdot \mathbf{B} \dbinom{j^*_1, \cdots, j^*_m}{1, \cdots, m}|$，代入可知：

$$
|\mathbf{A} \mathbf{B}| = \sum_{1 \leq j^*_1 < \cdots < j^*_m \leq n} |\mathbf{A} \dbinom{1, \cdots, m}{j^*_1, \cdots, j^*_m} \cdot \mathbf{B} \dbinom{j^*_1, \cdots, j^*_m}{1, \cdots, m}|
$$

- _这一结论被称作柯西-比内 Cauchy-Binet 公式。_

### 矩阵的逆

#### 定义

对于方阵 $\mathbf{A}_{n \times n}$：

- 若 $\exists \mathbf{B}_{n \times n}, \text{s.t. } \mathbf{B} \mathbf{A} = \mathbf{I}_n$，则称 $\mathbf{B}$ 为 $\mathbf{A}$ 的左逆。
- 若 $\exists \mathbf{C}_{n \times n}, \text{s.t. } \mathbf{A} \mathbf{C} = \mathbf{I}_n$，则称 $\mathbf{C}$ 为 $\mathbf{A}$ 的右逆。

#### 若左、右逆均存在，则两者相等。

证明：$\mathbf{B} = \mathbf{B} \mathbf{I}_n = \mathbf{B} (\mathbf{A} \mathbf{C}) = (\mathbf{B} \mathbf{A}) \mathbf{C} = \mathbf{I}_n \mathbf{C} = \mathbf{C}$。
