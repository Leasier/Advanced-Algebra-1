# 第三章 矩阵

### 矩阵的加法、乘法与转置

#### 加法

跟向量一致，矩阵“传承”了原数域关于加法的性质，具有交换律、结合律、零元、负元。

##### 关于转置的分配律：$(\mathbf{A} + \mathbf{B})^T = \mathbf{A}^T + \mathbf{B}^T$。

证明略。

##### 定理：$\operatorname{rank}(\mathbf{A} + \mathbf{B}) \leq \operatorname{rank}(\mathbf{A}) + \operatorname{rank}(\mathbf{B})$

证明：

- 取 $\mathbf{A}$ 的行向量的极大无关组 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}\}$，$\mathbf{B}$ 的向量极大无关组 $\{\mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}$。
- $\forall i \in \mathbb{N}_+ \land i \leq m$，有 $\exists \lambda_1, \cdots, \lambda_x \in \mathbb{F}, \text{s.t. } \mathbf{a}_i = \displaystyle\sum_{k = 1}^x \lambda_k \mathbf{a}_{i_k}$ 且 $\exists \mu_1, \cdots, \mu_y \in \mathbb{F}, \text{s.t. } \mathbf{b}_i = \displaystyle\sum_{k = 1}^y \mu_k \mathbf{b}_{j_k}$。
- 则 $\mathbf{a}_i + \mathbf{b}_i = \displaystyle\sum_{k = 1}^x \lambda_k \mathbf{a}_{i_k} + \sum_{k = 1}^y \mu_k \mathbf{b}_{j_k}$，即 $\mathbf{a}_i + \mathbf{b}_i$ 可被 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}, \mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}$，线性表出。
- 故 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}, \mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}$ 可以线性表出 $\{\mathbf{a}_1, \cdots, \mathbf{a}_m, \mathbf{b}_1, \cdots, \mathbf{b}_m\}$，于是 $\operatorname{rank}(\mathbf{C}) = \operatorname{rank}(\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_x}, \mathbf{b}_{j_1}, \cdots, \mathbf{b}_{j_y}\}) \leq x + y = \operatorname{rank}(\mathbf{A}) + \operatorname{rank}(\mathbf{B})$。

##### 推论（“三角不等式”）：$|\operatorname{rank}(\mathbf{A}) - \operatorname{rank}(\mathbf{B})| \leq \operatorname{rank}(\mathbf{A} \pm \mathbf{B}) \leq \operatorname{rank}(\mathbf{A}) + \operatorname{rank}(\mathbf{B})$。

证明略。

#### 乘法

##### 线性性：$\mathbf{A} (\lambda \mathbf{x} + \mu \mathbf{y}) = \lambda (\mathbf{A} \mathbf{x}) + \mu (\mathbf{A} \mathbf{y})$，$(\lambda \mathbf{A} + \mu \mathbf{B}) \mathbf{x} = \lambda (\mathbf{A} \mathbf{x}) + \mu (\mathbf{B} \mathbf{x})$。

证明略。

##### 定理：若 $\mathbf{D}_{m \times n}, \tilde{\mathbf{D}}_{m \times n}$ 满足 $\forall \mathbf{x} \in \mathbf{F}^m, \mathbf{D} \mathbf{x} = \tilde{\mathbf{D}} \mathbf{x}$，则 $\mathbf{D} = \tilde{\mathbf{D}}$。

证明略。

- 我们最初引入矩阵与向量的乘法时，本质上只是一个用来表示线性方程组的记号，有关矩阵的更多性质，实际上是“未定义”的。
- 这个定理告诉我们，矩阵本身是可以由矩阵与向量的乘法定义的。

##### 对角阵

记对角阵 $\mathbf{A}_{n \times n} = \text{diag}(\lambda_1, \cdots, \lambda_n)$，即其主对角线上的数分别为 $\lambda_1, \cdots, \lambda_n$。

考察任一方阵 $\mathbf{B}_{n \times n}$ 左 / 右乘它的结果：

- $\mathbf{A} \mathbf{B} = \begin{bmatrix} \lambda_1 \mathbf{b}_1 \\ \vdots \\ \lambda_n \mathbf{b}_n \end{bmatrix}$。
- $\mathbf{B} \mathbf{A} = \begin{bmatrix} \lambda_1 \tilde{\mathbf{b}}_1 & \cdots & \lambda_n \tilde{\mathbf{b}}_n \end{bmatrix}$。

特别地，当 $\lambda_1 = \cdots = \lambda_n = \lambda$，称 $\mathbf{A}$ 为纯量阵，且有 $\mathbf{A} = \lambda \mathbf{I}_n$。

##### 结合律：设 $\mathbf{A}_{n \times m}, \mathbf{B}_{m \times k}, \mathbf{C}_{k \times s}$，则 $(\mathbf{A} \mathbf{B}) \mathbf{C} = \mathbf{A} (\mathbf{B} \mathbf{C})$。

思路一：直接展开矩阵乘法，交换求和符号即可得证。

思路二：

- 考虑贯彻**由矩阵与向量的乘法定义矩阵本身**的思想。
- 引理：$(\mathbf{A} \mathbf{B}) \mathbf{x} = \mathbf{A} (\mathbf{B} \mathbf{x})$。同思路一易证。
- 即证：$\forall \mathbf{x} \in \mathbb{F}^s, ((\mathbf{A} \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} (\mathbf{B} \mathbf{C})) \mathbf{x}$。
- 考虑利用引理转移括号，可得 $((\mathbf{A} \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} \mathbf{B}) (\mathbf{C} \mathbf{x}) = \mathbf{A} (\mathbf{B} (\mathbf{C} \mathbf{x})) = \mathbf{A} ((\mathbf{B} \mathbf{C}) \mathbf{x}) = (\mathbf{A} (\mathbf{B} \mathbf{C})) \mathbf{x}$，进而得证。

##### 关于加法的分配律

- 设 $\mathbf{A}_{n \times m}, \mathbf{B}_{n \times m}, \mathbf{C}_{m \times k}$，则 $(\mathbf{A} + \mathbf{B}) \mathbf{C} = \mathbf{A} \mathbf{C} + \mathbf{B} \mathbf{C}$。
- 设 $\mathbf{A}_{n \times m}, \mathbf{B}_{m \times k}, \mathbf{C}_{m \times k}$，则 $\mathbf{A} (\mathbf{B} + \mathbf{C}) = \mathbf{A} \mathbf{B} + \mathbf{A} \mathbf{C}$。

下证前者。

思路一：同上思路一，略。

思路二：

- 我们类似上面思路二地做。
- 即证：$\forall \mathbf{x} \in \mathbb{F}^k, ((\mathbf{A} + \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} \mathbf{C} + \mathbf{B} \mathbf{C}) \mathbf{x}$。
- 仍考虑利用引理转移括号，可得 $((\mathbf{A} + \mathbf{B}) \mathbf{C}) \mathbf{x} = (\mathbf{A} + \mathbf{B}) (\mathbf{C} \mathbf{x}) = \mathbf{A} (\mathbf{C} \mathbf{x}) + \mathbf{B} (\mathbf{C} \mathbf{x}) = (\mathbf{A} \mathbf{C}) \mathbf{x} + (\mathbf{B} \mathbf{C}) \mathbf{x} = (\mathbf{A} \mathbf{C} + \mathbf{B} \mathbf{C}) \mathbf{x}$，进而得证。

#### 转置

##### 对合性：$(\mathbf{A}^T)^T = \mathbf{A}$

由定义易证。

##### 关于加法的分配律：$(\mathbf{A} + \mathbf{B})^T = \mathbf{A}^T + \mathbf{B}^T$

- 引理：$(\mathbf{x} + \mathbf{y})^T = \mathbf{x}^T + \mathbf{y}^T$，$\mathbf{A}^T \mathbf{x} = (\mathbf{x}^T \mathbf{A})^T$。
- 即证：$\forall \mathbf{x} \in \mathbb{F}^n, (\mathbf{A} + \mathbf{B})^T \mathbf{x} = (\mathbf{A}^T + \mathbf{B}^T) \mathbf{x}$。
- 还是考虑利用引理转移括号，可得 $(\mathbf{A} + \mathbf{B})^T \mathbf{x} = (\mathbf{x}^T (\mathbf{A} + \mathbf{B}))^T = (\mathbf{x}^T \mathbf{A} + \mathbf{x}^T \mathbf{B})^T = (\mathbf{x}^T \mathbf{A})^T + (\mathbf{x}^T \mathbf{B})^T = \mathbf{A}^T \mathbf{x} + \mathbf{B}^T \mathbf{x} = (\mathbf{A}^T + \mathbf{B}^T) \mathbf{x}$，进而得证。

##### 关于乘法的逆序律：$(\mathbf{A} \mathbf{B})^T = \mathbf{B}^T \mathbf{A}^T$

- 即证：$\forall \mathbf{x} \in \mathbb{F}^n, (\mathbf{A} \mathbf{B})^T \mathbf{x} = (\mathbf{B}^T \mathbf{A}^T) \mathbf{x}$。
- 依旧考虑利用引理转移括号，可得 $(\mathbf{A} \mathbf{B})^T \mathbf{x} = (\mathbf{x}^T (\mathbf{A} \mathbf{B}))^T = ((\mathbf{x}^T \mathbf{A}) \mathbf{B})^T = \mathbf{B}^T (\mathbf{x}^T \mathbf{A}))^T = \mathbf{B}^T (\mathbf{A}^T \mathbf{x}) = (\mathbf{B}^T \mathbf{A}^T) \mathbf{x}$，进而得证。

##### 对称性

当 $\mathbf{A} = \mathbf{A}^T$，称 $\mathbf{A}$ 具有**对称性**；当 $\mathbf{A} = -\mathbf{A}^T$，称 $\mathbf{A}$ 具有**反对称性**。

事实上我们可以将任意方阵 $\mathbf{A}$ 分解为对称阵和反对称阵之和：

$$
\mathbf{A} = \frac{\mathbf{A} + \mathbf{A}^T}{2} + \frac{\mathbf{A} - \mathbf{A}^T}{2}
$$

其中前者为对称阵，后者为反对称阵。

### 乘法的秩与行列式

#### 秩与乘法的性质：$\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \min(\operatorname{rank}(\mathbf{A}), \operatorname{rank}(\mathbf{B}))$

证明：

- $\mathbf{A} \mathbf{B}$ 的各列都能用 $\mathbf{A}$ 的各列线性表出，则 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \operatorname{rank}(\mathbf{A})$。
- _理由是线性表出不会增加线性无关组的大小，因为新向量组仍可由原线性无关组表出。_
- $\mathbf{A} \mathbf{B}$ 的各行都能用 $\mathbf{B}$ 的各行线性表出，则 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \operatorname{rank}(\mathbf{B})$。
- 综上，有 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \min(\operatorname{rank}(\mathbf{A}), \operatorname{rank}(\mathbf{B}))$。

#### 行列式对乘法的分配律：$|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$

思路一：

- 考虑**行列式的全排列定义**，写出等式两边的结果：

$$
\begin{align}
|\mathbf{A} \mathbf{B}| &= \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{i = 1}^n \sum_{j = 1}^n a_{i, j} b_{j, k_i} = \sum_{j_1 = 1}^n \cdots \sum_{j_n = 1}^n \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{i = 1}^n a_{i, j_i} b_{j_i, k_i} \\
|\mathbf{A}| |\mathbf{B}| &= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} (-1)^{\tau(j)} \prod_{i = 1}^n a_{i, j_i} \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{l = 1}^n b_{l, k_l}
\end{align}
$$

- 自然地，若我们要证明两个求和相等，有时可以考虑**项数相等**。等式左边有 $n! n^n$ 项，但右边只有 $(n!)^2$ 项。这暗示我们，左边可能有一些项是可以消掉的。
- 假设 $x < y, j_x = j_y$，若交换 $k_x, k_y$（即令 $k' = E_{x, y}(k)$），注意到 $(-1)^{\tau(k)} + (-1)^{\tau(k')} = 0$，交换前后的贡献加起来为 $0$，原因在于 $b_{j_x, k_x} b_{j_y, k_y} = b_{j_x, k_y} b_{j_y, k_x}$。
- 一般地，定义二元组的比较：$(x_1, y_1) < (x_2, y_2) \Leftrightarrow x_1 < x_2 \lor (x_1 = x_2 \land y_1 < y_2)$。
- 当 $(j_1, \cdots, j_n)$ 不是排列，取最小的二元组 $(x, y)$，使得 $x < y, j_x = j_y$，则此时 $\forall \{k_1, \cdots, k_n\} = \{1, \cdots, n\}$，$k, E_{x, y}(k)$ 产生的贡献可以相消。
- 因此，只需考虑 $(j_1, \cdots, j_n)$ 为排列的情况，即：

$$
|\mathbf{A} \mathbf{B}| = \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} \sum_{\{k_1, \cdots, k_n\} = \{1, \cdots, n\}} (-1)^{\tau(k)} \prod_{i = 1}^n a_{i, j_i} b_{j_i, k_i}
$$

- 接下来考虑对等式右边做一些调整：

$$
\begin{align}
|\mathbf{A}| |\mathbf{B}| &= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} (-1)^{\tau(j)} \prod_{i = 1}^n a_{i, j_i} \sum_{\{\tilde{k}_1, \cdots, \tilde{k}_n\} = \{1, \cdots, n\}} (-1)^{\tau(j) + \tau(\tilde{k})} \prod_{l = 1}^n a_{j_l, \tilde{k}_l} \\
&= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} \prod_{i = 1}^n a_{i, j_i} \sum_{\{\tilde{k}_1, \cdots, \tilde{k}_n\} = \{1, \cdots, n\}} (-1)^{\tau(\tilde{k})} \prod_{l = 1}^n a_{j_l, \tilde{k}_l} \\
&= \sum_{\{j_1, \cdots, j_n\} = \{1, \cdots, n\}} \sum_{\{\tilde{k}_1, \cdots, \tilde{k}_n\} = \{1, \cdots, n\}} (-1)^{\tau(\tilde{k})} \prod_{i = 1}^n a_{i, j_i} b_{j_i, \tilde{k}_i}
\end{align}
$$

- 进而可证 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。

思路二：

- 考察 $|\mathbf{C}| = \begin{vmatrix} \mathbf{A} & \mathbf{I} \\ \mathbf{O} & \mathbf{B} \end{vmatrix}$。
- 一方面，我们在第一章中已经证明，它就是 $|\mathbf{A}| |\mathbf{B}|$。
- 另一方面，考虑将下面两个 $n \times n$ 的“块”对应地减去上面两个 $n \times n$ 的“块”乘上 $\mathbf{B}$ 得到的矩阵；或者严格地说，$\forall i \in \mathbb{N}_+ \land i \leq n$，进行初等行变换 $P_{i, i + n}(-1)$，可得 $|\mathbf{C}| = \begin{vmatrix} \mathbf{A} & \mathbf{I} \\ -\mathbf{A} \mathbf{B} & \mathbf{O} \end{vmatrix}$。
- 接下来，$\forall i \in \mathbb{N}_+ \land i \leq n$，进行初等列变换 $Q_{i, i + n}$，可得 $|\mathbf{C}| = (-1)^n \begin{vmatrix} \mathbf{I} & \mathbf{A} \\ \mathbf{O} & -\mathbf{A} \mathbf{B} \end{vmatrix} = (-1)^n |\mathbf{I}| |-\mathbf{A} \mathbf{B}| = (-1)^n \cdot 1 \cdot (-1)^n |\mathbf{A} \mathbf{B}| = |\mathbf{A} \mathbf{B}|$。
- 因此可证 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。

思路三：

- 考虑**行列式的公理化定义**，可以发现关于行列式，更加本质的不是包含 $(-1)^{\tau}$ 的式子，而是**初等行列变换**。
- 先考察 $\mathbf{A}, \mathbf{B}$ 为**阶梯阵**的情况，不难发现：(1) $|\mathbf{A}| = \displaystyle\prod_{i = 1}^n a_{i, i}, |\mathbf{B}| = \prod_{i = 1}^n b_{i, i}$；(2) $\mathbf{A} \mathbf{B}$ 也为阶梯阵，其主对角线上的值为 $\mathbf{A}, \mathbf{B}$ 对应位置的值的积 $\Rightarrow |\mathbf{A} \mathbf{B}| = \displaystyle\prod_{i = 1}^n a_{i, i} b_{i, i}$。因此有 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。
- 对于一般的 $\mathbf{A}, \mathbf{B}$，考虑对 $\mathbf{A}$ 进行**初等行变换**消成阶梯阵（即给 $\mathbf{A}$ **左乘初等变换阵** $\mathbf{P}$）、对 $\mathbf{B}$ 进行**初等列变换**消成阶梯阵（即给 $\mathbf{B}$ **右乘初等变换阵** $\mathbf{Q}$），则可知 $|(\mathbf{P} \mathbf{A}) (\mathbf{B} \mathbf{Q})| = |\mathbf{P} \mathbf{A}| |\mathbf{B} \mathbf{Q}|$。
- 初等行列变换对行列式的改变满足 $|\mathbf{P} \mathbf{A}| = |\mathbf{P}| |\mathbf{A}|, |\mathbf{B} \mathbf{Q}| = |\mathbf{B}| |\mathbf{Q}| \Rightarrow |(\mathbf{P} \mathbf{A}) (\mathbf{B} \mathbf{Q})| = |\mathbf{P}| (|\mathbf{A}| |\mathbf{B}|) |\mathbf{Q}|$。
- 因此 $|(\mathbf{P} \mathbf{A}) (\mathbf{B} \mathbf{Q})| = |\mathbf{P} ((\mathbf{A} \mathbf{B}) \mathbf{Q})| = |\mathbf{P}| |(\mathbf{A} \mathbf{B}) \mathbf{Q}| = |\mathbf{P}| |\mathbf{A} \mathbf{B}| |\mathbf{Q}|$。
- 由于 $|\mathbf{P}|, |\mathbf{Q}| \neq 0$，可知 $|\mathbf{A} \mathbf{B}| = |\mathbf{A}| |\mathbf{B}|$。

##### 一个扩展情况：$|\mathbf{A}_{m \times n} \mathbf{B}_{n \times m}|$

上面讨论的是 $m = n$ 的情况，下面考虑 $m \neq n$：

1. $m > n$：由于 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \min(\operatorname{rank}(\mathbf{A}), \operatorname{rank}(\mathbf{B})) \leq n < m$，方阵不满秩，故 $|\mathbf{A} \mathbf{B}| = 0$。
2. $m < n$

- 考虑仿照前面思路一地做，可得：

$$
|\mathbf{A} \mathbf{B}| = \sum_{\{j_1, \cdots, j_m\} \subseteq \{1, \cdots, n\}} \sum_{\{k_1, \cdots, k_m\} = \{1, \cdots, m\}} (-1)^{\tau(k)} \prod_{i = 1}^m a_{i, j_i} b_{j_i, k_i}
$$

- 其中 $j$ 的元素**互不相同**。
- 设 $j$ 为 $1 \leq j^*_1 < \cdots < j^*_m \leq n$ 的**排列**，可得：

$$
|\mathbf{A} \mathbf{B}| = \sum_{1 \leq j^*_1 < \cdots < j^*_m \leq n} \sum_{\{j_1, \cdots, j_m\} = \{j^*_1, \cdots, j^*_m\}} \sum_{\{k_1, \cdots, k_m\} = \{1, \cdots, m\}} (-1)^{\tau(k)} \prod_{i = 1}^m a_{i, j_i} b_{j_i, k_i}
$$

- 可以发现，后面枚举 $j, k$ 那坨就是 $|\mathbf{A} \dbinom{1, \cdots, m}{j^*_1, \cdots, j^*_m} \cdot \mathbf{B} \dbinom{j^*_1, \cdots, j^*_m}{1, \cdots, m}|$，代入可知：

$$
|\mathbf{A} \mathbf{B}| = \sum_{1 \leq j^*_1 < \cdots < j^*_m \leq n} |\mathbf{A} \dbinom{1, \cdots, m}{j^*_1, \cdots, j^*_m}| |\mathbf{B} \dbinom{j^*_1, \cdots, j^*_m}{1, \cdots, m}|
$$

- _这一结论被称作柯西-比内 Cauchy-Binet 公式。_

### 矩阵的逆

#### 定义

对于方阵 $\mathbf{A}_{n \times n}$：

- 若 $\exists \mathbf{B}_{n \times n}, \text{s.t. } \mathbf{B} \mathbf{A} = \mathbf{I}_n$，则称 $\mathbf{B}$ 为 $\mathbf{A}$ 的左逆。
- 若 $\exists \mathbf{C}_{n \times n}, \text{s.t. } \mathbf{A} \mathbf{C} = \mathbf{I}_n$，则称 $\mathbf{C}$ 为 $\mathbf{A}$ 的右逆。

#### 定理：若左、右逆均存在，则两者相等。

证明：

- 假设 $\mathbf{B}, \mathbf{C}$ 分别为 $\mathbf{A}$ 的左、右逆。
- 于是 $\mathbf{B} = \mathbf{B} \mathbf{I}_n = \mathbf{B} (\mathbf{A} \mathbf{C}) = (\mathbf{B} \mathbf{A}) \mathbf{C} = \mathbf{I}_n \mathbf{C} = \mathbf{C}$，故左右逆相等。

因此，当左、右逆均存在，我们不再加以区分，并称 $\mathbf{A}$ **可逆**，称之为 $\mathbf{A}$ 的**逆矩阵**，记作 $\mathbf{A}^{-1}$。

#### 命题：$\mathbf{A}$ 非奇异是 $\mathbf{A}$ 可逆的必要条件。

证明：设 $\mathbf{B}$ 为 $\mathbf{A}$ 的逆，则 $|\mathbf{A}| |\mathbf{B}| = |\mathbf{I_n}| = 1 \neq 0 \Rightarrow |\mathbf{A}| \neq 0$，即 $\mathbf{A}$ 非奇异。

#### 定理：若 $\mathbf{A}$ 可逆，则其逆 $\mathbf{A}^{-1}$ 唯一。

思路一：

- 考察 $\mathbf{A}$ 的右逆 $\mathbf{B} = \begin{bmatrix} \tilde{\mathbf{b}}_1 & \cdots & \tilde{\mathbf{b}}_n \end{bmatrix}$。
- 于是 $\mathbf{A} \tilde{\mathbf{b}}_i = \mathbf{e}_i$，而由 $\mathbf{A}$ 可逆知 $\mathbf{A}$ 非奇异，故有 $\tilde{\mathbf{b}}_i$ 唯一。
- 因此由其铺排而成的 $\mathbf{B}$ 唯一。

思路二：

- 假设 $\mathbf{B}, \mathbf{C}$ 都是 $\mathbf{A}$ 的逆，则它们都是左、右逆。
- 因此 $\mathbf{B} = \mathbf{B} \mathbf{I}_n = \mathbf{B} (\mathbf{A} \mathbf{C}) = (\mathbf{B} \mathbf{A}) \mathbf{C} = \mathbf{I}_n \mathbf{C} = \mathbf{C}$，故两者相等，即逆唯一。
- ~~这个证明挺有意思的，直接复刻了上面证明左右逆存在则相等的式子（~~

#### 命题（伴随矩阵）：$\mathbf{A}$ 非奇异是 $\mathbf{A}$ 可逆的充分条件。

证明（**构造性**）：

- 定义 $\mathbf{A}$ 的**伴随矩阵** $\mathbf{A}^* = (A_{j, i})_{n \times n}$，其各项为 $\mathbf{A}$ 的代数余子式。
- 由按行展开的结果，可知 $\mathbf{A} \mathbf{A}^*$ 的 $(i, j)$ 项为 $\displaystyle\sum_{k = 1}^n a_{i, k} A_{j, k} = [i = j] |\mathbf{A}|$。
- 由 $\mathbf{A}$ 非奇异可知 $|\mathbf{A}| \neq 0$，进而有 $\mathbf{A} \cdot \dfrac{\mathbf{A^*}}{|\mathbf{A}|} = \mathbf{I}_n$，故 $\dfrac{\mathbf{A^*}}{|\mathbf{A}|}$ 为 $\mathbf{A}$ 的右逆。
- 由按列展开的结果，同理可知 $\dfrac{\mathbf{A^*}}{|\mathbf{A}|}$ 也为 $\mathbf{A}$ 的左逆。
- 故 $\mathbf{A}$ 的左、右逆存在且相等，故 $\mathbf{A}$ 可逆。

一个可能较为自然的理解方式是（下面讨论右逆）：

- 考察 $\mathbf{A}$ 的右逆 $\mathbf{B} = \begin{bmatrix} \tilde{\mathbf{b}}_1 & \cdots & \tilde{\mathbf{b}}_n \end{bmatrix}$。
- 解方程 $\mathbf{A} \tilde{\mathbf{b}}_i = \mathbf{e}_i$，可以发现 $\forall j \in \mathbb{N}_+ \land j \leq n$，我们要求 $\displaystyle\sum_{k = 1}^n a_{j, k} b_{k, i} = [j = i]$。
- _Motivation：等一下，这个好像跟代数余子式挺像的？_
- 故令 $b_{k, i} = \dfrac{A_{i, k}}{|\mathbf{A}|}$ 即可。

#### 定理：$\mathbf{A}$ 非奇异是 $\mathbf{A}$ 可逆的充要条件。

上文已证必要性和充分性。

#### 求解逆矩阵

##### 法一：伴随矩阵

~~很遗憾，按定义直接算的时间复杂度为 $O(n^5)$，还是下一个吧。~~

##### 法二：高斯消去法

考察 $\mathbf{A}$ 的逆 $\mathbf{B} = \begin{bmatrix} \tilde{\mathbf{b}}_1 & \cdots & \tilde{\mathbf{b}}_n \end{bmatrix}$。

- _Motivation：分列线性方程组，可以发现：由于 $\mathbf{A}$ 一致，消去的过程是一致的。_

考虑对 $[\mathbf{A} \mid \mathbf{I}_n]$ 做高斯消去法，使得左侧变为 $\mathbf{I}_n$：由于 $\mathbf{A}$ 非奇异，我们首先可以将左侧消成阶梯阵，此时对角线上的元素非零，因此可以从下到上依次将每行消成与 $\mathbf{I}_n$ 相应行一致。

此时，右边 $n \times n$ 矩阵的第 $i$ 列即为解出来的 $\tilde{\mathbf{b}}_i$，故得到的就是 $[\mathbf{I}_n \mid \mathbf{B}]$，即提取右半部分可得答案。

##### 扩展：线性方程组 Revisit

当 $\mathbf{A}$ 非奇异，$\mathbf{A} \mathbf{x} = \mathbf{b} \Rightarrow \mathbf{A}^{-1} (\mathbf{A} \mathbf{x}) = \mathbf{A}^{-1} \mathbf{b} \Rightarrow \mathbf{x} = \mathbf{A}^{-1} \mathbf{b}$。

~~因此，对于同一个 $\mathbf{A}$，我们得到了一个 $O(n^3) \sim O(n^2)$ 的解线性方程组的算法。~~

------

[例 1] 给定 $\mathbf{N} = ([j - i = 1])_{n \times n}$，已知 $\lambda \neq 0$，求 $(\lambda \mathbf{I}_n + \mathbf{N})^{-1}$。

$$
\begin{align}
(\lambda \mathbf{I}_n + \mathbf{N})^{-1} &= \frac{1}{\lambda} (\mathbf{I}_n + \frac{\mathbf{N}}{\lambda})^{-1} \\
&= \frac{1}{\lambda} \sum_{i = 0}^{n - 1} (-\frac{\mathbf{N}}{\lambda})^i
\end{align}
$$

- 最后一步的依据是 $(\mathbf{I} + \dfrac{\mathbf{N}}{\lambda}) \displaystyle\sum_{i = 0}^{n - 1} (-\frac{\mathbf{N}}{\lambda})^i = \mathbf{I} - (-\frac{\mathbf{N}}{\lambda})^n = \mathbf{I}$；或者感性地说，高次项全为 $0$。

[例 2] 给定 $\mathbf{A}_n = \operatorname{tridag}(-1, 2, -1)_n$，求 $(\mathbf{A}_n)^{-1}$。

##### 法一：高斯消去法

注意到各列的和依次为 $1, 0, 0, \cdots, 0, 1$，考虑把除第一行外的所有行加到第一行，得到 $1, 0, 0, \cdots, 0, 1 \mid 1, 1, 1, \cdots, 1, 1$。

接下来，$\mathbf{A}_n$ 右下 $(n - 1) \times (n - 1)$ 结构与之相似。因此，考虑继续把除前两行之外的所有行加到第二行，得到 $0, 1, 0, \cdots, 0, 2 \mid 1, 2, 2, \cdots, 2$。

再把除前三行之外的所有行加到第三行，得到 $0, 0, 1, \cdots, 0, 3 \mid 1, 2, 3, \cdots, 3$。

如此续行，处理完第 $1 \sim n - 1$ 行，最后再将第 $n - 1$ 行加到第 $n$ 行。

最终得到的 $[\mathbf{A}' \mid \mathbf{B}]$ 形如 $a'_{i, j} = [i = j] + i, b_{i, j} = \min(i, j)$。

首先进行初等行变换 $P_n(\dfrac{1}{n + 1})$，将 $a'_{n, n} = n + 1$ 变为 $1$，此时 $b_{n, i}$ 变为 $\dfrac{i}{n + 1}$。

接下来用第 $n$ 行消除其他 $\forall i \in \mathbb{N}_+ \land i < n, a'_{i, n}$，即进行初等行变换 $P_{n, i}(-i)$，此时 $b_{i, j}$ 变为 $\min(i, j) - \dfrac{ij}{n + 1}$。

由于 $i = n$ 时这个式子也成立，我们可得 $(\mathbf{A}_n)^{-1} = (\min(i, j) - \dfrac{ij}{n + 1})_{n \times n}$，若展开则是：

$$
\begin{bmatrix}
\dfrac{n}{n + 1} & \dfrac{n - 1}{n + 1} & \dfrac{n - 2}{n + 1} & \cdots & \dfrac{2}{n + 1} & \dfrac{1}{n + 1} \\
\dfrac{n - 1}{n + 1} & \dfrac{2(n - 1)}{n + 1} & \dfrac{2(n - 2)}{n + 1} & \cdots & \dfrac{4}{n + 1} & \dfrac{2}{n + 1} \\
\dfrac{n - 2}{n + 1} & \dfrac{2(n - 2)}{n + 1} & \dfrac{3(n - 2)}{n + 1} & \cdots & \dfrac{6}{n + 1} & \dfrac{3}{n + 1} \\
\cdots & \cdots & \cdots & \cdots & \cdots & \cdots \\
\dfrac{2}{n + 1} & \dfrac{4}{n + 1} & \dfrac{6}{n + 1} & \cdots & \dfrac{2 (n - 1)}{n + 1} & \dfrac{n - 1}{n + 1} \\
\dfrac{1}{n + 1} & \dfrac{2}{n + 1} & \dfrac{3}{n + 1} & \cdots & \dfrac{n - 1}{n + 1} & \dfrac{n}{n + 1}
\end{bmatrix}
$$

##### 法二：伴随矩阵 + 稀疏矩阵递推

根据我们在第一章里算过的结果，易知 $|\mathbf{A}_n| = n + 1$。

设 $\mathbf{B} = (b_{i, j})_{n \times n} = \mathbf{A}^{-1}$，接下来我们先算对角线上的值：

- $b_{1, 1} = A_{1, 1} = \dfrac{|\mathbf{A}_{n - 1}|}{|\mathbf{A}_n|} = \dfrac{n}{n + 1}$。
- $\forall i \in [2, n - 1] \cap \mathbb{N}, b_{i, i} = A_{i, i} = \dfrac{|\mathbf{A}_{i - 1}| |\mathbf{A}_{n - i}|}{|\mathbf{A}_n|} = \dfrac{i(n - i + 1)}{n + 1}$。
- $b_{n, n} = A_{n, n} = \dfrac{|\mathbf{A}_{n - 1}|}{|\mathbf{A}_n|} = \dfrac{n}{n + 1}$。

对于对角线以外的部分，一个《自然》的想法是硬算行列式，但这样显然是不优雅的。

事实上，利用每行每列非零项不超过 $3$ 的性质——或者说**稀疏性**，我们可以尝试从逆矩阵的定义出发“roll”出各项来。

不妨先看第一列的情况，即解方程：

$$
\mathbf{A} \begin{bmatrix} b_{1, 1} \\ b_{2, 1} \\ \vdots \\ b_{n, 1} \end{bmatrix} = \begin{bmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}
$$

首先来算 $b_{2, 1}$，考察单位向量的第一个分量 $1$ 有：$2 b_{1, 1} - b_{2, 1} = 1 \Rightarrow b_{2, 1} = \dfrac{n - 1}{n + 1}$。

接下来考察第二个分量 $0$ 有：$-b_{1, 1} + 2 b_{2, 1} - b_{3, 1} = 0 \Rightarrow b_{3, 1} = \dfrac{n - 2}{n + 1}$。

依此类推（需要特判第 $n$ 个分量），我们最终求得：$\forall i \in \mathbb{N}_+ \land i \leq n, b_{i, 1} = \dfrac{n - i + 1}{n + 1}$。

接下来看第二列的情况。**由于 $\mathbf{A}$ 为对称阵，我们只需研究第二列以下的部分。**

首先来算 $b_{3, 2}$，考察单位向量的第二个分量 $1$ 有：$-b_{1, 2} + 2 b_{2, 2} - b_{3, 2} = 1 \Rightarrow b_{3, 2} = \dfrac{2(n - 2)}{n + 1}$。

接下来考察第三个分量 $0$ 有：$-b_{2, 2} + 2 b_{3, 2} - b_{4, 2} = 0 \Rightarrow b_{4, 2} = \dfrac{2(n - 3)}{n + 1}$。

仍旧依此类推（依然需要特判第 $n$ 个分量），我们最终求得：$\forall i \in [2, n] \cap \mathbb{N}, b_{i, 2} = \dfrac{2(n - i + 1)}{n + 1}$。

事实上，一般地，我们可以说明 $\forall j \in \mathbb{N}_+ \land j \leq n, i \in [j, n] \cap \mathbb{N}, b_{i, j} = \dfrac{j (n - i + 1)}{n + 1} = j - \dfrac{ij}{n + 1}$。

因此，$\mathbf{A}^{-1} = (\min(i, j) - \dfrac{ij}{n + 1})_{n \times n}$。

------

#### 关于乘法的逆序律

内容：$(\mathbf{A} \mathbf{B})^{-1} = \mathbf{B}^{-1} \mathbf{A}^{-1}$。

证明：$(\mathbf{A} \mathbf{B}) (\mathbf{B}^{-1} \mathbf{A}^{-1}) = \mathbf{A} (\mathbf{B} \mathbf{B}^{-1}) \mathbf{A}^{-1} = \mathbf{A} \mathbf{I} \mathbf{A}^{-1} = \mathbf{A} \mathbf{A}^{-1} = \mathbf{I}$。

#### 关于转置的交换律

内容：$(\mathbf{A}^{-1})^T = (\mathbf{A}^T)^{-1}$。

证明：$(\mathbf{A}^{-1} \mathbf{A})^T = \mathbf{I} \Rightarrow \mathbf{A}^T (\mathbf{A}^{-1})^T = \mathbf{I} \Rightarrow \mathbf{A}^{-1})^T = (\mathbf{A}^T)^{-1}$。

因此，我们记 $\mathbf{A}^{-T} = (\mathbf{A}^{-1})^T = (\mathbf{A}^T)^{-1}$。易证“逆转”关于乘法的分配律 $(\mathbf{A} \mathbf{B})^{-T} = \mathbf{A}^{-T} \mathbf{B}^{-T}$。

#### 初等变换阵与逆

考虑我们用高斯消去法求逆的结果：$\mathbf{P}_l \times \cdots \times \mathbf{P}_1 \times \mathbf{A} = \mathbf{I}$。

考虑左、右逆相等的性质，任取 $i$，我们可以得到：$\mathbf{P}_i \times \cdots \times \mathbf{P}_1 \times \mathbf{A} \times \mathbf{P}_l \times \cdots \times \mathbf{A}_{i + 1} = \mathbf{I}$。

令 $\mathbf{P} = \mathbf{P}_i \times \cdots \times \mathbf{P}_1, \mathbf{Q} = \mathbf{P}_l \times \cdots \times \mathbf{P}_{i + 1}$，则 $\mathbf{P} \mathbf{A} \mathbf{Q} = \mathbf{I}$，这意味着一种可能同时包含初等行列变换的高斯消去方案。

#### 可逆与秩

对于非奇异的 $\mathbf{A}$，对**任意** $\mathbf{B}$ 都有 $\operatorname{rank}(\mathbf{A} \mathbf{B}) \leq \operatorname{rank}(\mathbf{B}) = \operatorname{rank}(\mathbf{A}^{-1} \mathbf{A} \mathbf{B}) \leq \operatorname{rank}(\mathbf{A} \mathbf{B}) \Rightarrow \operatorname{rank}(\mathbf{A} \mathbf{B}) = \operatorname{rank}(\mathbf{B})$。

另一种更自然的理解方式是将 $\mathbf{A}$ 拆分为初等变换阵之积，$\mathbf{A} \mathbf{B}$ 即 $\mathbf{B}$ 经初等变换所得矩阵，秩不变。

#### 矩阵的幂

定义：

- $\mathbf{A}^0 = \mathbf{I}$。
- $\forall n \in \mathbb{N}, \mathbf{A}^{n + 1} = \mathbf{A} \mathbf{A}^n = \mathbf{A}^n \mathbf{A}$。
- 若 $\mathbf{A}$ 可逆，补充 $\forall n \in \mathbb{N}_+, \mathbf{A}^{-n} = (\mathbf{A}^{-1})^n = (\mathbf{A}^n)^{-1}$。

不难发现它满足“幂”运算的一般性质：$\forall n, m \in \mathbb{Z}, \mathbf{A}^{n + m} = \mathbf{A}^n \mathbf{A}^m$。

### 矩阵的分块

#### 概念

对于 $\mathbf{A} = (a_{i, j})_{m \times n}$，取 $m = \displaystyle\sum_{i = 1}^s m_i, n = \sum_{i = 1}^t n_i$，其中 $m_i, n_i \in \mathbb{N}_+$。

接下来我们可以将 $\mathbf{A}$ 记作 $\begin{bmatrix} \mathbf{A}_{1, 1} & \cdots & \mathbf{A}_{1, t} \\ \vdots & & \vdots \\ \mathbf{A}_{s, 1} & \cdots & \mathbf{A}_{s, t} \end{bmatrix}$，其中 $\mathbf{A}_{p, q}$ 为一个 $m_p \times n_q$ 的矩阵，满足 $(\mathbf{A}_{p, q})_{u, v} = a_{\sum_{i = 1}^{p - 1} m_i + u, \sum_{j = 1}^{q - 1} n_i + v}$。

#### 分块与加法

对于分块方式一致的 $\mathbf{A}_{m \times n}, \mathbf{B}_{m \times n}$，有 $(\mathbf{A} + \mathbf{B})_{p, q} = \mathbf{A}_{p, q} + \mathbf{B}_{p, q}$。

#### 分块与乘法

对于 $\mathbf{A}_{m \times n}, \mathbf{B}_{n \times k}$，要求 $\mathbf{A}$ 的列与 $\mathbf{B}$ 的行采取一致的分块方式。

取 $m = \displaystyle\sum_{i = 1}^s m_i, k = \sum_{i = 1}^t k_i, n = \sum_{i = 1}^r n_i$，则有 $\mathbf{C}_{p, q} = \displaystyle\sum_{i = 1}^r \mathbf{A}_{p, i} \mathbf{B}_{i, q}$。

- 一个自然的推导方式是从 $c_{i, j}$ 出发自底向上地推导。
- 一个自然的理解方式是结构与子结构同构。

#### 分块与转置

$(\mathbf{A}^T)_{q, p} = (\mathbf{A}_{p, q})^T$（由定义可证）。

- 一个自然的理解方式是结构与子结构同构。

#### 方阵的分块

对于方阵 $\mathbf{A}_{n \times n}$，对行列采取一致的分块方式 $n = \displaystyle\sum_{i = 1}^s n_i$，则此时对角线上的块也是方阵。

- **注意：其他块不一定！**

若 $\forall i \neq j, \mathbf{A}_{i, j} = \mathbf{O}$，则称 $\mathbf{A}$ 为**准对角阵**。类似地，可以定义准上 / 下三角阵等。

[例 2] 若 $\mathbf{A} = \begin{bmatrix} \mathbf{A}_{1, 1} & \mathbf{O} & \mathbf{O} \\ \mathbf{O} & \mathbf{A}_{2, 2} & \mathbf{O} \\ \mathbf{O} & \mathbf{O} & \mathbf{A}_{3, 3} \end{bmatrix}$，且 $\mathbf{A}_{1, 1}, \mathbf{A}_{2, 2}, \mathbf{A}_{3, 3}$ 均可逆，求证：$\mathbf{A}^{-1} = \begin{bmatrix} \mathbf{A}_{1, 1}^{-1} & \mathbf{O} & \mathbf{O} \\ \mathbf{O} & \mathbf{A}_{2, 2}^{-1} & \mathbf{O} \\ \mathbf{O} & \mathbf{O} & \mathbf{A}_{3, 3}^{-1} \end{bmatrix}$。

代入即可，证明略。

[例 3] 若 $\mathbf{A}, \mathbf{D}$ 可逆，求证：$\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{D} \end{bmatrix}$ 可逆；并求之。

法一：暴力解方程

考虑求逆在**分块意义下**的原始形式 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{D} \end{bmatrix} \begin{bmatrix} \mathbf{X}_{1, 1} & \mathbf{X}_{1, 2} \\ \mathbf{X}_{2, 1} & \mathbf{X}_{2, 2} \end{bmatrix} = \begin{bmatrix} \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \mathbf{I} \end{bmatrix}$，解矩阵方程可得：

$$
\begin{cases}
\mathbf{X}_1 &= \mathbf{A}^{-1} \\
\mathbf{X}_2 &= -\mathbf{A}^{-1} \mathbf{B} \mathbf{D}^{-1} \\
\mathbf{X}_3 &= O \\
\mathbf{X}_4 &= \mathbf{D}^{-1}
\end{cases}
$$

代入可知 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{D} \end{bmatrix}^{-1} = \begin{bmatrix} \mathbf{A}^{-1} & \mathbf{A}^{-1} \mathbf{B} \mathbf{D}^{-1} \\ \mathbf{O} & \mathbf{D}^{-1} \end{bmatrix}$。

- 如果想要猜答案，一个可行的方式是考察 $\mathbf{A}, \mathbf{B}, \mathbf{D}$ 的大小，可以发现为使乘积符合定义，第一行第二列只能为 $\mathbf{A}^{-1} \mathbf{B} \mathbf{D}^{-1}$ 和 $\mathbf{D}^{-1} \mathbf{B} \mathbf{A}^{-1}$ 之一。验证即可。

法二：进行**分块意义下**的初等行变换

对 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{D} \end{bmatrix}$ 依次做 $P_1(\mathbf{A}^{-1}), P_2(\mathbf{D}^{-1}), P_{2, 1}(-\mathbf{A}^{-1} \mathbf{B})$ 可得 $\begin{bmatrix} \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \mathbf{I} \end{bmatrix}$。

因此，对 $\begin{bmatrix} \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \mathbf{I} \end{bmatrix}$ 依次做同样的变换，即可得到 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{D} \end{bmatrix}^{-1} = \begin{bmatrix} \mathbf{A}^{-1} & -\mathbf{A}^{-1} \mathbf{B} \mathbf{D}^{-1} \\ \mathbf{O} & \mathbf{D}^{-1} \end{bmatrix}$。

[例 4] 已知 $\mathbf{A}$ 可逆，求 $\begin{vmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{vmatrix}$。

对 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{bmatrix}$ 做 $P_{1, 2}(-\mathbf{C} \mathbf{A}^{-1})$ 可得 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{D} - \mathbf{C} \mathbf{A}^{-1} \mathbf{B} \end{bmatrix}$，则 $\begin{vmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{vmatrix} = |\mathbf{A}| |\mathbf{D} - \mathbf{C} \mathbf{A}^{-1} \mathbf{B}|$。

- 这玩意可以在手算阶数较高的行列式中发挥作用。
- 事实上，若 $\mathbf{D}$ 可逆，对 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{bmatrix}$ 做 $Q_{2, 1}(-\mathbf{D}^{-1} \mathbf{C})$ 可得 $\begin{bmatrix} \mathbf{A} - \mathbf{B} \mathbf{D}^{-1} \mathbf{C} & \mathbf{O} \\ \mathbf{O} & \mathbf{D} \end{bmatrix}$，则 $\begin{vmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{vmatrix} = |\mathbf{D}| |\mathbf{A} - \mathbf{B} \mathbf{D}^{-1} \mathbf{C}|$，
- 因此，当 $\mathbf{A}, \mathbf{D}$ 均可逆，我们有等式 $|\mathbf{A}| |\mathbf{D} - \mathbf{C}\mathbf{A}^{-1} \mathbf{B}| = |\mathbf{D}| |\mathbf{A} - \mathbf{B}\mathbf{D}^{-1} \mathbf{C}|$，或者说 $|\mathbf{A}\mathbf{D} - \mathbf{A}\mathbf{C}\mathbf{A}^{-1} \mathbf{B}| = |\mathbf{D}\mathbf{A} - \mathbf{D}\mathbf{B}\mathbf{D}^{-1} \mathbf{C}|$。

[例 5] 求证：对于 $\mathbf{A}_{n \times m}, \mathbf{B}_{m \times n}$，有 $|\mathbf{I}_n - \mathbf{A} \mathbf{B}| = |\mathbf{I}_m - \mathbf{B}\mathbf{A}|$。

这个式子看上去很神秘，但注意到代入例 4 最后我们得出的等式即可得证。

[例 6] 当 $\mathbf{A}$ 可逆，问 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{bmatrix}$ 何时可逆，并求之。

对 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{bmatrix}$ 做 $P_{1, 2}(-\mathbf{C} \mathbf{A}^{-1})$ 可得 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{F} \end{bmatrix}$，其中 $\mathbf{F} = \mathbf{D} - \mathbf{C} \mathbf{A}^{-1} \mathbf{B}$。

当 $\mathbf{F}$ 不满秩，显然原矩阵不满秩，此时不可逆。

否则，套用例 3 的结论可知 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{F} \end{bmatrix}^{-1} = \begin{bmatrix} \mathbf{A}^{-1} & -\mathbf{A}^{-1} \mathbf{B} \mathbf{F}^{-1} \\ \mathbf{O} & \mathbf{F}^{-1} \end{bmatrix}$，进而有 $\begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{C} & \mathbf{D} \end{bmatrix}^{-1} = (P_{1, 2}(-\mathbf{C} \mathbf{A}^{-1}) \cdot \begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{F} \end{bmatrix})^{-1} = \begin{bmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{O} & \mathbf{F} \end{bmatrix}^{-1} \cdot \begin{bmatrix} \mathbf{I} & \mathbf{O} \\ \mathbf{C} \mathbf{A}^{-1} & \mathbf{I} \end{bmatrix} = \begin{bmatrix} \mathbf{A}^{-1} + \mathbf{A}^{-1} \mathbf{B} \mathbf{F}^{-1} \mathbf{C} \mathbf{A}^{-1} & -\mathbf{A}^{-1} \mathbf{B} \mathbf{F}^{-1} \\ -\mathbf{F}^{-1} \mathbf{C} \mathbf{A}^{-1} & \mathbf{F}^{-1} \end{bmatrix}$。

- ~~答案好大一坨。~~
- 如需检验，可考虑先看矩阵大小对不对得上，再看看每个块矩阵大小均为 $1 \times 1$ 时是否正确。

### 相抵关系与相抵标准形

#### 相抵关系 equivalent

若 $\exists \mathbf{P}, \mathbf{Q}$ 可逆，且 $\mathbf{P} \mathbf{A} \mathbf{Q} = \mathbf{B}$，则称 $\mathbf{A}, \mathbf{B}$ 相抵。

##### 性质 1：$\mathbf{A}, \mathbf{A}$ 相抵

若 $\mathbf{A}_{n \times m}$，则令 $\mathbf{P} =\mathbf{I}_m, \mathbf{Q} = \mathbf{I}_n$ 即可。

##### 性质 2：$\mathbf{A}, \mathbf{B}$ 相抵 $\Leftrightarrow \mathbf{B}, \mathbf{A}$ 相抵

若 $\mathbf{P} \mathbf{A} \mathbf{Q} = \mathbf{B}$，则 $\mathbf{P}^{-1} \mathbf{B} \mathbf{Q}^{-1} = \mathbf{A}$。

##### 性质 3：$\mathbf{A}, \mathbf{B}$ 相抵，$\mathbf{B}, \mathbf{C}$ 相抵 $\Rightarrow \mathbf{A}, \mathbf{C}$ 相抵

若 $\mathbf{P}_1 \mathbf{A} \mathbf{Q}_1 = \mathbf{B}, \mathbf{P}_2 \mathbf{B} \mathbf{Q}_2 = \mathbf{C}$，则 $(\mathbf{P}_2 \mathbf{P}_1) \mathbf{A} (\mathbf{Q}_1 \mathbf{Q}_2) = \mathbf{C}$。

------

由上面的性质可知，相抵关系事实上是一种**等价关系**，于是我们可以尝试拉出一些“极大**等价类**”。下面我们来具体地讨论这一问题。

自然地，我们尝试将每个矩阵通过初等行列变换得出一个“最简明”、“最有代表性”的结构。

考虑先通过**初等行变换**（高斯消去法）将原矩阵变为阶梯阵。设原矩阵的秩为 $r$，则此时只有前 $r$ 行非零。

接下来，我们再通过**初等列变换**（类似解线性方程组的回带过程），即可将原矩阵变换为 $\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$。

由于我们全程只进行了初等行列变换——或者说只左 / 右乘了初等变换阵——，每一步变换前后的矩阵都相抵，故我们找到了所期待的结构。

##### 性质 4：$\mathbf{A}, \mathbf{B}$ 相抵 $\Leftrightarrow \operatorname{rank}(\mathbf{A}) = \operatorname{rank}(\mathbf{B})$。

由上面的讨论易证。

#### 相抵标准形

对于秩为 $r$ 的矩阵，称 $\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$ 为其相抵标准形。

正如例 3 的法一所展示的那样，通过相抵标准形，问题有时可以被简化为对二阶分块矩阵的操作。

[例 7] 给定矩阵 $\mathbf{A}_{m \times n}$，求所有满足 $\mathbf{A}^T \mathbf{X} = \mathbf{X}^T \mathbf{A}$ 的 $\mathbf{X}_{m \times n}$。

一个自然的想法是原方程等价于 $\mathbf{A}^T \mathbf{X}$ 为对称阵，但感觉没啥进一步的想法 /yun

不妨考虑一个最简单的情况：要是 $\mathbf{A}$ 就是自身的相抵标准形 $\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$，那会发生什么？

设 $\mathbf{X} = \begin{bmatrix} \mathbf{X}_{1, 1} & \mathbf{X}_{1, 2} \\ \mathbf{X}_{2, 1} & \mathbf{X}_{2, 2} \end{bmatrix}$，则解得 $\mathbf{X}_{1, 1} = (\mathbf{X}_{1, 1})^T, \mathbf{X}_{1, 2} = \mathbf{O}$，而 $\mathbf{X}_{2, 1}, \mathbf{X}_{2, 2}$ 无限制。

由此也足以见得，讨论 $2 \times 2$ 矩阵总算是轻松多了。

------

接下来考虑 $\mathbf{A} = \mathbf{P} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{Q}$ 的一般情况。此时我们要求：

$$
\mathbf{Q}^T \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{P}^T \mathbf{X} = \mathbf{X}^T \mathbf{P} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{Q}
$$

进一步地，我们期待将其转化为上面“最简单的情况”，即等式左侧的 $\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$ 在最左侧，等式右侧的 $\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$ 在最右侧。

两边同时左乘 $(\mathbf{Q}^T)^{-1}$ 即 $\mathbf{Q}^{-T}$、同时右乘 $\mathbf{Q}^{-1}$，可得：

$$
\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{P}^T \mathbf{X} \mathbf{Q}^{-1} = \mathbf{Q}^{-T} \mathbf{X}^T \mathbf{P} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}
$$

注意到 $(\mathbf{P}^T \mathbf{X} \mathbf{Q}^{-1})^T = \mathbf{Q}^{-T} \mathbf{X}^T \mathbf{P}$，则这样的转化是可行的。

形式化地，我们最终得到原方程的解集：

$$\{\mathbf{X} \mid \mathbf{P}^T \mathbf{X} \mathbf{Q}^{-1} = \begin{bmatrix} (\mathbf{X}_{1, 1})_{r \times r} & \mathbf{O}_{r \times (n - r)} \\ (\mathbf{X}_{2, 1})_{(m - r) \times r} & (\mathbf{X}_{2, 2})_{(m - r) \times (n - r)} \end{bmatrix}, \mathbf{X}_{1, 1} = (\mathbf{X}_{1, 1})^T\}$$

[例 8] 若方阵 $\mathbf{A}_{n \times n}$ 满足 $\mathbf{A}^2 = \mathbf{A}$，则称其为幂等矩阵。记 $r$ 为 $\mathbf{A}$ 的秩，求证：$\mathbf{A}$ 为幂等矩阵 $\Leftrightarrow \exists \mathbf{P}$ 非奇异，$\text{s.t. } \mathbf{P} \mathbf{A} \mathbf{P}^{-1} = \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$。

1. 前推后

设 $\mathbf{P} \mathbf{A} \mathbf{Q} = \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$，则 $(\mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{Q}^{-1})^2 = \mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{Q}^{-1}$。

两边同时左乘 $\mathbf{P}$、同时右乘 $\mathbf{Q}$，可得 $\begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{Q}^{-1} \mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} = \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$。

令 $\mathbf{R} = \mathbf{Q}^{-1} \mathbf{P}^{-1} = \begin{bmatrix} \mathbf{R}_{1, 1} & \mathbf{R}_{1, 2} \\ \mathbf{R}_{2, 1} & \mathbf{R}_{2, 2} \end{bmatrix}$，可得 $\mathbf{R}_{1, 1} = \mathbf{I}_r$。

我们尝试**靠近目标形式**：$\mathbf{P} \mathbf{A} \mathbf{P}^{-1} = (\mathbf{P} \mathbf{A} \mathbf{Q}) \mathbf{R} = \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \begin{bmatrix} \mathbf{R}_{1, 1} & \mathbf{R}_{1, 2} \\ \mathbf{R}_{2, 1} & \mathbf{R}_{2, 2} \end{bmatrix} = \begin{bmatrix} \mathbf{I}_r & \mathbf{R}_{1, 2} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$。

但此时注意到多了一个 $\mathbf{R}_{1, 2}$。考虑构造一个 $\mathbf{S}$，使得 $\mathbf{S} (\mathbf{P} \mathbf{A} \mathbf{P}^{-1}) \mathbf{S}^{-1} = \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$。

我们期待一种操作，可以消去 $\mathbf{R}_{1, 2}$，一个自然的想法是做**初等列变换**。

注意到令 $\mathbf{S}^{-1} = \begin{bmatrix} \mathbf{I}_r & -\mathbf{R}_{1, 2} \\ \mathbf{O} & \mathbf{I}_{n - r} \end{bmatrix}$ 是满足条件的，则令 $\tilde{\mathbf{P}} = \mathbf{S} \mathbf{P}$ 即可，遂得证。

2. 后推前

由 $\mathbf{P} \mathbf{A} \mathbf{P}^{-1} = \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}$ 可得 $\mathbf{A} = \mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{P}$，于是 $\mathbf{A}^2 = (\mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{P}) (\mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{P}) = \mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix}^2 \mathbf{P} = \mathbf{P}^{-1} \begin{bmatrix} \mathbf{I}_r & \mathbf{O} \\ \mathbf{O} & \mathbf{O} \end{bmatrix} \mathbf{P} = \mathbf{A}$。

[例 9] 对于方阵 $\mathbf{A}_{n \times n}$，求证：$\mathbf{A}^2 = \mathbf{I} \Leftrightarrow \operatorname{rank}(\mathbf{A} + \mathbf{I}) + \operatorname{rank}(\mathbf{A} - \mathbf{I}) = n$。

- _Motivation：秩之和 $\Rightarrow$ 分块矩阵的主对角线；$\operatorname{rank}(\mathbf{I}_n) = n$。_

进行下面的分块矩阵的初等变换：

$$
\begin{align}
&\begin{bmatrix} \mathbf{A} + \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \mathbf{A} - \mathbf{I} \end{bmatrix} \\
\sim &\begin{bmatrix} \mathbf{A} + \mathbf{I} & \mathbf{A} - \mathbf{I} \\ \mathbf{O} & \mathbf{A} - \mathbf{I} \end{bmatrix} \\
\sim &\begin{bmatrix} 2 \mathbf{I} & \mathbf{A} - \mathbf{I} \\ \mathbf{I} - \mathbf{A} & \mathbf{A} - \mathbf{I} \end{bmatrix} \\
\sim &\begin{bmatrix} 2 \mathbf{I} & (\mathbf{A} - \mathbf{I}) + 2 \mathbf{I} \cdot \dfrac{\mathbf{I} - \mathbf{A}}{2} \\ \mathbf{I} - \mathbf{A} & (\mathbf{A} - \mathbf{I}) + (\mathbf{I} - \mathbf{A}) \cdot \dfrac{\mathbf{I} - \mathbf{A}}{2} \end{bmatrix} = \begin{bmatrix} 2 \mathbf{I} & \mathbf{O} \\ \mathbf{I} - \mathbf{A} & \dfrac{\mathbf{A}^2 - \mathbf{I}}{2} \end{bmatrix} \\
\sim &\begin{bmatrix} 2 \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \dfrac{\mathbf{A}^2 - \mathbf{I}}{2} \end{bmatrix}
\end{align}
$$

因此 $\operatorname{rank}(\mathbf{A} + \mathbf{I}) + \operatorname{rank}(\mathbf{A} - \mathbf{I}) = \operatorname{rank}(\begin{bmatrix} \mathbf{A} + \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \mathbf{A} - \mathbf{I} \end{bmatrix}) = \operatorname{rank}(\begin{bmatrix} 2 \mathbf{I} & \mathbf{O} \\ \mathbf{O} & \dfrac{\mathbf{A}^2 - \mathbf{I}}{2} \end{bmatrix}) = \operatorname{rank}(2 \mathbf{I}) + \operatorname{rank}(\dfrac{\mathbf{A}^2 - \mathbf{I}}{2}) = n + \operatorname{rank}(\mathbf{A}^2 - \mathbf{I})$。

1. 前推后：由于 $\mathbf{A}^2 = \mathbf{I}$，可知 $\operatorname{rank}(\mathbf{A}^2 - \mathbf{I}) = \operatorname{rank}(\mathbf{O}) = 0$。
2. 后推前：由于 $\operatorname{rank}(\mathbf{A} + \mathbf{I}) + \operatorname{rank}(\mathbf{A} - \mathbf{I}) = n$，可知 $\operatorname{rank}(\mathbf{A}^2 - \mathbf{I}) = 0$，故 $\mathbf{A}^2 - \mathbf{I} = \mathbf{O}$ 即 $\mathbf{A}^2 = \mathbf{I}$。

[例 10] 对于方阵 $\mathbf{A}_{n \times n}$，求证：$\operatorname{rank}(\mathbf{A}^n) = \operatorname{rank}(\mathbf{A}^{n + 1})$。

考虑**零空间相等**的思路，即证 $\mathbf{A}^n \mathbf{x} = \mathbf{0} \Leftrightarrow \mathbf{A}^{n + 1} \mathbf{x} = \mathbf{0}$。

前推后显然，下面考虑后推前。

- _Motivation：遇到 $\forall$，考虑反证法。_

假设 $\exists \mathbf{x}^*, \text{s.t. } \mathbf{A}^{n + 1} \mathbf{x}^* = \mathbf{0} \land \mathbf{A}^n \mathbf{x}^* \neq \mathbf{0}$。

注意到若 $\mathbf{A}^s \mathbf{x} = \mathbf{0}$ 则 $\forall t \in \mathbb{N}, \mathbf{A}^{s + t} \mathbf{x} = \mathbf{0}$，故 $\forall i \in \mathbb{N}_{\neq n}, \mathbf{A}^i \mathbf{x}^* \neq \mathbf{0}$。

- _Motivation：为什么是 $n$ 次方？这里的 $n + 1$ 个非零向量有何意味？_

由于 $\mathbf{A}^i \mathbf{x}^* \in \mathbb{R}^n$，可知大小为 $n + 1$ 的向量组 $\{\mathbf{A}^i \mathbf{x}^* \neq \mathbf{0} \mid i \in \mathbb{N}_{\neq n}\}$ 线性相关。

设有非全零的系数 $\lambda_0, \cdots, \lambda_n \in \mathbb{R}$，使得 $\displaystyle\sum_{i = 0}^n \lambda_i \mathbf{A}^i \mathbf{x}^* = \mathbf{0}$。

- _Motivation：证明系数只可能全零，即可推出矛盾。_

先考察 $\lambda_0$：考虑在左右同时左乘 $\mathbf{A}^n$，可以发现左边仅留下了 $\lambda_0 \mathbf{A}^n \mathbf{x}^*$ 这一项可能非零，但右边为 $\mathbf{0}$。故 $\lambda_0 = 0$。

接下来考察 $\lambda_1$：考虑在左右同时左乘 $\mathbf{A}^{n - 1}$，可以发现左边仅留下了 $\lambda_1 \mathbf{A}^{n - 1} \mathbf{x}^*$ 这一项可能非零，但右边为 $\mathbf{0}$。故 $\lambda_1 = 0$。

如此续行，我们最终得出 $\lambda_0 = \cdots = \lambda_n = 0$，即系数非零，矛盾。

故假设不成立，即后推前成立。

------

[例 11] $\mathbf{A}$ 为 $s \times n$ 矩阵，证明：

- (1) $\mathbf{A}$ **列**满秩 $\Leftrightarrow \exists \mathbf{P}_{s \times s}$ 可逆，$\text{s.t. } \mathbf{A} = \mathbf{P} \begin{bmatrix} \mathbf{I}_n \\ \mathbf{O}_{(s - n) \times n} \end{bmatrix}$。
- (2) $\mathbf{A}$ **行**满秩 $\Leftrightarrow \exists \mathbf{Q}_{n \times n}$ 可逆，$\text{s.t. } \mathbf{A} = \begin{bmatrix} \mathbf{I}_s & \mathbf{O}_{s \times (n - s)} \end{bmatrix} \mathbf{Q}$。

下面证明 (1)，(2) 是同理的。

- $\Rightarrow$：由于 $\operatorname{rank}(\mathbf{A}) = n$，将 $\mathbf{A}$ 消成阶梯阵的过程等价于左乘初等变换阵 $\mathbf{P}_1$，使得 $\mathbf{P}_1 \mathbf{A} = \begin{bmatrix} \mathbf{B}_{n \times n} \\ \mathbf{O}_{(s - n) \times n} \end{bmatrix}$，其中 $\mathbf{B}$ 是**对角线非零**的上三角阵。
- 因此，可以仅通过初等行变换（回带）将 $\mathbf{B}$ 消成对角阵，即等价于左乘初等变换阵 $\mathbf{P}_2$，使得 $\mathbf{P}_2 (\mathbf{P}_1 \mathbf{A}) = \begin{bmatrix} \mathbf{I}_n \\ \mathbf{O}_{(s - n) \times n} \end{bmatrix}$。
- 令 $\mathbf{P} = \mathbf{P}_1^{-1} \mathbf{P}_2^{-1}$，则 $\mathbf{P}$ 可逆，且 $\mathbf{A} = \mathbf{P} \begin{bmatrix} \mathbf{I}_n \\ \mathbf{O}_{(s - n) \times n} \end{bmatrix}$，遂得证。
- $\Leftarrow$：由 $\mathbf{P}$ **可逆**，注意到 $\begin{cases} \operatorname{rank}(\mathbf{A}) &\leq \min(\operatorname{rank}(\mathbf{P}), \operatorname{rank}(\mathbf{P}^{-1} \mathbf{A})) = n \\ n = \operatorname{rank}(\mathbf{P}^{-1} \mathbf{A}) &\leq \min(\operatorname{rank}(\mathbf{P}^{-1}), \operatorname{rank}(\mathbf{A})) = \operatorname{rank}(\mathbf{A}) \end{cases}$。
- 故有 $\operatorname{rank}(\mathbf{A}) = n$，即 $\mathbf{A}$ 列满秩。

从本题出发，还可以给出两个有趣的推论：

- (I) $\mathbf{A}_{s \times n}$ 列满秩 $\Leftrightarrow \exists \mathbf{B}_{n \times s}$ 行满秩，$\text{s.t. } \mathbf{B} \mathbf{A} = \mathbf{I}_n$；$\mathbf{A}_{s \times n}$ 行满秩 $\Leftrightarrow \exists \mathbf{B}_{n \times s}$ 列满秩，$\text{s.t. } \mathbf{A} \mathbf{B} = \mathbf{I}_s$。
- 前一种情况的 $\Rightarrow$ 的证明：在上文 $\Rightarrow$ 的基础上，令 $\mathbf{B}$ 为 $\mathbf{P}^{-1}$ 的前 $n$ 行即可。
- (II) 左乘列满秩矩阵、右乘行满秩矩阵均不改变矩阵的秩。

[例 12] 若 $\mathbf{A} = (a_{i, j})_{n \times n} \in \mathbb{R}^{n \times n}$ 可逆，求证：若 $\mathbf{A}$ 的每个顺序主子式都大于零，且 $\mathbf{A}$ 的每个非主对角元都小于零，则 $\mathbf{A}^{-1}$ 的每个元素都大于零。

- 注：$\mathbf{A}$ 的第 $k$ 个顺序主子式 $D_k$ 为其前 $k$ 行、前 $k$ 列构成的矩阵 $\mathbf{A}_k$ 的行列式。
- _Motivation：一行一行扩展 $\Rightarrow$ 考虑归纳？_

设有命题 $P(k)$：$\mathbf{A}_k^{-1}$ 的每个元素都大于零。

1. 当 $k = 1$，由于 $a_{1, 1} > 0$，可得 $\mathbf{A}_1^{-1} = \begin{bmatrix} \dfrac{1}{a_{1, 1}} \end{bmatrix}$ 的每个元素都大于零，$P(k)$ 成立。
2. 当 $k \in \mathbb{N} \cap [1, n)$，我们尝试证明 $P(k) \rightarrow P(k + 1)$。

- 为有效利用 $\mathbf{A}_k$ 及其逆的信息，考虑构造分块矩阵 $\mathbf{A}_{k + 1} = \begin{bmatrix} \mathbf{A}_k & \mathbf{u}_k \\ \mathbf{v}_k & a_{k + 1, k + 1} \end{bmatrix}$，其中 $\mathbf{u}_k, \mathbf{v}_k$ 中各项均非正，且 $a_{k + 1, k + 1} > 0$。
- 令 $\mathbf{P}_{k + 1} = \begin{bmatrix} \mathbf{I}_k & \mathbf{0}_{k \times 1} \\ -\mathbf{v}_k \mathbf{A}_k^{-1} & 1 \end{bmatrix}, \mathbf{Q}_{k + 1} = \begin{bmatrix} \mathbf{I}_k & -\mathbf{A}_k^{-1} \mathbf{u}_k \\ \mathbf{0}_{1 \times k} & 1 \end{bmatrix}$，则 $\mathbf{P}_{k + 1} \mathbf{A}_{k + 1} \mathbf{Q}_{k + 1} = \begin{bmatrix} \mathbf{A}_k & \mathbf{0}_{k \times 1} \\ \mathbf{0}_{1 \times k} & a_{k + 1, k + 1} - \mathbf{v}_k \mathbf{A}_k^{-1} \mathbf{u}_k \end{bmatrix}$。
- 由于 $\mathbf{P}_{k + 1}, \mathbf{Q}_{k + 1}$ 为初等变换阵，有 $|\mathbf{A}_{k + 1}| = |\mathbf{A}_k| \cdot (a_{k + 1, k + 1} - \mathbf{v}_k \mathbf{A}_k^{-1} \mathbf{u}_k) > 0$。又因为 $|\mathbf{A}_k| > 0$，有 $a_{k + 1, k + 1} - \mathbf{v}_k \mathbf{A}_k^{-1} \mathbf{u}_k > 0$。
- 与此同时，有 $\mathbf{Q}_{k + 1}^{-1} \mathbf{A}_{k + 1}^{-1} \mathbf{P}_{k + 1}^{-1} = \begin{bmatrix} \mathbf{A}_k^{-1} & \mathbf{0}_{k \times 1} \\ \mathbf{0}_{1 \times k} & c_{k + 1} \end{bmatrix}$，其中 $c_{k + 1} = \dfrac{1}{a_{k + 1, k + 1} - \mathbf{v}_k \mathbf{A}_k^{-1} \mathbf{u}_k} > 0$。
- 进而有 $\mathbf{A}_{k + 1}^{-1} = \mathbf{Q}_{k + 1} \begin{bmatrix} \mathbf{A}_k^{-1} & \mathbf{0}_{k \times 1} \\ \mathbf{0}_{1 \times k} & c_{k + 1} \end{bmatrix} \mathbf{P}_{k + 1} = \begin{bmatrix} \mathbf{A}_k^{-1} + \mathbf{A}_k^{-1} \mathbf{u}_k c_{k + 1} \mathbf{v}_k \mathbf{A}_k^{-1} & -\mathbf{A}_k^{-1} \mathbf{u}_k c_{k + 1} \\ -c_{k + 1} \mathbf{v}_k \mathbf{A}_k^{-1} & c_{k + 1} \end{bmatrix}$。
- 故 $\mathbf{A}_{k + 1}^{-1}$ 的每个元素均大于零。

综上，由归纳假设，$P(n)$ 成立，即 $\mathbf{A}^{-1}$ 的每个元素都大于零。
