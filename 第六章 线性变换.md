# 第六章 线性变换

### 定义：线性映射

对于 $\mathbb{F}$ 上的线性空间 $V, W$，称 $\mathcal{A}$ 为一个 $V$ 到 $W$ 的线性映射，若：

$$
\begin{aligned}
\mathcal{A} : \ & V \to W \\
&\mathbf{v} \mapsto \mathcal{A} \mathbf{v}
\end{aligned}
$$

保持线性性。

[例 1] 任一矩阵 $\mathbf{A} \in \mathbb{R}^{m \times n}$ 给出了下面的线性映射：

$$
\begin{aligned}
\mathcal{A} : \ & \mathbb{R}^n \to \mathbb{R}^m \\
&\mathbf{v} \mapsto \mathcal{A} \mathbf{v} = \mathbf{A} \mathbf{v}
\end{aligned}
$$

### 定义：线性变换

对于 $\mathbb{F}$ 上的线性空间 $V$，称一个 $V$ 到 $V$ 的线性映射为线性变换。

[例 2] 对于 $\mathbb{F}$ 上的线性空间 $V$，有下列线性变换：

- (1) 零变换 $\mathcal{O}$：$\forall \mathbf{v} \in V, \mathcal{O} \mathbf{v} = \mathbf{0}$。
- (2) 恒同变换 $\mathcal{I}_d$：$\forall \mathbf{v} \in V, \mathcal{I}_d \mathbf{v} = \mathbf{v}$。
- (3) 给定 $k \in \mathbb{F}$ 的数乘变换 $\mathcal{K}$：$\forall \mathbf{v} \in V, \mathcal{K} \mathbf{v} = k \mathbf{v}$。

[例 3] 在 $\mathbb{R}^2$ 上建立直角坐标系，考虑将向量 $\begin{bmatrix} x \\ y \end{bmatrix}$ 逆时针旋转 $\varphi$。

- 取极坐标 $\begin{cases} x = r \cos \theta \\ y = r \sin \theta \end{cases}$。
- 则旋转后得到 $\begin{cases} x' = r \cos (\theta + \varphi) = r \cos \theta \cos \varphi - r \sin \theta \sin \varphi = x \cos \varphi - y \sin \varphi \\ y' = r \sin (\theta + \varphi) = r \sin \theta \cos \varphi + r \cos \theta \sin \varphi = x \sin \varphi + y \cos \varphi \end{cases}$。
- 据此写出 $2 \times 2$ 的变换阵：

$$
\begin{bmatrix} x' \\ y' \end{bmatrix} = \begin{bmatrix} \cos \varphi & -\sin \varphi \\ \sin \varphi & \cos \varphi \end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix}
$$

- 故向量旋转可以表示为下列线性变换：

$$
\begin{aligned}
\mathcal{R}_{\varphi} : \ & \mathbb{R}^2 \to \mathbb{R}^2 \\
&\mathbf{v} \mapsto \begin{bmatrix} \cos \varphi & -\sin \varphi \\ \sin \varphi & \cos \varphi \end{bmatrix} \mathbf{v}
\end{aligned}
$$

#### 线性变换的运算

记 $\mathcal{L}(V, W)$ 表示从 $V$ 到 $W$ 的线性变换的集合。特别地，$\mathcal{L}(V, V)$ 表示 $V$ 上的线性变换。

##### 加法

定义 $\mathcal{L}(V, V)$ 上的加法如下：

$$
\begin{aligned}
+ : \ & \mathcal{L}(V, V) \times \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\mathcal{A} + \mathcal{B} &\mapsto & \ \mathcal{C} : V \to V \\
& & & \ \mathbf{v} \mapsto \mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v}
\end{aligned}
$$

首先证明结果是一个 $V$ 上的线性变换：

- I. 值域：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v}, \mathcal{B} \mathbf{v} \in V$，故 $\mathcal{C} \mathbf{v} = \mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v} \in V$。
- II. 保持线性性：$\forall \lambda, \mu \in \mathbb{F}, \mathbf{a}, \mathbf{b} \in V$，有：

$$
\begin{aligned}
\mathcal{C} (\lambda \mathbf{a} + \mu \mathbf{b}) &= \mathcal{A} (\lambda \mathbf{a} + \mu \mathbf{b}) + \mathcal{B} (\lambda \mathbf{a} + \mu \mathbf{b}) \\
&= (\lambda \mathcal{A} \mathbf{a} + \mu \mathcal{A} \mathbf{b}) + (\lambda \mathcal{B} \mathbf{a} + \mu \mathcal{B} \mathbf{b}) \\
&= \lambda (\mathcal{A} \mathbf{a} + \mathcal{B} \mathbf{a}) + \mu (\mathcal{A} \mathbf{b} + \mathcal{B} \mathbf{b}) \\
&= \lambda \mathcal{C} \mathbf{a} + \mu \mathcal{C} \mathbf{b}
\end{aligned}
$$

此外，要将一个运算声明为“加法”，我们需要证明下列性质：

- (1) 交换律：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v} = \mathcal{B} \mathbf{v} + \mathcal{A} \mathbf{v}$。
- (2) 结合律：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} + (\mathcal{B} \mathbf{v} + \mathcal{C} \mathbf{v}) = (\mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v}) + \mathcal{C} \mathbf{v}$。
- (3) 零元存在：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} + \mathcal{O} \mathbf{v} = \mathcal{O} \mathbf{v} + \mathcal{A} \mathbf{v} = \mathcal{A} \mathbf{v}$。
- (4) 负元存在：$\forall \mathbf{v} \in V, \exists (-\mathcal{A}) \in \mathcal{L}(V, V), \text{s.t. } \mathcal{A} \mathbf{v} + (-\mathcal{A}) \mathbf{v} = \mathcal{O} \mathbf{v} = \mathbf{0}$，其中算子 $-$ 定义如下：

$$
\begin{aligned}
- : \ & \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\mathcal{A} &\mapsto & \ \mathcal{B} : V \to V \\
& & & \ \mathbf{v} \mapsto -(\mathcal{A} \mathbf{v})
\end{aligned}
$$

可以发现，上述性质正是继承自 $V$ 上的加法。

##### 数乘

定义 $\mathcal{L}(V, V)$ 上的数乘如下：

$$
\begin{aligned}
\cdot : \ & \mathbb{F} \times \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\lambda \cdot \mathcal{A} &\mapsto & \ \mathcal{B} : V \to V \\
& & & \ \mathbf{v} \mapsto \lambda (\mathcal{A} \mathbf{v})
\end{aligned}
$$

- $\cdot$ 算子可以省略。

首先证明结果是一个 $V$ 上的线性变换：

- I. 值域：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} \in V$，故 $\mathcal{B} \mathbf{v} = \lambda (\mathcal{A} \mathbf{v}) \in V$。
- II. 保持线性性：$\forall \mu, \theta \in \mathbb{F}, \mathbf{a}, \mathbf{b} \in V$，有：

$$
\begin{aligned}
\mathcal{B} (\mu \mathbf{a} + \theta \mathbf{b}) &= \lambda (\mathcal{A} (\mu \mathbf{a} + \theta \mathbf{b})) \\
&= \lambda (\mu \mathcal{A} \mathbf{a} + \theta \mathcal{A} \mathbf{b}) \\
&= \mu (\lambda (\mathcal{A} \mathbf{a})) + \theta (\lambda (\mathcal{A} \mathbf{b})) \\
&= \mu (\mathcal{B} \mathbf{a}) + \theta (\mathcal{B} \mathbf{b})
\end{aligned}
$$

要将一个运算声明为“数乘”，我们需要证明下列性质：

- (1) 结合律（关于数，在左）：$\forall \mathbf{v} \in V, ((\lambda \mu) \mathcal{A}) \mathbf{v} = (\lambda (\mu \mathcal{A})) \mathbf{v}$。
- (2) 左分配律（关于数的加法）：$\forall \mathbf{v} \in V, ((\lambda + \mu) \mathcal{A}) \mathbf{v} = (\lambda \mathcal{A}) \mathbf{v} + (\mu \mathcal{A}) \mathbf{v}$。
- (3) 右分配律（关于线性变换的加法）：$\forall \mathbf{v} \in V, (\lambda (\mathcal{A} + \mathcal{B})) \mathbf{v} = \lambda \mathcal{A} \mathbf{v} + \lambda \mathcal{B} \mathbf{v}$。
- (4) 单位元存在：$\forall \mathbf{v} \in V, (1 \cdot \mathcal{A}) \mathbf{v} = \mathcal{A} \mathbf{v}$。

可以发现，上述性质正是继承自 $V$ 上的加法与数乘。

##### 乘法

定义 $\mathcal{L}(V, V)$ 上的乘法为映射的**复合**：

$$
\begin{aligned}
\circ : \ & \mathcal{L}(V, V) \times \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\mathcal{A} \circ \mathcal{B} &\mapsto & \ \mathcal{C} : V \to V \\
& & & \ \mathbf{v} \mapsto \mathcal{A} (\mathcal{B} \mathbf{v})
\end{aligned}
$$

- $\circ$ 算子可以省略。

首先证明结果是一个线性变换：

要将一个运算声明为“乘法”，我们需要证明下列性质：

- (1) 结合律（_类比矩阵乘法_）：$\forall \mathbf{v} \in V, (\mathcal{A} (\mathcal{B} \mathcal{C})) \mathbf{v} = ((\mathcal{A} \mathcal{B}) \mathcal{C}) \mathbf{v}$。
- (2) 结合律（关于数，在左）：$\forall \mathbf{v} \in V, (\lambda (\mathcal{A} \mathcal{B})) \mathbf{v} = ((\lambda \mathcal{A}) \mathcal{B}) \mathbf{v}$。
- (3) 分配律（关于线性变换的加法）：$\forall \mathbf{v} \in V, ((\mathcal{A} + \mathcal{B}) \mathcal{C}) \mathbf{v} = (\mathcal{A} \mathcal{C}) \mathbf{v} + (\mathcal{B} \mathcal{C}) \mathbf{v}, (\mathcal{A} (\mathcal{B} + \mathcal{C})) \mathbf{v} = (\mathcal{A} \mathcal{B}) \mathbf{v} + (\mathcal{A} \mathcal{C}) \mathbf{v}$。
- (4) 单位元存在：$\forall \mathbf{v} \in V, (\mathcal{A} \mathcal{I}_d) \mathbf{v} = (\mathcal{I}_d \mathcal{A}) \mathbf{v} = \mathcal{A} \mathbf{v}$。

可以发现，上述性质正是继承自 $V$ 上的加法与数乘、以及来自复合运算的定义。

------

$(\mathcal{L}(V, V); +, \cdot, \circ; \mathbb{F})$ 的定义和上面的十二条性质表明它是一个代数 algebra。

##### 逆元

###### 定义：左逆与右逆

对于 $\mathcal{A} \in \mathcal{L}(V, V)$，若 $\exists \mathcal{B} \in \mathcal{L}(V, V), \text{s.t. } \mathcal{B} \mathcal{A} = \mathcal{I}_d$，则称 $\mathcal{B}$ 为 $\mathcal{A}$ 的左逆，同理可以定义右逆。

###### 定理（左右逆相等）

内容：若 $\mathcal{A} \in \mathcal{L}(V, V)$ 有左逆 $\mathcal{B}_L$ 和右逆 $\mathcal{B}_R$，则 $\mathcal{B}_L = \mathcal{B}_R$。

证明：

$$
\begin{aligned}
\mathcal{B}_L &= \mathcal{B}_L \mathcal{I}_d \\
&= \mathcal{B}_L (\mathcal{A} \mathcal{B}_R) \\
&= (\mathcal{B}_L \mathcal{A}) \mathcal{B}_R \\
&= \mathcal{I}_d \mathcal{B}_R \\
&= \mathcal{B}_R
\end{aligned}
$$

###### 定理（左右逆之一存在则都存在）

内容：若 $\mathcal{A} \in \mathcal{L} (V, V)$ 有左逆 $\mathcal{B}$，则 $\mathcal{B}$ 为其右逆；反之亦然。

证明：

- 下面只证明左逆必为右逆，右逆必为左逆是同理的。
- 令 $n = \dim V$，取 $V$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$。
- 设有系数 $\lambda_1, \cdots, \lambda_n \in \mathbb{F}$，使得 $\displaystyle\sum_{i = 1}^n \lambda_i (\mathcal{A} \mathbf{e}_i) = \mathbf{0}$。
- 左右同时施加变换 $\mathcal{B}$，可得：

$$
\begin{aligned}
\mathbf{0} &= \mathcal{B} \mathbf{0} \\
&= \mathcal{B} (\sum_{i = 1}^n \lambda_i (\mathcal{A} \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{B} (\mathcal{A} \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i ((\mathcal{B} \mathcal{A}) \mathbf{e}_i) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{I}_d \mathbf{e}_i) \\
&= \sum_{i = 1}^n \lambda_i \mathbf{e}_i
\end{aligned}
$$

- 由 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性无关可知 $\lambda_1 = \cdots = \lambda_n = 0$，则 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n\}$ 线性无关，故 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n\}$ 为 $V$ 的一组基。
- $\forall \mathbf{v} \in V, \exists \lambda_1, \cdots, \lambda_n \in \mathbb{F}, \text{s.t. } \mathbf{v} = \displaystyle\sum_{i = 1}^n \lambda_i (\mathcal{A} \mathbf{e}_i)$。
- 左右同时施加变换 $\mathcal{A} \mathcal{B}$，可得：

$$
\begin{aligned}
(\mathcal{A} \mathcal{B}) \mathbf{v} &= \sum_{i = 1}^n \lambda_i ((\mathcal{A} \mathcal{B}) (\mathcal{A} \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{A} ((\mathcal{B} \mathcal{A}) \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{A} (\mathcal{I}_d \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{A}  \mathbf{e}_i) \\
&= \mathbf{v} \\
&= \mathcal{I}_d \mathbf{v}
\end{aligned}
$$

- 故 $\mathcal{A} \mathcal{B} = \mathcal{I}_d$，即 $\mathcal{B}$ 为 $\mathcal{A}$ 的右逆。

鉴于左乘 $n$ 阶方阵是 $V = \mathbb{R}^n$ 时的特殊情况，上述定理也可以通过线性变换的矩阵表示、利用方阵左逆与右逆的性质证明。~~但你别急，还没讲到这里。~~

------

可以发现，上面的证明依赖 $V$ 为**有限维**线性空间。事实上，当 $V$ 为**无限维**线性空间，有如下反例：

- 考虑实多项式空间 $V = \mathbb{P}[x]$。
- 在 $V$ 上定义求导算子 $\mathcal{D}$ 和积分算子 $\mathcal{I}$：

$$
\begin{aligned}
\mathcal{D} : \ & V &\to & \ V \\
&f &\mapsto & \ f' \\
\mathcal{I} : \ & V &\to & \ V \\
&f &\mapsto & \ \mathcal{I} f : \mathbb{R} \to \mathbb{R} \\
& & & \ \mathcal{I} f(x) \mapsto \int _0^x f(x) \text{d} x \\
\end{aligned}
$$

- 易得 $\mathcal{D} \mathcal{I} = \mathcal{I}_d$，但由于常数被抹去，有 $\mathcal{I} \mathcal{D} \neq \mathcal{I}_d$，故 $V$ 上左右逆之一存在不能推出另一个也存在。

------

对于（我们默认情况下讨论的）**有限维**线性空间，在上面两个定理的基础上，可以定义逆元如下。

###### 定义：逆元

对于 $\mathcal{A} \in \mathcal{L}(V, V)$，若 $\exists \mathcal{B} \in \mathcal{L}(V, V), \text{s.t. } \mathcal{B} \mathcal{A} = \mathcal{A} \mathcal{B} = \mathcal{I}_d$，则称 $\mathcal{B}$ 为 $\mathcal{A}$ 的逆元。

###### 定理（判定逆元不必证明保持线性性）

内容：对于 $\mathcal{A} \in \mathcal{L}(V, V)$，若 $\exists \mathcal{B} : V \to V, \text{s.t. } \mathcal{B} \mathcal{A} = \mathcal{A} \mathcal{B} = \mathcal{I}_d$，则 $\mathcal{B} \in \mathcal{L}(V, V)$，即 $\mathcal{B}$ 为 $\mathcal{A}$ 的逆元。

证明：

- 我们将保持线性性拆成下面 I、II 两部分来证明：
- I. 证明 $\mathcal{B} (\mathbf{a} + \mathbf{b}) = \mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b}$：

$$
\begin{aligned}
\mathcal{B} (\mathbf{a} + \mathbf{b}) &= \mathcal{B} ((\mathcal{A} \mathcal{B}) \mathbf{a} + (\mathcal{A} \mathcal{B}) \mathbf{b}) \\
&= \mathcal{B} (\mathcal{A} (\mathcal{B} \mathbf{a}) + \mathcal{A} (\mathcal{B} \mathbf{b})) \\
&= \mathcal{B} (\mathcal{A} (\mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b})) \\
&= (\mathcal{B} \mathcal{A}) (\mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b}) \\
&= \mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b}
\end{aligned}
$$

- II. 证明 $\mathcal{B} (\lambda \mathbf{a}) = \lambda \mathcal{B} \mathbf{a}$：

$$
\begin{aligned}
\mathcal{B} (\lambda \mathbf{a}) &= \mathcal{B} (\lambda (\mathcal{A} \mathcal{B}) \mathbf{a}) \\
&= \mathcal{B} (\lambda \mathcal{A} (\mathcal{B} \mathbf{a})) \\
&= \mathcal{B} (\mathcal{A} (\lambda \mathcal{B} \mathbf{a})) \\
&= (\mathcal{B} \mathcal{A}) (\lambda \mathcal{B} \mathbf{a}) \\
&= \lambda \mathcal{B} \mathbf{a}
\end{aligned}
$$

##### 幂

类比一般意义下的数，定义关于线性变换 $\mathcal{A} \in \mathcal{L}(V, V)$ 和自然数 $n \in \mathbb{N}$ 的幂 $\mathcal{A}^n$：

$$
\mathcal{A}^n = \begin{cases}
\mathcal{I}_d, &\quad n = 0 \\
\mathcal{A}^{n - 1} \mathcal{A}, &\quad n > 0
\end{cases}
$$

##### 线性变换多项式

类比数域上的多项式，定义关于线性变换 $\mathcal{A} \in \mathcal{L} (V, V)$ 的多项式 $p_n(\mathcal{A})$：

$$
p_n(\mathcal{A}) = \sum_{i = 0}^n c_i \mathcal{A}^i \in \mathcal{L}(V, V)
$$
