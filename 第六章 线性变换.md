# 第六章 线性变换

### 定义：线性映射

对于 $\mathbb{F}$ 上的线性空间 $V, W$，称 $\mathcal{A}$ 为一个 $V$ 到 $W$ 的线性映射，若：

$$
\begin{aligned}
\mathcal{A} : \ & V \to W \\
&\mathbf{v} \mapsto \mathcal{A} \mathbf{v}
\end{aligned}
$$

保持线性性。

[例 1] 任一矩阵 $\mathbf{A} \in \mathbb{R}^{m \times n}$ 给出了下面的线性映射：

$$
\begin{aligned}
\mathcal{A} : \ & \mathbb{R}^n \to \mathbb{R}^m \\
&\mathbf{v} \mapsto \mathcal{A} \mathbf{v} = \mathbf{A} \mathbf{v}
\end{aligned}
$$

### 定义：线性变换

对于 $\mathbb{F}$ 上的线性空间 $V$，称一个 $V$ 到 $V$ 的线性映射为线性变换。

[例 2] 对于 $\mathbb{F}$ 上的线性空间 $V$，有下列线性变换：

- (1) 零变换 $\mathcal{O}$：$\forall \mathbf{v} \in V, \mathcal{O} \mathbf{v} = \mathbf{0}$。
- (2) 恒同变换 $\mathcal{I}_d$：$\forall \mathbf{v} \in V, \mathcal{I}_d \mathbf{v} = \mathbf{v}$。
- (3) 给定 $k \in \mathbb{F}$ 的数乘变换 $\mathcal{K}$：$\forall \mathbf{v} \in V, \mathcal{K} \mathbf{v} = k \mathbf{v}$。

[例 3] 在 $\mathbb{R}^2$ 上建立直角坐标系，考虑将向量 $\begin{bmatrix} x \\ y \end{bmatrix}$ 逆时针旋转 $\varphi$。

- 取极坐标 $\begin{cases} x = r \cos \theta \\ y = r \sin \theta \end{cases}$。
- 则旋转后得到 $\begin{cases} x' = r \cos (\theta + \varphi) = r \cos \theta \cos \varphi - r \sin \theta \sin \varphi = x \cos \varphi - y \sin \varphi \\ y' = r \sin (\theta + \varphi) = r \sin \theta \cos \varphi + r \cos \theta \sin \varphi = x \sin \varphi + y \cos \varphi \end{cases}$。
- 据此写出 $2 \times 2$ 的变换阵：

$$
\begin{bmatrix} x' \\ y' \end{bmatrix} = \begin{bmatrix} \cos \varphi & -\sin \varphi \\ \sin \varphi & \cos \varphi \end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix}
$$

- 故向量旋转可以表示为下列线性变换：

$$
\begin{aligned}
\mathcal{R}_{\varphi} : \ & \mathbb{R}^2 \to \mathbb{R}^2 \\
&\mathbf{v} \mapsto \begin{bmatrix} \cos \varphi & -\sin \varphi \\ \sin \varphi & \cos \varphi \end{bmatrix} \mathbf{v}
\end{aligned}
$$

#### 线性变换的运算

记 $\mathcal{L}(V, W)$ 表示从 $V$ 到 $W$ 的线性变换的集合。特别地，$\mathcal{L}(V, V)$ 表示 $V$ 上的线性变换。

##### 加法

定义 $\mathcal{L}(V, V)$ 上的加法如下：

$$
\begin{aligned}
+ : \ & \mathcal{L}(V, V) \times \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\mathcal{A} + \mathcal{B} &\mapsto & \ \mathcal{C} : V \to V \\
& & & \ \mathbf{v} \mapsto \mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v}
\end{aligned}
$$

首先证明结果是一个 $V$ 上的线性变换：

- I. 值域：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v}, \mathcal{B} \mathbf{v} \in V$，故 $\mathcal{C} \mathbf{v} = \mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v} \in V$。
- II. 保持线性性：$\forall \lambda, \mu \in \mathbb{F}, \mathbf{a}, \mathbf{b} \in V$，有：

$$
\begin{aligned}
\mathcal{C} (\lambda \mathbf{a} + \mu \mathbf{b}) &= \mathcal{A} (\lambda \mathbf{a} + \mu \mathbf{b}) + \mathcal{B} (\lambda \mathbf{a} + \mu \mathbf{b}) \\
&= (\lambda \mathcal{A} \mathbf{a} + \mu \mathcal{A} \mathbf{b}) + (\lambda \mathcal{B} \mathbf{a} + \mu \mathcal{B} \mathbf{b}) \\
&= \lambda (\mathcal{A} \mathbf{a} + \mathcal{B} \mathbf{a}) + \mu (\mathcal{A} \mathbf{b} + \mathcal{B} \mathbf{b}) \\
&= \lambda \mathcal{C} \mathbf{a} + \mu \mathcal{C} \mathbf{b}
\end{aligned}
$$

此外，要将一个运算声明为“加法”，我们需要证明下列性质：

- (1) 交换律：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v} = \mathcal{B} \mathbf{v} + \mathcal{A} \mathbf{v}$。
- (2) 结合律：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} + (\mathcal{B} \mathbf{v} + \mathcal{C} \mathbf{v}) = (\mathcal{A} \mathbf{v} + \mathcal{B} \mathbf{v}) + \mathcal{C} \mathbf{v}$。
- (3) 零元存在：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} + \mathcal{O} \mathbf{v} = \mathcal{O} \mathbf{v} + \mathcal{A} \mathbf{v} = \mathcal{A} \mathbf{v}$。
- (4) 负元存在：$\forall \mathbf{v} \in V, \exists (-\mathcal{A}) \in \mathcal{L}(V, V), \text{s.t. } \mathcal{A} \mathbf{v} + (-\mathcal{A}) \mathbf{v} = \mathcal{O} \mathbf{v} = \mathbf{0}$，其中算子 $-$ 定义如下：

$$
\begin{aligned}
- : \ & \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\mathcal{A} &\mapsto & \ \mathcal{B} : V \to V \\
& & & \ \mathbf{v} \mapsto -(\mathcal{A} \mathbf{v})
\end{aligned}
$$

可以发现，上述性质正是继承自 $V$ 上的加法。

##### 数乘

定义 $\mathcal{L}(V, V)$ 上的数乘如下：

$$
\begin{aligned}
\cdot : \ & \mathbb{F} \times \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\lambda \cdot \mathcal{A} &\mapsto & \ \mathcal{B} : V \to V \\
& & & \ \mathbf{v} \mapsto \lambda (\mathcal{A} \mathbf{v})
\end{aligned}
$$

- $\cdot$ 算子可以省略。

首先证明结果是一个 $V$ 上的线性变换：

- I. 值域：$\forall \mathbf{v} \in V, \mathcal{A} \mathbf{v} \in V$，故 $\mathcal{B} \mathbf{v} = \lambda (\mathcal{A} \mathbf{v}) \in V$。
- II. 保持线性性：$\forall \mu, \theta \in \mathbb{F}, \mathbf{a}, \mathbf{b} \in V$，有：

$$
\begin{aligned}
\mathcal{B} (\mu \mathbf{a} + \theta \mathbf{b}) &= \lambda (\mathcal{A} (\mu \mathbf{a} + \theta \mathbf{b})) \\
&= \lambda (\mu \mathcal{A} \mathbf{a} + \theta \mathcal{A} \mathbf{b}) \\
&= \mu (\lambda (\mathcal{A} \mathbf{a})) + \theta (\lambda (\mathcal{A} \mathbf{b})) \\
&= \mu (\mathcal{B} \mathbf{a}) + \theta (\mathcal{B} \mathbf{b})
\end{aligned}
$$

要将一个运算声明为“数乘”，我们需要证明下列性质：

- (1) 结合律（关于数，在左）：$\forall \mathbf{v} \in V, ((\lambda \mu) \mathcal{A}) \mathbf{v} = (\lambda (\mu \mathcal{A})) \mathbf{v}$。
- (2) 左分配律（关于数的加法）：$\forall \mathbf{v} \in V, ((\lambda + \mu) \mathcal{A}) \mathbf{v} = (\lambda \mathcal{A}) \mathbf{v} + (\mu \mathcal{A}) \mathbf{v}$。
- (3) 右分配律（关于线性变换的加法）：$\forall \mathbf{v} \in V, (\lambda (\mathcal{A} + \mathcal{B})) \mathbf{v} = \lambda \mathcal{A} \mathbf{v} + \lambda \mathcal{B} \mathbf{v}$。
- (4) 单位元存在：$\forall \mathbf{v} \in V, (1 \cdot \mathcal{A}) \mathbf{v} = \mathcal{A} \mathbf{v}$。

可以发现，上述性质正是继承自 $V$ 上的加法与数乘。

##### 乘法

定义 $\mathcal{L}(V, V)$ 上的乘法为映射的**复合**：

$$
\begin{aligned}
\circ : \ & \mathcal{L}(V, V) \times \mathcal{L}(V, V) &\to & \ \mathcal{L}(V, V) \\
&\mathcal{A} \circ \mathcal{B} &\mapsto & \ \mathcal{C} : V \to V \\
& & & \ \mathbf{v} \mapsto \mathcal{A} (\mathcal{B} \mathbf{v})
\end{aligned}
$$

- $\circ$ 算子可以省略。

首先证明结果是一个线性变换：

要将一个运算声明为“乘法”，我们需要证明下列性质：

- (1) 结合律（_类比矩阵乘法_）：$\forall \mathbf{v} \in V, (\mathcal{A} (\mathcal{B} \mathcal{C})) \mathbf{v} = ((\mathcal{A} \mathcal{B}) \mathcal{C}) \mathbf{v}$。
- (2) 结合律（关于数，在左）：$\forall \mathbf{v} \in V, (\lambda (\mathcal{A} \mathcal{B})) \mathbf{v} = ((\lambda \mathcal{A}) \mathcal{B}) \mathbf{v}$。
- (3) 分配律（关于线性变换的加法）：$\forall \mathbf{v} \in V, ((\mathcal{A} + \mathcal{B}) \mathcal{C}) \mathbf{v} = (\mathcal{A} \mathcal{C}) \mathbf{v} + (\mathcal{B} \mathcal{C}) \mathbf{v}, (\mathcal{A} (\mathcal{B} + \mathcal{C})) \mathbf{v} = (\mathcal{A} \mathcal{B}) \mathbf{v} + (\mathcal{A} \mathcal{C}) \mathbf{v}$。
- (4) 单位元存在：$\forall \mathbf{v} \in V, (\mathcal{A} \mathcal{I}_d) \mathbf{v} = (\mathcal{I}_d \mathcal{A}) \mathbf{v} = \mathcal{A} \mathbf{v}$。

可以发现，上述性质正是继承自 $V$ 上的加法与数乘、以及来自复合运算的定义。

------

$(\mathcal{L}(V, V); +, \cdot, \circ; \mathbb{F})$ 的定义和上面的十二条性质表明它是一个代数 algebra。

##### 逆元

###### 定义：左逆与右逆

对于 $\mathcal{A} \in \mathcal{L}(V, V)$，若 $\exists \mathcal{B} \in \mathcal{L}(V, V), \text{s.t. } \mathcal{B} \mathcal{A} = \mathcal{I}_d$，则称 $\mathcal{B}$ 为 $\mathcal{A}$ 的左逆，同理可以定义右逆。

###### 定理（左右逆都存在则相等）

内容：若 $\mathcal{A} \in \mathcal{L}(V, V)$ 有左逆 $\mathcal{B}_L$ 和右逆 $\mathcal{B}_R$，则 $\mathcal{B}_L = \mathcal{B}_R$。

证明：

$$
\begin{aligned}
\mathcal{B}_L &= \mathcal{B}_L \mathcal{I}_d \\
&= \mathcal{B}_L (\mathcal{A} \mathcal{B}_R) \\
&= (\mathcal{B}_L \mathcal{A}) \mathcal{B}_R \\
&= \mathcal{I}_d \mathcal{B}_R \\
&= \mathcal{B}_R
\end{aligned}
$$

###### 定理（左右逆之一存在则都存在）

内容：若 $\mathcal{A} \in \mathcal{L} (V, V)$ 有左逆 $\mathcal{B}$，则 $\mathcal{B}$ 为其右逆；反之亦然。

证明：

- 下面只证明左逆必为右逆，右逆必为左逆是同理的。
- 令 $n = \dim V$，取 $V$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$。
- 设有系数 $\lambda_1, \cdots, \lambda_n \in \mathbb{F}$，使得 $\displaystyle\sum_{i = 1}^n \lambda_i (\mathcal{A} \mathbf{e}_i) = \mathbf{0}$。
- 左右同时施加变换 $\mathcal{B}$，可得：

$$
\begin{aligned}
\mathbf{0} &= \mathcal{B} \mathbf{0} \\
&= \mathcal{B} (\sum_{i = 1}^n \lambda_i (\mathcal{A} \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{B} (\mathcal{A} \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i ((\mathcal{B} \mathcal{A}) \mathbf{e}_i) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{I}_d \mathbf{e}_i) \\
&= \sum_{i = 1}^n \lambda_i \mathbf{e}_i
\end{aligned}
$$

- 由 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性无关可知 $\lambda_1 = \cdots = \lambda_n = 0$，则 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n\}$ 线性无关，故 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n\}$ 为 $V$ 的一组基。
- $\forall \mathbf{v} \in V, \exists \lambda_1, \cdots, \lambda_n \in \mathbb{F}, \text{s.t. } \mathbf{v} = \displaystyle\sum_{i = 1}^n \lambda_i (\mathcal{A} \mathbf{e}_i)$。
- 左右同时施加变换 $\mathcal{A} \mathcal{B}$，可得：

$$
\begin{aligned}
(\mathcal{A} \mathcal{B}) \mathbf{v} &= \sum_{i = 1}^n \lambda_i ((\mathcal{A} \mathcal{B}) (\mathcal{A} \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{A} ((\mathcal{B} \mathcal{A}) \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{A} (\mathcal{I}_d \mathbf{e}_i)) \\
&= \sum_{i = 1}^n \lambda_i (\mathcal{A}  \mathbf{e}_i) \\
&= \mathbf{v} \\
&= \mathcal{I}_d \mathbf{v}
\end{aligned}
$$

- 故 $\mathcal{A} \mathcal{B} = \mathcal{I}_d$，即 $\mathcal{B}$ 为 $\mathcal{A}$ 的右逆。

鉴于左乘 $n$ 阶方阵是 $V = \mathbb{R}^n$ 时的特殊情况，上述定理也可以通过线性变换的矩阵表示、利用方阵左逆与右逆的性质证明。~~但你别急，还没讲到这里。~~

------

可以发现，上面的证明依赖 $V$ 为**有限维**线性空间。事实上，当 $V$ 为**无限维**线性空间，有如下反例：

- 考虑实多项式空间 $V = \mathbb{P}[x]$。
- 在 $V$ 上定义求导算子 $\mathcal{D}$ 和积分算子 $\mathcal{I}$：

$$
\begin{aligned}
\mathcal{D} : \ & V &\to & \ V \\
&f &\mapsto & \ f' \\
\mathcal{I} : \ & V &\to & \ V \\
&f &\mapsto & \ \mathcal{I} f : \mathbb{R} \to \mathbb{R} \\
& & & \ \mathcal{I} f(x) \mapsto \int _0^x f(x) \text{d} x \\
\end{aligned}
$$

- 易得 $\mathcal{D} \mathcal{I} = \mathcal{I}_d$，但由于常数被抹去，有 $\mathcal{I} \mathcal{D} \neq \mathcal{I}_d$，故 $V$ 上左右逆之一存在不能推出另一个也存在。

------

对于（我们默认讨论的）**有限维**线性空间，在上面两个定理的基础上，可以定义逆元如下。

###### 定义：逆元

对于 $\mathcal{A} \in \mathcal{L}(V, V)$，若 $\exists \mathcal{B} \in \mathcal{L}(V, V), \text{s.t. } \mathcal{B} \mathcal{A} = \mathcal{A} \mathcal{B} = \mathcal{I}_d$，则称 $\mathcal{B}$ 为 $\mathcal{A}$ 的逆元。

###### 定理（判定逆元不必证明保持线性性）

内容：对于 $\mathcal{A} \in \mathcal{L}(V, V)$，若 $\exists \mathcal{B} : V \to V, \text{s.t. } \mathcal{B} \mathcal{A} = \mathcal{A} \mathcal{B} = \mathcal{I}_d$，则 $\mathcal{B} \in \mathcal{L}(V, V)$，即 $\mathcal{B}$ 为 $\mathcal{A}$ 的逆元。

证明：

- 我们将保持线性性拆成下面 I、II 两部分来证明：
- I. 证明 $\mathcal{B} (\mathbf{a} + \mathbf{b}) = \mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b}$：

$$
\begin{aligned}
\mathcal{B} (\mathbf{a} + \mathbf{b}) &= \mathcal{B} ((\mathcal{A} \mathcal{B}) \mathbf{a} + (\mathcal{A} \mathcal{B}) \mathbf{b}) \\
&= \mathcal{B} (\mathcal{A} (\mathcal{B} \mathbf{a}) + \mathcal{A} (\mathcal{B} \mathbf{b})) \\
&= \mathcal{B} (\mathcal{A} (\mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b})) \\
&= (\mathcal{B} \mathcal{A}) (\mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b}) \\
&= \mathcal{B} \mathbf{a} + \mathcal{B} \mathbf{b}
\end{aligned}
$$

- II. 证明 $\mathcal{B} (\lambda \mathbf{a}) = \lambda \mathcal{B} \mathbf{a}$：

$$
\begin{aligned}
\mathcal{B} (\lambda \mathbf{a}) &= \mathcal{B} (\lambda (\mathcal{A} \mathcal{B}) \mathbf{a}) \\
&= \mathcal{B} (\lambda \mathcal{A} (\mathcal{B} \mathbf{a})) \\
&= \mathcal{B} (\mathcal{A} (\lambda \mathcal{B} \mathbf{a})) \\
&= (\mathcal{B} \mathcal{A}) (\lambda \mathcal{B} \mathbf{a}) \\
&= \lambda \mathcal{B} \mathbf{a}
\end{aligned}
$$

##### 幂

类比一般意义下的数，定义关于线性变换 $\mathcal{A} \in \mathcal{L}(V, V)$ 和自然数 $n \in \mathbb{N}$ 的幂 $\mathcal{A}^n$：

$$
\mathcal{A}^n = \begin{cases}
\mathcal{I}_d, &\quad n = 0 \\
\mathcal{A}^{n - 1} \mathcal{A}, &\quad n > 0
\end{cases}
$$

##### 线性变换多项式

类比数域上的多项式，定义关于线性变换 $\mathcal{A} \in \mathcal{L} (V, V)$ 的多项式 $p_n(\mathcal{A})$：

$$
p_n(\mathcal{A}) = \sum_{i = 0}^n c_i \mathcal{A}^i \in \mathcal{L}(V, V)
$$

### 线性变换的矩阵表示

对于 $n$ 维线性空间 $V$，考虑选定一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$。

考察 $V$ 上的线性变换 $\mathcal{A}$，为了确定任意 $\mathcal{A} \mathbf{x}$ 的取值，先确定 $\mathcal{A} \mathbf{e}_i$：

$$
\exists ! a_{1, i}, \cdots, a_{n, i} \in \mathbb{F}, \text{s.t. } \mathcal{A} \mathbf{e}_i = \sum_{j = 1}^n a_{j, i} \mathbf{e}_j
$$

记 $\mathbf{A} = (a_{i, j})_{n \times n}$，对于 $\mathbf{x} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix}$，有：

$$
\begin{aligned}
\mathcal{A} \mathbf{x} &= \sum_{i = 1}^n x_i \mathcal{A} \mathbf{e}_i \\
&= \sum_{i = 1}^n x_i \sum_{j = 1}^n a_{j, i} \mathbf{e}_j \\
&= \sum_{j = 1}^n \mathbf{e}_j \sum_{i = 1}^n a_{j, i} x_i \\
&= \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{A} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix})
\end{aligned}
$$

即 $\mathcal{A}$ 使得 $\mathbf{x}$ 的坐标向量左乘了 $\mathbf{A}$，此时称 $\mathbf{A}$ 为 $\mathcal{A}$ 在基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 下的矩阵表示 / 变换阵。

#### 定理（线性变换与方阵）

内容：对于 $\mathbb{F}$ 上的 $n$ 维线性空间 $V$，有 $\mathcal{L}(V, V) \cong \mathbb{F}^{n \times n}$。

证明：

- $\forall \mathcal{A} \in \mathcal{L}(V, V)$，任取 $V$ 上的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$，由上可确定与之对应的矩阵 $\mathbf{A}$，构成映射 $\mathcal{R}$：

$$
\begin{aligned}
\mathcal{R} : \ & \mathcal{L}(V, V) &\to & \ \mathbb{F}^{n \times n} \\
&\mathcal{A} &\mapsto & \ \mathcal{R}(\mathcal{A}) = \mathbf{A}
\end{aligned}
$$

- I. 单射：考虑证明逆否命题：已知 $\mathcal{R}(\mathcal{A}) = \mathcal{R}(\mathcal{B})$，则 $\mathbf{A} = \mathbf{B}$。
- 则 $\forall \mathbf{x} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix} \in V, \mathcal{A} \mathbf{x} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{A} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix}) = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{B} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix}) = \mathcal{B} \mathbf{x}$。
- 故 $\mathcal{A} = \mathcal{B}$，即 $\mathcal{R}$ 为单射。
- II. 满射：$\forall \mathbf{A} \in \mathbb{F}^{n \times n}$，构造下面的 $\mathcal{A}$：

$$
\begin{aligned}
\mathcal{A} : \ & V &\to & \ V \\
&\mathbf{x} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix} &\mapsto & \ \mathcal{A} \mathbf{x} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{A} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix})
\end{aligned}
$$

- 故 $\mathcal{R} (\mathcal{A}) = \mathbf{A}$，即 $\mathcal{R}$ 为满射。
- III. 保持线性性：$\forall \lambda, \mu \in \mathbb{F}, \forall \mathbf{a} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \begin{bmatrix} a_1 \\ \vdots \\ a_n \end{bmatrix}, \mathbf{b} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \begin{bmatrix} b_1 \\ \vdots \\ b_n \end{bmatrix} \in V$，有：

$$
\begin{aligned}
\mathcal{A} (\lambda \mathbf{a} + \mu \mathbf{b}) &= \mathcal{A} (\begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \begin{bmatrix} \lambda_1 a_1 + \mu_1 b_1 \\ \vdots \\ \lambda_n a_n + \mu_n b_n \end{bmatrix}) \\
&= \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{A} \begin{bmatrix} \lambda_1 a_1 + \mu_1 b_1 \\ \vdots \\ \lambda_n a_n + \mu_n b_n \end{bmatrix}) \\
&= \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\lambda \mathbf{A} \begin{bmatrix} a_1 \\ \vdots \\ a_n \end{bmatrix} + \mu \mathbf{A} \begin{bmatrix} b_1 \\ \vdots \\ b_n \end{bmatrix}) \\
&= \lambda \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{A} \begin{bmatrix} a_1 \\ \vdots \\ a_n \end{bmatrix}) + \mu \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{A} \begin{bmatrix} b_1 \\ \vdots \\ b_n \end{bmatrix}) \\
&= \lambda \mathcal{A} \mathbf{a} + \mu \mathcal{A} \mathbf{b}
\end{aligned}
$$

[例 4] 如下定义 $\mathbb{R}^3$ 中的投影变换。给定 $\mathbf{a} = \begin{bmatrix} a_1 \\ a_2 \\ a_3 \end{bmatrix}$，写出 $\mathbb{P}_{\mathbf{a}}$ 在标准正交基下的变换阵 $\mathbf{P}_{\mathbf{a}}$。

$$
\begin{aligned}
\mathbb{P}_{\mathbf{a}} : \ & \mathbb{R}^3 &\to & \ \mathbb{R}^3 \\
&\mathbf{x} &\mapsto & \ \mathbb{P}_{\mathbf{a}}(\mathbf{x}) = \frac{(\mathbf{a}, \mathbf{x})}{||\mathbf{a}||^2} \cdot \mathbf{a}
\end{aligned}
$$

直接写出坐标再做不会出现任何问题，下面介绍另一种利用**向量**性质的做法。

- 具体地，利用了 $\dfrac{\mathbf{a}^T \mathbf{x}}{||\mathbf{a}||^2}$ 是**数**、因而可以随意移动的性质。

$$
\begin{aligned}
\mathbb{P}_{\mathbf{a}}(\mathbf{x}) &= \frac{(\mathbf{a}, \mathbf{x})}{||\mathbf{a}||^2} \cdot \mathbf{a} \\
&= \frac{\mathbf{a}^T \mathbf{x}}{||\mathbf{a}||^2} \cdot \mathbf{a} \\
&= \mathbf{a} \cdot \frac{\mathbf{a}^T \mathbf{x}}{||\mathbf{a}||^2} \\
&= \frac{\mathbf{a} \mathbf{a}^T}{||\mathbf{a}||^2} \cdot \mathbf{x}
\end{aligned}
$$

故 $\mathbf{P}_{\mathbf{a}} = \dfrac{\mathbf{a} \mathbf{a}^T}{||\mathbf{a}||^2}$。

[例 5] 如下定义 $\mathbb{R}^3$ 中的外积变换。给定 $\mathbf{a} = \begin{bmatrix} a_1 \\ a_2 \\ a_3 \end{bmatrix}$，写出 $\mathbb{W}_{\mathbf{a}}$ 在标准正交基下的变换阵 $\mathbf{W}_{\mathbf{a}}$。

$$
\begin{aligned}
\mathbb{W}_{\mathbf{a}} : \ & \mathbb{R}^3 &\to & \ \mathbb{R}^3 \\
&\mathbf{x} &\mapsto & \ \mathbb{W}_{\mathbf{a}}(\mathbf{x}) = \mathbf{a} \times \mathbf{x}
\end{aligned}
$$

考察 $\mathbf{x} = \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix}$：

$$
\begin{aligned}
\mathbb{W}_{\mathbf{a}} (\mathbf{x}) &= \begin{bmatrix} \begin{vmatrix} a_2 & a_3 \\ x_2 & x_3 \end{vmatrix} \\ \begin{vmatrix} a_3 & a_1 \\ x_3 & x_1 \end{vmatrix} \\ \begin{vmatrix} a_1 & a_2 \\ x_1 & x_2 \end{vmatrix} \end{bmatrix} \\
&= \begin{bmatrix} a_2 x_3 - a_3 x_2 \\ a_3 x_1 - a_1 x_3 \\ a_1 x_2 - a_2 x_1 \end{bmatrix} \\
&= \begin{bmatrix} 0 & -a_3 & a_2 \\ a_3 & 0 & -a_1 \\ -a_2 & a_1 & 0 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix}
\end{aligned}
$$

故 $\mathbf{W}_{\mathbf{a}} (\mathbf{x}) = \begin{bmatrix} 0 & -a_3 & a_2 \\ a_3 & 0 & -a_1 \\ -a_2 & a_1 & 0 \end{bmatrix}$。

#### 基变换下的变换阵

已知 $\mathcal{A}$ 在 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 下的变换阵为 $\mathbf{A}$，我们尝试据此求出其在一组新基 $\{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$ 下的变换阵 $\tilde{\mathbf{A}}$。

设从 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 到 $\{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$ 的变换阵为 $\mathbf{T}$，则当 $\mathbf{x}$ 在前者下的坐标为 $\begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix}$，在后者下的坐标 $\begin{bmatrix} \xi_1 \\ \vdots \\ \xi_n \end{bmatrix} = \mathbf{T}^{-1} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix}$。

我们要求 $\begin{bmatrix} \mathbf{e}_1, \cdots, \mathbf{e}_n \end{bmatrix} \mathbf{A} \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix} = \begin{bmatrix} \boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n \end{bmatrix} \tilde{\mathbf{A}} \begin{bmatrix} \xi_1 \\ \vdots \\ \xi_n \end{bmatrix}$，比较即得 $\mathbf{A} = \mathbf{T} \tilde{\mathbf{A}} \mathbf{T}^{-1}$，即 $\tilde{\mathbf{A}} = \mathbf{T}^{-1} \mathbf{A} \mathbf{T}$。

[例 7] 求 $\mathbb{P}_2 [x]$ 在分别以 $\{1, x, x^2\}, \{1 + x, x + x^2, x^2 + 1\}$ 为基时，微分算子 $\mathcal{D}$ 的变换阵 $\mathbf{D}, \tilde{\mathbf{D}}$。

以 $\{1, x, x^2\}$ 为基时，有：

$$
\begin{aligned}
\mathcal{D} (\begin{bmatrix} 1 & x & x^2 \end{bmatrix} \begin{bmatrix} a_0 \\ a_1 \\ a_2 \end{bmatrix}) &= (a_0 + a_1 x + a_2 x^2)' \\
&= a_1 + 2 a_2 x \\
&= \mathcal{D} (\begin{bmatrix} 1 & x & x^2 \end{bmatrix} \begin{bmatrix} a_1 \\ 2 a_2 \\ 0 \end{bmatrix}) \\
&= \mathcal{D} (\begin{bmatrix} 1 & x & x^2 \end{bmatrix} \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 2 \\ 0 & 0 & 0 \end{bmatrix} \begin{bmatrix} a_0 \\ a_1 \\ a_2 \end{bmatrix}) \\
\end{aligned}
$$

故 $\mathbf{D} = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 2 \\ 0 & 0 & 0 \end{bmatrix}$。

易得从 $\{1, x, x^2\}$ 到 $\{1 + x, x + x^2, x^2 + 1\}$ 的变换阵为 $\mathbf{T} = \begin{bmatrix} 1 & 0 & 1 \\ 1 & 1 & 0 \\ 0 & 1 & 1 \end{bmatrix}$，进而算得 $\mathbf{T}^{-1} = \dfrac{1}{2} \begin{bmatrix} 1 & 1 & -1 \\ -1 & 1 & 1 \\ 1 & -1 & 1 \end{bmatrix}$。

故 $\tilde{\mathbf{D}} = \mathbf{T}^{-1} \mathbf{D} \mathbf{T} = \begin{bmatrix} \dfrac{1}{2} & \dfrac{3}{2} & 1 \\ -\dfrac{1}{2} & \dfrac{1}{2} & 1 \\ \dfrac{1}{2} & -\dfrac{1}{2} & -1 \end{bmatrix}$。

[例 6] 定义四元数 $a + bi + cj + dk$，其中 $a, b, c, d \in \mathbb{R}$，并规定：

- (1) 加法：$(a + bi + cj + dk) + (\tilde{a} + \tilde{b} i + \tilde{c} j + \tilde{d} k) = (a + \tilde{a}) + (b + \tilde{b}) i + (c + \tilde{c}) j + (d + \tilde{d}) k$。
- (2) 数乘：$\lambda (a + bi + cj + dk) = \lambda a + (\lambda b) i + (\lambda c) j + (\lambda d) k$。
- (3) 乘法：对加法有分配律，且 $i^2 = j^2 = k^2 = -1, ij = -ji = k, jk = -kj = i, ki = -ik = j$。
- **注意：这里的乘法没有交换律！**

可以验证 $H = \{a + bi + cj + dk \mid a, b, c, d \in \mathbb{R}\}$ 构成实线性空间。对于给定的 $h = a_0 + b_0 i + c_0 j + d_0 k$，定义线性变换 $\varphi_h$：

$$
\begin{aligned}
\varphi_h : \ & H &\to & \ H \\
& x &\mapsto & \ \varphi_h(x) = xh
\end{aligned}
$$

求 $\varphi_h$ 在基 $\{1, i, j, k\}$ 下的变换阵。

------

首先暴力计算 $\varphi_h(a + bi + cj + dk)$：

$$
(a + bi + cj + dk)(a_0 + b_0 i + c_0 j + d_0 k) = (aa_0 - bb_0 - cc_0 - dd_0) + (ab_0 + ba_0 + cd_0 - dc_0) i + (ac_0 - bd_0 + ca_0 + db_0) j + (ad_0 + bc_0 - cb_0 + da_0) k
$$

进而可以写出变换阵为：

$$
\begin{bmatrix}
a_0 & -b_0 & -c_0 & -d_0 \\
b_0 & a_0 & d_0 & -c_0 \\
c_0 & -d_0 & a_0 & b_0 \\
d_0 & c_0 & -b_0 & a_0 
\end{bmatrix}
$$

可以发现这个变换阵呈现出某种对称性。事实上，令 $\mathbf{S} = \begin{bmatrix} a_0 & -b_0 \\ b_0 & a_0 \end{bmatrix}, \mathbf{T} = \begin{bmatrix} c_0 & -d_0 \\ d_0 & c_0 \end{bmatrix}$，则变换阵也可以写成下面的分块矩阵：

$$
\begin{bmatrix}
\mathbf{S} & -\mathbf{T}^T \\
\mathbf{T} & \mathbf{S}^T
\end{bmatrix}
$$

#### 定义：相似 Similar

称 $n$ 阶方阵 $\mathbf{A}, \mathbf{B}$ 相似（记作 $\mathbf{A} \sim \mathbf{B}$），若 $\exists \mathbf{T}$ 可逆，$\text{s.t. } \mathbf{B} = \mathbf{T}^{-1} \mathbf{A} \mathbf{T}$。

#### 定理：相似是一种等价关系。

证明：

- (1) $\mathbf{A} \sim \mathbf{A}$：取 $\mathbf{T} = \mathbf{I}_n$ 即可。
- (2) $\mathbf{A} \sim \mathbf{B} \Rightarrow \mathbf{B} \sim \mathbf{A}$：若 $\mathbf{B} = \mathbf{T}^{-1} \mathbf{A} \mathbf{T}$，则 $\mathbf{A} = (\mathbf{T}^{-1})^{-1} \mathbf{B} \mathbf{T}^{-1}$。
- (3) $\mathbf{A} \sim \mathbf{B}, \mathbf{B} \sim \mathbf{C} \Rightarrow \mathbf{A} \sim \mathbf{C}$：若 $\mathbf{B} = \mathbf{S}^{-1} \mathbf{A} \mathbf{S}, \mathbf{C} = \mathbf{T}^{-1} \mathbf{B} \mathbf{T}$，则 $\mathbf{C} = (\mathbf{S} \mathbf{T})^{-1} \mathbf{A} (\mathbf{S} \mathbf{T})$。

### 线性变换的值域与核

#### 定义：值域 Range / 像空间 Image Space 与秩

对于线性空间 $V$ 上的线性变换 $\mathcal{A}$，称 $\mathcal{R} (\mathcal{A}) = \{\mathcal{A} \mathbf{v} \mid \mathbf{v} \in V\}$ 为 $\mathcal{A}$ 的值域（又称像空间 $\text{Im} (\mathcal{A})$）。

容易验证，$\mathcal{R} (\mathcal{A})$ 关于 $V$ 上的加法与数乘构成其线性子空间。

定义 $\mathcal{A}$ 的秩 $\operatorname{rank}(\mathcal{A}) = \dim \mathcal{R} (\mathcal{A})$。

#### 定义：核 Kernal / 零空间 Null Space 与零度

对于线性空间 $V$ 上的线性变换 $\mathcal{A}$，称 $\ker(\mathcal{A}) = \{\mathbf{v} \in V \mid \mathcal{A} \mathbf{v} = \mathbf{0}\}$ 为 $\mathcal{A}$ 的核（又称零空间 $\mathcal{N} (\mathcal{A})$）。

由于 $\mathbf{0} \in \ker (\mathcal{A})$，$\ker (\mathcal{A})$ 必不为空集。容易验证，$\ker(\mathcal{A})$ 关于 $V$ 上的加法与数乘构成其线性子空间。

定义 $\mathcal{A}$ 的零度 $n(\mathcal{A}) = \dim \ker(\mathcal{A})$。

#### 定理（线性变换的“秩”与变换阵的“秩”）

- _Motivation：考虑 $V = \mathbb{R}^n$ 的情况，此时线性变换 $\mathcal{A}$ 直接由代数向量左乘 $n$ 阶方阵 $\mathbf{A}$ 来表征。因此，可以考虑线性变换的“秩”与变换阵的“秩”之间的关联。_

内容：若 $\mathcal{A} \in \mathcal{L} (V, V)$ 在 $V$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 下的变换阵为矩阵 $\mathbf{A}$，则 $\operatorname{rank}(\mathcal{A}) = \operatorname{rank}(\mathbf{A})$。

证明：

- 易证 $\mathcal{R} (\mathcal{A}) = \operatorname{span}(\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n)$。
- 令 $r = \operatorname{rank}(\mathcal{A})$，则 $r = \dim(\operatorname{span}(\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n)) = \operatorname{rank}(\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n)$。
- 取 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n\}$ 的一个极大无关组，不妨设其为 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_r\}$。
- 设 $\mathbf{A} = \begin{bmatrix} \tilde{\mathbf{a}}_1 & \cdots & \tilde{\mathbf{a}}_n \end{bmatrix}$，则 $\mathcal{A} \mathbf{e}_i = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \tilde{\mathbf{a}}_i$。
- 由**同构**关系 $V \cong \mathbb{F}^n$ 可知 $V$ 中的线性相关性与其坐标向量的线性相关性等价，故 $\{\tilde{\mathbf{a}}_1, \cdots, \tilde{\mathbf{a}}_n\}$（即 $\mathbf{A}$ 中的列向量组）与 $\{\mathcal{A} \mathbf{e}_1, \cdots, \mathcal{A} \mathbf{e}_n\}$ 的极大无关组对应一致，均为 $r$ 个。
- 由秩的定义可知 $\operatorname{rank}(\mathbf{A}) = \operatorname{rank}(\tilde{\mathbf{a}}_1, \cdots, \tilde{\mathbf{a}}_n) = r = \operatorname{rank}(\mathcal{A})$。

#### 定理（Yet Another 维数定理 / 秩-零度定理）

内容：$\forall \mathcal{A} \in \mathcal{L} (V, V), \operatorname{rank}(\mathcal{A}) + n(\mathcal{A}) = \dim V$。

证明：

- 令 $n = \dim V, s = n(\mathcal{A}) = \dim \ker(\mathcal{A})$，取 $\ker(\mathcal{A})$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_s\}$，并将其扩充为 $V$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$。
- $\forall \mathbf{v} = \displaystyle\sum_{i = 1}^n v_i \mathbf{e}_i \in V, \mathcal{A} \mathbf{v} = \displaystyle\sum_{i = 1}^n v_i \mathcal{A} \mathbf{e}_i = \sum_{i = s + 1}^n v_i \mathcal{A} \mathbf{e}_i$，则 $\mathcal{R} (\mathcal{A}) = \operatorname{span}(\mathcal{A} \mathbf{e}_{s + 1}, \cdots, \mathcal{A} \mathbf{e}_n)$。
- 若 $\displaystyle\sum_{i = s + 1}^n \lambda_i \mathcal{A} \mathbf{e}_i = \mathbf{0}$，则 $\mathcal{A} (\displaystyle\sum_{i = s + 1}^n \lambda_i \mathbf{e}_i) = 0$，故 $\displaystyle\sum_{i = s + 1}^n \lambda_i \mathbf{e}_i \in \ker(\mathcal{A})$，则其可由 $\{\mathbf{e}_1, \cdots, \mathbf{e}_s\}$ 线性表出。
- 若其非零，可知 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性相关，矛盾。
- 故 $\lambda_{s + 1} = \cdots = \lambda_n = 0$，则 $\{\mathcal{A} \mathbf{e}_{s + 1}, \cdots, \mathcal{A} \mathbf{e}_n\}$ 线性无关。
- 因而 $\operatorname{rank}(\mathcal{A}) = \dim(\operatorname{span}(\mathcal{A} \mathbf{e}_{s + 1}, \cdots, \mathcal{A} \mathbf{e}_n)) = \operatorname{rank}(\mathcal{A} \mathbf{e}_{s + 1}, \cdots, \mathcal{A} \mathbf{e}_n) = n - s$，故 $\operatorname{rank}(\mathcal{A}) + n(\mathcal{A}) = n = \dim V$。

推论：

- 有限维线性空间上的单射、满射和双射等价。

事实上，上面的证明可以直接从**线性变换**扩展到**线性映射**的情况（即 $\mathcal{A} \in \mathcal{L} (V, W)$）。
