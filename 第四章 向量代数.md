# 第四章 向量代数

### 距离 distance

在空间 $\chi$ 中，定义距离为一个二元函数 $d : \chi \times \chi \to \mathbb{R}$，其满足：

- (1) 对称性：$d(A, B) = d(B, A)$。
- (2) 正定性：$d(A, B) \geq 0$ 且 $d(A, B) = 0 \Leftrightarrow A = B$。
- (3) 三角形不等式：$d(A, B) \leq d(A, C) + d(C, B)$。

满足上述条件的“距离”例如：

- (1) 平庸距离 $d(A, B) = [A \neq B]$。
- (2) $\mathbb{R}^n$ 中的欧氏距离。

在本章中，我们主要讨论 $\mathbb{R}^3$ 中的问题。

### 几何向量 vector

#### 定义：几何向量

- 这里需要承认**线段全等公理**（过任意一点可作唯一线段与已知线段全等）和**平行公理**（过任意一点可作唯一直线与已知直线平行）。
- 原因在于几何向量不关心“起点”，它只关心“长度”和“方向”。因此，它可以被视作空间中若干线段的“等价类”。

（几何）向量指既有长度也有方向的量，可以用代数向量的记号 $\mathbf{v}$ 表示，也可以用其始末 $\overrightarrow{AB}$ 来表示。特别地，我们称 $\overrightarrow{AA}$ 为零向量，又记作 $\mathbf{0}$，它没有特定的方向。

记 $|\overrightarrow{AB}|$ 向量 $\overrightarrow{AB}$ 的长度。特别地，$|\overrightarrow{AA}| = |\mathbf{0}| = 0$。

#### 定义：向量的数乘

- 这里需要承认**延长公理**（有限直线可以沿其方向无限延长），进而才能利用有理逼近构造长度为原向量任意正实数倍的向量。

对于任意 $\lambda \in \mathbb{R}$ 和向量 ，定义数乘运算 $\lambda \cdot \overrightarrow{AB}$：

- 若 $\lambda > 0$，定义 $\lambda \cdot \overrightarrow{AB}$ 为沿 $\overrightarrow{AB}$ 方向且长度为其 $\lambda$ 倍的向量。
- 若 $\lambda = 0$，定义 $\lambda \cdot \overrightarrow{AB} = \mathbf{0}$。
- 若 $\lambda < 0$，定义 $\lambda \cdot \overrightarrow{AB} = (-\lambda) \cdot \overrightarrow{BA}$。

#### 定义：单位向量

给定**非零**向量 $\overrightarrow{AB}$，定义该方向上的单位向量为 $\dfrac{1}{|\overrightarrow{AB}|} \cdot |\overrightarrow{AB}|$。

由向量的数乘的定义可知：单位向量的长度为 $1$。

#### 定义：向量的平行 / 共线

定义向量 $\mathbf{a}, \mathbf{b}$ 平行 / 共线当且仅当 $\exists \lambda \in \mathbb{R}, \text{s.t. } \mathbf{a} = \lambda \cdot \mathbf{b}$ 或 $\exists \mu \in \mathbb{R}, \mathbf{b} = \mu \cdot \mathbf{a}$，记作 $a \parallel b$。

根据定义，零向量与任意向量平行。

#### 定义：向量的加法

对于向量 $\overrightarrow{AB}, \overrightarrow{B'C'}$，如下定义两者间的加法：

- 作 $\overrightarrow{BC} = \overrightarrow{B' C'}$。
- 定义 $\overrightarrow{AB} + \overrightarrow{B'C'} \equiv \overrightarrow{AC}$。

#### 定义：相反向量与向量的减法

对于向量 $\mathbf{a}$，定义 $-\mathbf{a} \equiv (-1) \cdot \mathbf{a}$，称为其相反向量。

对于向量 $\mathbf{a}, \mathbf{b}$，定义向量的减法 $\mathbf{a} - \mathbf{b} \equiv \mathbf{a} + (-\mathbf{b})$。

------

不难证明这样定义的几何向量也满足前面讨论的代数向量的若干基本性质。

#### 范数 Norm

对于线性空间 $G$，一个名为**范数**的映射 $||\mathbf{a}|| : G \to \mathbb{R}$ 应当满足：

- (1) 正定性：$||\mathbf{a}|| \geq 0$ 且 $||\mathbf{a}|| = 0 \Leftrightarrow \mathbf{a} = 0$。
- (2) 齐次性：$||\lambda \mathbf{a}|| = |\lambda| \cdot ||\mathbf{a}||$。
- (3) 三角形不等式：$||\mathbf{a} + \mathbf{b}|| \leq ||\mathbf{a}|| + ||\mathbf{b}||$。

一个给出范数定义的线性空间被称作赋范线性空间。

不难验证 $d(\mathbf{a}, \mathbf{b}) = ||\mathbf{a} - \mathbf{b}||$ 是 $G$ 上的一个距离，证明略。

##### 例子

$G$ 上范数的定义并不唯一：

- 欧氏距离 $||\mathbf{a}||_E$。
- $1-$ 范数 $||\mathbf{a}||_1$，其值为各维坐标绝对值之和。
- $\infty-$ 范数 $||\mathbf{a}||_{\infty}$，其值为各维坐标绝对值的最大值。

------

#### 定理：$\mathbf{a} \parallel \mathbf{b} \Leftrightarrow \exists \lambda, \mu \in \mathbb{R}$ 不全为 $0$，使得 $\lambda \mathbf{a} + \mu \mathbf{b} = 0$。

证明略。

#### 定义：直线 Line

对于点 $A$ 和**非零**向量 $\mathbf{a}$，定义直线 $L(A; \mathbf{a}) = \{B \mid \overrightarrow{AB} = \lambda \mathbf{a}, \lambda \in \mathbb{R}\}$。

#### 定义：平面 Plane

对于点 $O$ 和**不共线**向量 $\mathbf{a}, \mathbf{b}$，定义平面 $\Pi(O; \mathbf{a}, \mathbf{b}) = \{C \mid \overrightarrow{OC} = \lambda \mathbf{a} + \mu \mathbf{b}, \lambda, \mu \in \mathbb{R}\}$。

- 考虑 $\overrightarrow{OA} = \mathbf{a}, \overrightarrow{OB} = \mathbf{b}$，可以发现 $\overrightarrow{OA}, \overrightarrow{OB}$ 也能唯一确定该平面。
- 故称“两条相交直线确定一个平面”。

#### 定义：共面

我们称 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 共面，当且仅当 $\exists \Pi (O; \mathbf{x}, \mathbf{y}), \text{s.t. }$ 把 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 的起点置于 $O$ 时，另一端点 $A, B, C \in \Pi (O; x, y)$。

#### 定理：$\mathbf{a}, \mathbf{b}, \mathbf{c}$ 共面 $\Leftrightarrow \exists \lambda, \mu, \theta \in \mathbb{R}$ 非全零，$\text{s.t. } \lambda \mathbf{a} + \mu \mathbf{b} + \theta \mathbf{c} = \mathbf{0}$。

证明：

- $\Rightarrow$：(1) 若 $\mathbf{a}, \mathbf{b}$ 共线，令 $\theta = 0$，则由定义可知非全零的 $\lambda, \mu$ 存在。
- (2) 若 $\mathbf{a}, \mathbf{b}$ 不共线，将 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 的起点置于同一点 $O$ 时，其终点 $A, B, C$ 位于同一平面。
- 由于 $O, \mathbf{a}, \mathbf{b}$ 确定了平面 $\Pi (O; \mathbf{a}, \mathbf{b})$，则 $C \in \Pi (O; \mathbf{a}, \mathbf{b})$，故 $\exists \lambda, \mu, \text{s.t. } \mathbf{c} = \lambda \mathbf{a} + \mu \mathbf{b}$。令 $\theta = -1$ 即可。
- $\Leftarrow$：将 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 的起点置于同一点 $O$ 时，设其终点为 $A, B, C$。
- 由于 $\lambda, \mu, \theta$ 非全零，不妨设 $\theta \neq 0$，则 $\mathbf{c} = -\dfrac{\lambda}{\theta} \mathbf{a} - \dfrac{\mu}{\theta} \mathbf{b}$。
- (1) 若 $\mathbf{a}, \mathbf{b}$ 共线，不妨设 $\mathbf{b} = \alpha \mathbf{a}$，则 $\mathbf{c} = -\dfrac{\lambda + \mu \alpha}{\theta} \mathbf{a}$。
- I. 当 $\mathbf{a} = \mathbf{0}$，此时有 $\mathbf{b} = \mathbf{c} = \mathbf{0}$，则 $A = B = C = O$，任取过 $O$ 的平面即可。
- II. 当 $\mathbf{a} \neq \mathbf{0}$，则 $B, C$ 均在 $\overrightarrow{OA}$ 所在的直线上，任取 $\overrightarrow{OA}$ 所在的平面即可。
- (2) 若 $\mathbf{a}, \mathbf{b}$ 不共线，则 $\overrightarrow{OC} = \mathbf{c} = (-\dfrac{\lambda}{\theta}) \mathbf{a} + (-\dfrac{\mu}{\theta}) \mathbf{b}$，于是 $C \in \Pi (O; \mathbf{a}, \mathbf{b})$。
- 又因为 $A, B \in \Pi (O; \mathbf{a}, \mathbf{b})$，由定义可知 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 共面。
- _这里能取出“平面”的原因涉及三维空间的定义。_

#### 直线间的关系

对于直线 $L(A; \mathbf{a}), L(B; \mathbf{b})$：

- (1) 若 $\mathbf{a} \parallel \mathbf{b}$，设 $\mathbf{b} = \alpha \mathbf{a}$，其中 $\alpha \neq 0$。
- I. 当 $\overrightarrow{AB} \parallel \mathbf{a}$，设 $\overrightarrow{AB} = \beta \mathbf{a}$，则：

$$
\begin{aligned}
L(B; \mathbf{b}) &= \{C \mid \overrightarrow{BC} = \lambda \mathbf{b}, \lambda \in \mathbb{R}\} \\
&= \{C \mid \overrightarrow{AC} = \overrightarrow{AB} + \overrightarrow{BC} = (\beta + \lambda \alpha) \mathbf{a}, \lambda \in \mathbb{R}\} \\
&= \{C \mid \overrightarrow{AC} = \theta \mathbf{a}, \theta \in \mathbb{R}, \lambda = \dfrac{\theta - \beta}{\alpha} \in \mathbb{R}\} \\
&= L(A; \mathbf{a})
\end{aligned}
$$

- 此时称 $L(A; \mathbf{a}), L(B; \mathbf{b})$ **重合**。
- II. 当 $\overrightarrow{AB} \not\parallel \mathbf{a}$，假设 $\exists C \in L(A; \mathbf{a}) \cap L(B; \mathbf{b})$，则 $\begin{cases} \overrightarrow{AC} = \lambda \mathbf{a}, \lambda \in \mathbb{R} \\ \overrightarrow{BC} = \mu \mathbf{b}, \mu \in \mathbb{R} \end{cases} \Rightarrow \overrightarrow{AB} = \overrightarrow{AC} - \overrightarrow{BC} = (\lambda - \mu \alpha) \mathbf{a}$，于是 $\overrightarrow{AB} \parallel \mathbf{a}$，矛盾。故 $L(A; \mathbf{a}) \cap L(B; \mathbf{b}) = \emptyset$。
- 此时称 $L(A; \mathbf{a}), L(B; \mathbf{b})$ **平行**。
- (2) 若 $\mathbf{a} \not\parallel \mathbf{b}$。
- I. 当 $\overrightarrow{AB}$ 与 $\mathbf{a}, \mathbf{b}$ 共面，此时 $\exists ! \lambda, ! \mu \in \mathbb{R}, \text{s.t. } \overrightarrow{AB} = \lambda \mathbf{a} + \mu \mathbf{b}$。
- 断言 $L(A; \mathbf{a}) \cap L(B; \mathbf{b}) = \{C\}$，下为证明：
- 首先说明 $C$ **存在**：取 $\overrightarrow{AC} = \lambda \mathbf{a}$，则 $\overrightarrow{BC} = \overrightarrow{AC} - \overrightarrow{AB} = -\mu \mathbf{b}$，由定义知 $C \in L(A; \mathbf{a}), C \in L(B; \mathbf{b})$，故 $C \in L(A; \mathbf{a}) \cap L(B; \mathbf{b})$。
- 然后说明 $C$ **唯一**：若还存在 $C' \in L(A; \mathbf{a}) \cap L(B; \mathbf{b})$，设 $\overrightarrow{AC'} = \lambda' \mathbf{a}, \overrightarrow{BC'} = -\mu' \mathbf{b}$，其中 $(\lambda', \mu') \neq (\lambda, \mu)$，则 $\overrightarrow{AB} = \overrightarrow{AC'} - \overrightarrow{BC'} = \lambda' \mathbf{a} + \mu' \mathbf{b}$，则 $\lambda, \mu$ 中至少一个不唯一，矛盾，故 $C'$ 不存在。
- 此时称 $L(A; \mathbf{a}), L(B; \mathbf{b})$ **相交。**
- II. 当 $\overrightarrow{AB}$ 与 $\mathbf{a}, \mathbf{b}$ 不共面，此时 $\not\exists \lambda, \mu \in \mathbb{R}, \text{s.t. } \overrightarrow{AB} = \lambda \mathbf{a} + \mu \mathbf{b}$。
- 假设 $\exists C, \text{s.t. } C \in L(A; \mathbf{a}) \cap L(B; \mathbf{b})$，则 $\exists \lambda', \mu', \text{s.t. } \overrightarrow{AC} = \lambda' \mathbf{a}, \overrightarrow{BC} = \mu' \mathbf{b}$，故 $\overrightarrow{AB} = \overrightarrow{AC} - \overrightarrow{BC} = \lambda' \mathbf{a} + (-\mu') \mathbf{b}$。
- 令 $\lambda = \lambda', \mu = -\mu'$，可知 $\lambda, \mu$ 存在，矛盾，于是 $C$ 不存在。故 $L(A; \mathbf{a}) \cap L(B; \mathbf{b}) = \emptyset$。
- 此时称 $L(A; \mathbf{a}), L(B; \mathbf{b})$ **相离**。

#### 直线与平面的关系

对于直线 $L(A; \mathbf{a})$ 和平面 $\Pi (O; \mathbf{b}, \mathbf{c})$：

- (1) 若 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 共面，此时 $\exists \lambda, \mu, \theta \in \mathbb{R}$ 不全为零，$\text{s.t. } \lambda \mathbf{a} + \mu \mathbf{b} + \theta \mathbf{c} = \mathbf{0}$。若 $\lambda = 0$ 则与 $\mathbf{b}, \mathbf{c}$ 不共线矛盾，故 $\mathbf{a} = -\dfrac{\mu}{\lambda} \mathbf{b} - \dfrac{\theta}{\lambda} \mathbf{c}$。
- I. 当 $A \in \Pi (O; \mathbf{b}, \mathbf{c})$，易证 $L(A; \mathbf{a}) \subset \Pi (O; \mathbf{b}, \mathbf{c})$。
- 此时称 $L(A; \mathbf{a})$ **在** $\Pi (O; \mathbf{b}, \mathbf{c})$ **内**。
- II. 当 $A \not\in \Pi (O; \mathbf{b}, \mathbf{c})$，易证 $L(A; \mathbf{a}) \cap \Pi (O; \mathbf{b}, \mathbf{c}) = \emptyset$，且 $\forall O' \in \Pi (O; \mathbf{b}, \mathbf{c}), L(A; \mathbf{a}) \parallel L(O', \mathbf{a})$。
- 此时称 $L(A; \mathbf{a})$ **在** $\Pi (O; \mathbf{b}, \mathbf{c})$ **外**，且 $L(A; \mathbf{a})$ 与 $\Pi (O; \mathbf{b}, \mathbf{c})$ **平行**（即平面内存在直线的平行线）。
- (2) 若 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 不共面，结论是 $L(A; \mathbf{a}) \cap \Pi (O; \mathbf{b}, \mathbf{c}) = \{D\}$，此时称 $L(A; \mathbf{a})$ 与 $\Pi (O; \mathbf{b}, \mathbf{c})$ **相交**。
- _这里的证明涉及三维空间的定义。_

[例 1] 求证：$\overrightarrow{AD} = \dfrac{1}{2} (\overrightarrow{AB} + \overrightarrow{AC}) \Leftrightarrow D$ 为 $BC$ 中点。这里**中点**的定义为 $\overrightarrow{BD} + \overrightarrow{CD} = \mathbf{0}$。

证明：$\overrightarrow{AD} = \dfrac{1}{2} (\overrightarrow{AB} + \overrightarrow{AC}) \Leftrightarrow D \Leftrightarrow \overrightarrow{AD} = \dfrac{1}{2} ((\overrightarrow{AD} - \overrightarrow{BD}) + (\overrightarrow{AD} - \overrightarrow{CD})) \Leftrightarrow \overrightarrow{BD} + \overrightarrow{CD} = \mathbf{0} \Leftrightarrow D$ 为 $BC$ 中点。

[例 2] 求证：三角形三条中线交于一点（称为**重心**）。

证明：

- _Motivation：先拿两个中线算出重心位置。_
- 设三角形为 $\Delta ABC$，且 $BC, AC, AB$ 的中点为 $D, E, F$，又设 $AD, BE$ 交于 $G$。
- 由例 1 可知 $\overrightarrow{AD} = \dfrac{1}{2} (\overrightarrow{AB} + \overrightarrow{AC}), \overrightarrow{BE} = \dfrac{1}{2} (\overrightarrow{BA} + \overrightarrow{BC}) = -\overrightarrow{AB} + \dfrac{1}{2} \overrightarrow{AC}, \overrightarrow{CF} = \dfrac{1}{2} (\overrightarrow{CA} + \overrightarrow{CB}) = \dfrac{1}{2} \overrightarrow{AB} - \overrightarrow{AC}$。
- 由直线定义可知 $\exists \lambda, \mu \in \mathbb{R}, \text{s.t. } \overrightarrow{AG} = \lambda \overrightarrow{AD} = \dfrac{\lambda}{2} \overrightarrow{AB} + \dfrac{\lambda}{2} \overrightarrow{AC}, \overrightarrow{BG} = \mu \overrightarrow{BE} = -\mu \overrightarrow{AB} + \dfrac{\mu}{2} \overrightarrow{AC}$。
- 由 $\overrightarrow{AG} = \overrightarrow{AB} + \overrightarrow{BG}$ 可知 $(\dfrac{\lambda}{2} + \mu - 1) \overrightarrow{AB} + (\dfrac{\lambda}{2} - \dfrac{\mu}{2}) \overrightarrow{AC} = \mathbf{0}$。
- 由 $\overrightarrow{AB}, \overrightarrow{AC}$ 不共线可知 $\begin{cases} \dfrac{\lambda}{2} + \mu - 1 = 0 \\ \dfrac{\lambda}{2} - \dfrac{\mu}{2} = 0 \end{cases} \Rightarrow \lambda = \mu = \dfrac{2}{3}$。
- 故 $\overrightarrow{AG} = \dfrac{1}{3} (\overrightarrow{AB} + \overrightarrow{AC})$。接下来有两种想法。
- 法一：_Motivation：再拿两个中线算出重心位置，说明其相等即可。_
- 设 $AD, CF$ 交于 $G'$。
- 同理可得 $AG' = \dfrac{1}{3} (\overrightarrow{AB} + \overrightarrow{AC})$。
- 故 $\overrightarrow{GG'} = \overrightarrow{AG'} - \overrightarrow{AG} = \mathbf{0}$，即 $G, G'$ 重合。
- 法二：_Motivation：只需说明 $G$ 在 $CF$ 上即可。_
- 于是有 $\overrightarrow{CG} = \overrightarrow{AG} - \overrightarrow{AC} = \dfrac{1}{3} \overrightarrow{AB} - \dfrac{2}{3} \overrightarrow{AC}$。
- 故 $\overrightarrow{CG} = \dfrac{2}{3} \overrightarrow{CF}$，即 $G$ 在直线 $CF$ 上。
- 综上，均可得出三角形三条中线 $AD, BE, CF$ 交于一点 $G$。

### 仿射坐标系 Affine Coordinate System

#### 定义：三维空间

对于点 $O$ 和**不共面**向量 $\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3$，定义 $V(O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3) = \{A \mid \overrightarrow{OA} = a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3, (a_1, a_2, a_3) \in \mathbb{R}^3\}$。

- 注意定义表述中体现的“继承”思想：二维**不共线** $\Rightarrow$ 三维**不共面**。

#### 定理（坐标的唯一性）：对于不共面向量 $\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3$ 和三维空间中任意向量 $\mathbf{v}$，$\exists ! (a_1, a_2, a_3) \in \mathbb{R}^3, \text{s.t. } \mathbf{v} = a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3$。

证明：先证存在、后证唯一即可，略。

- 通过这一定理，我们在**几何**向量这一“几何对象”和**代数**向量这一“代数对象”之间建立了一一映射。

#### 定义：仿射坐标系

定点 $O$ 和**不共面**向量组 $\{\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 构成三维空间中的一个仿射坐标系，记作 $\{O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$，其中：

- $O$ 称为该仿射坐标系的原点。
- $\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3$ 称为其基向量，$\{\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 称为一组基。

原点和基向量确定的直线 $L(O; \mathbf{e}_1), L(O; \mathbf{e}_2), L(O; \mathbf{e}_3)$ 称为坐标轴，原点和两个基向量确定的平面 $\Pi (O; \mathbf{e}_1, \mathbf{e}_2), \Pi (O; \mathbf{e}_2, \mathbf{e}_3), \Pi (O; \mathbf{e}_3, \mathbf{e}_1)$ 称为坐标平面。

由上述定理可知：三维空间中任意向量 $\mathbf{v}$ 具有**唯一**分解式 $\mathbf{v} = a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3$，其中 $(a_1, a_2, a_3) \in \mathbb{R}^3$ 称为 $\mathbf{v}$ 在 $\{O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 下的坐标。

坐标表示也可记作 $\mathbf{v} = (a_1, a_2, a_3) \begin{bmatrix} \mathbf{e}_1 \\ \mathbf{e}_2 \\ \mathbf{e}_3 \end{bmatrix} = \begin{bmatrix} \mathbf{e}_1 & \mathbf{e}_2 & \mathbf{e}_3 \end{bmatrix} \begin{bmatrix} a_1 \\ a_2 \\ a_3 \end{bmatrix}$。

- **注意：这里并非表示行向量与列向量的乘法，因为 $\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3$ 是几何向量而非代数向量、没法被塞进矩阵里。**

对于三维空间中任意点 $A$，$\overrightarrow{OA}$ 称为 $A$ 的矢径 / 向径，称 $\overrightarrow{OA}$ 的坐标为 $A$ 的坐标。

我们将平面坐标系中“四象限”的概念拓展到仿射坐标系中“八卦限”的概念：对于坐标 $a_1, a_2, a_3 \neq 0, (a_1, a_2, a_3) \in \mathbb{R}^3$，定义其卦限为 $1 + [a_1 < 0] + [a_2 < 0] 2 + [a_3 < 0] 4$。

- Fun Fact：二仪生四象，四象生八卦。

##### 移动原点

由于几何向量不关心起点，仅仅移动原点不会影响其坐标表示。

对于 $O'(x_0, y_0, z_0) \in V(O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3)$，易知对于 $\{O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 中坐标为 $(x, y, z)$ 的点，其在 $\{O'; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 中的坐标为 $(x - x_0, y - y_0, z - z_0)$。

------

接下来的内容默认在坐标系 $\{O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 下讨论。

#### 从共线与共面关系 Revisit 到平面方程

##### 共线

设几何向量 $\mathbf{a}, \mathbf{b}$ 的坐标分别为 $(a_1, a_2, a_3), (b_1, b_2, b_3)$。

$$
\begin{aligned}
&\mathbf{a}, \mathbf{b} \text{ 共线} \\
\Leftrightarrow &\exists \lambda, \mu \in \mathbb{R} \text{ 非全零}, \text{s.t. } \lambda \mathbf{a} + \mu \mathbf{b} = \mathbf{0} \\
\Leftrightarrow &\exists \lambda, \mu \in \mathbb{R} \text{ 非全零}, \text{s.t. } \lambda (a_1, a_2, a_3) + \mu (b_1, b_2, b_3) = \mathbf{0}_3 \\
\Leftrightarrow & (a_1, a_2, a_3), (b_1, b_2, b_3) \text{ 线性相关}
\end{aligned}
$$

于是我们将**几何**向量的共线转换为了**代数**向量的线性相关，后者是我们已经会做的。

##### 共面

设几何向量 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 的坐标分别为 $(a_1, a_2, a_3), (b_1, b_2, b_3), (c_1, c_2, c_3)$。

同共线情况的讨论可知 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 共面 $\Leftrightarrow (a_1, a_2, a_3), (b_1, b_2, b_3), (c_1, c_2, c_3)$ 线性相关。

进一步地，考虑线性相关性与行列式的关系，可知其还等价于 $\begin{vmatrix} a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \\ c_1 & c_2 & c_3 \end{vmatrix} = 0$。

##### 平面方程

在上面对共面条件的讨论中，补充 $\mathbf{a}, \mathbf{b}$ 不共线。

此时三维空间内一点 $P(x, y, z)$ 在 $\Pi (O; \mathbf{a}, \mathbf{b})$ 上等价于 $\mathbf{a}, \mathbf{b}, (x, y, z)$ 共线，即 $\begin{vmatrix} a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \\ x & y & z \end{vmatrix} = 0$。

拉普拉斯展开可得 $\begin{vmatrix} a_2 & a_3 \\ b_2 & b_3 \end{vmatrix} x - \begin{vmatrix} a_1 & a_3 \\ b_1 & b_3 \end{vmatrix} y + \begin{vmatrix} a_1 & a_2 \\ b_1 & b_2 \end{vmatrix} z = 0$。这就是 $\Pi (O; \mathbf{a}, \mathbf{b})$ 的平面方程。

#### 定比分点

- **注意：由于我们现在对向量“大小”的度量是通过范数进行的，目前只能利用“齐次性”，故仅能讨论共线向量的情况。**

设有不重合的 $A, B$ 两点的**内点** $M$，使得 $|\overrightarrow{AM}| : |\overrightarrow{MB}| = \lambda : \mu$（即“按比例切分”），其中 $\lambda, \mu > 0$。

- 这里内点的定义为 $\exists \alpha \in (0, 1), \text{s.t. } \overrightarrow{AM} = \alpha \overrightarrow{AB}$，即”$M$ 在线段 $AB$ 上且非其端点“。

由数乘的定义可知 $\overrightarrow{AM} = \dfrac{|\overrightarrow{AM}|}{|\overrightarrow{AB}|} \cdot \overrightarrow{AB} = \dfrac{|\overrightarrow{AM}|}{|\overrightarrow{AM}| + |\overrightarrow{MB}|} \cdot \overrightarrow{AB} = \dfrac{\lambda}{\lambda + \mu} \cdot \overrightarrow{AB}$。

因此 $\overrightarrow{OM} = \overrightarrow{OA} + \overrightarrow{AM} = \dfrac{\mu}{\lambda + \mu} \cdot \overrightarrow{OA} + \dfrac{\lambda}{\lambda + \mu} \cdot \overrightarrow{OB}$。

设 $A(x_a, y_a, z_a), B(x_b, y_b, z_b), M(x_m, y_m, z_m)$，又令 $\alpha = \dfrac{\lambda}{\lambda + \mu} \in (0, 1)$，则有 $(x_m, y_m, z_m) = (1 - \alpha) (x_a, y_a, z_a) + \alpha (x_b, y_b, z_b)$。

#### 定义：内积 Inner / Dot Product

在三维空间 $V$ 上，定义内积为一个函数 $V \times V \to \mathbb{R}$，记作 $(\mathbf{a}, \mathbf{b})$ 或 $\mathbf{a} \cdot \mathbf{b}$（点号不能省略），满足：

- (1) 对称性：$(\mathbf{a}, \mathbf{b}) = (\mathbf{b}, \mathbf{a})$。
- (2) 正定性：$(\mathbf{a}, \mathbf{a}) \geq 0$ 且 $(\mathbf{a}, \mathbf{a}) = 0 \Leftrightarrow \mathbf{a} = 0$。
- (3) 线性性：$(\lambda \mathbf{a} + \mu \mathbf{b}, \mathbf{c}) = \lambda (\mathbf{a}, \mathbf{c}) + \mu (\mathbf{b}, \mathbf{c})$。

一个定义了内积的线性空间称作内积空间。

注：

- 内积函数的值域也可以是 $\mathbb{C}$ 或其他数域 $\mathbb{F}$。
- 对于 $\mathbb{C}$ 的情况，对称性应当改为 $(\mathbf{a}, \mathbf{b}) = \overline{(\mathbf{b}, \mathbf{a})}$，且 $(\mathbf{a}, \mathbf{a}) = \overline{(\mathbf{a}, \mathbf{a})} \Rightarrow (\mathbf{a}, \mathbf{a}) \in \mathbb{R}$。

#### 定理（内积导出范数）：$||\mathbf{a}|| = \sqrt{(\mathbf{a}, \mathbf{a})}$ 定义了 $V$ 上的一个范数 $||\mathbf{a}|| : V \to \mathbb{R}$。

证明（仅证三角形不等式）：

- _Motivation：线性性蕴含了内积对加法的分配律。想一想为什么叫内**积**？_
- 欲证：
$$
\begin{aligned}
\forall \mathbf{a}, \mathbf{b} \in V, &||\mathbf{a} \pm \mathbf{b}|| \leq ||\mathbf{a}|| + ||\mathbf{b}|| \\
\Leftrightarrow &(\mathbf{a} \pm \mathbf{b}, \mathbf{a} \pm \mathbf{b}) \leq (\mathbf{a}, \mathbf{a}) + 2 \sqrt{(\mathbf{a}, \mathbf{a}) (\mathbf{b}, \mathbf{b})} + (\mathbf{b}, \mathbf{b}) \\
\Leftrightarrow &\pm (\mathbf{a}, \mathbf{b}) \leq \sqrt{(\mathbf{a}, \mathbf{a}) (\mathbf{b}, \mathbf{b})} \\
\Leftrightarrow &|(\mathbf{a}, \mathbf{b})| \leq \sqrt{(\mathbf{a}, \mathbf{a}) (\mathbf{b}, \mathbf{b})}
\end{aligned}
$$

- _Motivation：仿照柯西不等式的证明。_
- 由正定性可知 $\forall \lambda \in \mathbb{R}, ||\mathbf{a} + \lambda \mathbf{b}|| \geq 0 \Leftrightarrow (\mathbf{b}, \mathbf{b}) \lambda^2 + 2 (\mathbf{a}, \mathbf{b}) \lambda + (\mathbf{a}, \mathbf{a}) \geq 0$。
- 故 $\Delta = (2(\mathbf{a}, \mathbf{b}))^2 - 4 (\mathbf{b}, \mathbf{b}) (\mathbf{a}, \mathbf{a}) \leq 0 \Leftrightarrow |(\mathbf{a}, \mathbf{b})| \leq \sqrt{(\mathbf{a}, \mathbf{a}) (\mathbf{b}, \mathbf{b})}$，遂得证。

#### 定义：夹角

对于内积空间 $V$ 上的 $\mathbf{a}, \mathbf{b} \neq \mathbf{0}$，定义 $\langle \mathbf{a}, \mathbf{b} \rangle = \arccos \dfrac{(\mathbf{a}, \mathbf{b})}{||\mathbf{a}|| \cdot ||\mathbf{b}||}$。

由于 $(\mathbf{a}, \mathbf{b}) \leq \sqrt{(\mathbf{a}, \mathbf{a}) (\mathbf{b}, \mathbf{b})}$，可知 $\dfrac{(\mathbf{a}, \mathbf{b})}{||\mathbf{a}|| \cdot ||\mathbf{b}||} \in [-1, 1]$，故上面定义的夹角的值域为 $[0, \pi]$。

特别地，当 $\langle \mathbf{a}, \mathbf{b} \rangle = 0$，有 $(\mathbf{a}, \mathbf{b}) = ||\mathbf{a}|| \cdot ||\mathbf{b}||$，令 $\lambda = -\dfrac{||\mathbf{a}||}{||\mathbf{b}||}$ 即得 $||\mathbf{a} + \lambda \mathbf{b}|| = 0$，有 $\mathbf{a} = -\lambda \mathbf{b} = \dfrac{||a||}{||b||} \cdot \mathbf{b}$，故 $\mathbf{a}, \mathbf{b}$ 共线。

#### 定义：向量的垂直 / 正交 Orthogonal

对于内积空间 $V$ 上的 $\mathbf{a}, \mathbf{b}$，定义 $\mathbf{a}, \mathbf{b}$ 垂直当且仅当 $(\mathbf{a}, \mathbf{b}) = 0$。

- 特别地，当 $\mathbf{a}, \mathbf{b}$ 之一为零，上面的定义仍给出 $\mathbf{a}, \mathbf{b}$ 垂直，这样定义的原因在于零向量的方向是任意的。

#### 定理（内积空间上的勾股定理）：内积空间 $V$ 上的 $\mathbf{a}, \mathbf{b}$ 垂直，当且仅当 $||\mathbf{a} + \mathbf{b}||^2 = ||\mathbf{a}||^2 + ||\mathbf{b}||^2$。

证明：

- $||\mathbf{a} + \mathbf{b}||^2 = (\mathbf{a}, \mathbf{a}) + (\mathbf{b}, \mathbf{b}) + 2 (\mathbf{a}, \mathbf{b}), ||\mathbf{a}||^2 + ||\mathbf{b}||^2 = (\mathbf{a}, \mathbf{a}) + (\mathbf{b}, \mathbf{b})$。
- 故 $||\mathbf{a} + \mathbf{b}||^2 = ||\mathbf{a}||^2 + ||\mathbf{b}||^2 \Leftrightarrow (\mathbf{a}, \mathbf{b}) = 0 \Leftrightarrow \mathbf{a}, \mathbf{b}$ 垂直。

#### 定义：向量到向量的投影 Projection

考虑怎样对非零的 $\mathbf{b}$ 定义“$\mathbf{a}$ 投影在 $\mathbf{b}$ 上”的结果：

- 只要 $\lambda \neq 0$（不丢失方向信息），$\mathbf{a}$ 在 $\mathbf{b}$ 上的投影应当与 $\mathbf{a}$ 在 $\lambda \mathbf{b}$ 上的投影一致。
- $\mathbf{a}$ 在 $\mathbf{b}$ 上的投影乘上 $\lambda$ 应当与 $\lambda \mathbf{a}$ 在 $\mathbf{b}$ 上的投影一致。

------

对内积空间 $V$ 上的 $\mathbf{a}, \mathbf{b}$，当 $\mathbf{b} \neq \mathbf{0}$，定义 $\mathbf{a}$ 在 $\mathbf{b}$ 上的投影**向量** $\mathbb{P}_{\mathbf{b}}(\mathbf{a}) = \dfrac{(\mathbf{a}, \mathbf{b})}{|\mathbf{b}|} \cdot \dfrac{\mathbf{b}}{|\mathbf{b}|} = (\mathbf{a}, \dfrac{\mathbf{b}}{|\mathbf{b}|^2}) \mathbf{b}$，又记作 $\mathbf{a}_{\mathbf{b}}^{\parallel}$。在此基础上，令 $\mathbf{a}_{\mathbf{b}}^{\perp} = \mathbf{a} - \mathbf{a}_{\mathbf{b}}^{\parallel}$。易证 $\mathbf{a}_{\mathbf{b}}^{\parallel} \parallel \mathbf{b}, \mathbf{a}_{\mathbf{b}}^{\perp} \perp \mathbf{b}$。

#### 定义：直线的垂直 / 正交

称 $L(A; \mathbf{a}), L(B, \mathbf{b})$ 垂直 / 正交，若 $\mathbf{a}, \mathbf{b}$ 正交。

- 这里“直线”的表述隐含了 $\mathbf{a}, \mathbf{b} \neq \mathbf{0}$。

#### 定义：向量和直线与平面的垂直

称 $\mathbf{a}, \Pi (O; \mathbf{b}, \mathbf{c})$ 垂直，若前者与后者上的每个向量（任意两点间连线）都垂直。

称 $L(A; \mathbf{a}), \Pi (O; \mathbf{b}, \mathbf{c})$ 垂直，若前者与后者上的每一条线都垂直。

#### 定理（线面垂直的判定）：$L(A; \mathbf{a}) \perp \Pi (O; \mathbf{b}, \mathbf{c})$ 当且仅当 $\exists \Pi (O; \mathbf{b}, \mathbf{c})$ 上的不共线向量 $\mathbf{x}, \mathbf{y}, \text{s.t. } \mathbf{a} \perp \mathbf{x}, \mathbf{a} \perp \mathbf{y}$。

证明：

- 必要性：由定义易知。
- 充分性：$\forall L (O'; \mathbf{d}) \subset \Pi (O; \mathbf{b}, \mathbf{c})$，首先显然有 $\Pi (O; \mathbf{b}, \mathbf{c}) = \Pi (O'; \mathbf{x}, \mathbf{y})$ 且 $\mathbf{d}$ 非零。
- 于是 $\exists \lambda, \mu \in \mathbb{R}, \text{s.t. } \mathbf{d} = \lambda \mathbf{x} + \mu \mathbf{y}$。
- 由 $L(A; \mathbf{a}) \perp \mathbf{x}, L(A; \mathbf{a}) \perp \mathbf{y}$ 可知 $(\mathbf{a}, \mathbf{x}) = (\mathbf{a}, \mathbf{y}) = 0$。
- 故 $(\mathbf{a}, \mathbf{d}) = \lambda (\mathbf{a}, \mathbf{x}) + \mu (\mathbf{a}, \mathbf{y}) = 0$，又由 $\mathbf{d}$ 非零可知 $L(A; \mathbf{a}) \perp L(O'; \mathbf{d})$。
- 由 $L(O'; \mathbf{d})$ 的任意性和线面垂直的定义可知 $L(A; \mathbf{a}) \perp \Pi (O; \mathbf{b}, \mathbf{c})$。

对于向量与平面的垂直，我们有类似的判定定理。

#### 定义：到平面的投影

对于内积空间中一点 $A$，称其在 $\Pi (O; \mathbf{b}, \mathbf{c})$ 上的投影为 $A'$，若 $\overrightarrow{AA'} \perp \Pi (O; \mathbf{b}, \mathbf{c})$。

若 $A'$ 存在，则其唯一性显然。但是，如何证明 $A'$ 的存在性呢？

- 当 $A \in \Pi (O; \mathbf{b}, \mathbf{c})$，令 $A' = A$ 即可。
- 否则，令 $\mathbf{a} = \overrightarrow{AO}$，则 $\mathbf{a}$ 不在 $\Pi (O; \mathbf{b}, \mathbf{c})$ 上。
- 我们期待找出 $x, y \in \mathbb{R}$，使得 $(\mathbf{a} - x \mathbf{b} - y \mathbf{c}) \perp \Pi (O; \mathbf{b}, \mathbf{c})$，如此便可通过 $\overrightarrow{AA'} = \mathbf{a} - x \mathbf{b} - y \mathbf{c}$ 给出满足条件的 $A'$。
- 我们要求 $\begin{cases} (\mathbf{a} - x \mathbf{b} - y \mathbf{c}) \perp \mathbf{b} \\ (\mathbf{a} - x \mathbf{b} - y \mathbf{c}) \perp \mathbf{c} \end{cases} \Leftrightarrow \begin{cases} x (\mathbf{b}, \mathbf{b}) + y (\mathbf{c}, \mathbf{b}) = (\mathbf{a}, \mathbf{b}) \\ x (\mathbf{b}, \mathbf{c}) + y (\mathbf{c}, \mathbf{c}) = (\mathbf{a}, \mathbf{c}) \end{cases}$。
- 由于 $\begin{vmatrix} (\mathbf{b}, \mathbf{b}) & (\mathbf{c}, \mathbf{b}) \\ (\mathbf{b}, \mathbf{c}) & (\mathbf{c}, \mathbf{c}) \end{vmatrix} = (\mathbf{b}, \mathbf{b}) (\mathbf{c}, \mathbf{c}) - (\mathbf{b}, \mathbf{c})^2 > 0$（由于 $\mathbf{b}, \mathbf{c}$ 不共线，无法取等），可得以上关于 $x, y$ 的二元一次方程有唯一解，因此满足条件的 $A'$ 存在。

对于内积空间中一直线 $L(A; \mathbf{a})$，称其在 $\Pi (O; \mathbf{b}, \mathbf{c})$ 上的投影为 $\{P' \mid P \in L(A, \mathbf{a}), \overrightarrow{PP'} \perp \Pi (O; \mathbf{b}, \mathbf{c})\}$。

当 $L(A, \mathbf{a}) \perp \Pi (O; \mathbf{b}, \mathbf{c})$，投影为单点集；否则，投影为一条直线 $L(A'; \mathbf{a}')$。

#### 定理（内积空间上的余弦定理）：$||\mathbf{a} - \mathbf{b}||^2 = ||\mathbf{a}||^2 + ||\mathbf{b}||^2 - 2 ||\mathbf{a}|| \cdot ||\mathbf{b}|| \cos \langle \mathbf{a}, \mathbf{b} \rangle$。

证明略。

#### 垂心

- **“坐标系”的抽象：我们不想去关心具体的“坐标”状物这样的 "dirty work"，反而是更期待利用内积的性质。**

考察三角形 $\Delta ABC$，从 $B$ 出发向 $AC$ 作垂线、从 $C$ 出发向 $AB$ 作垂线，两者交于 $H$。

- 事实上还需要说明 $H$ 存在，即两条垂线不相平行。这里略去过程。

以 $H$ 为原点建立坐标系，设 $A, B, C$ 的矢径分别为 $\mathbf{a}, \mathbf{b}, \mathbf{c}$，则：

- $BH \perp AC \Leftrightarrow (\mathbf{b}, \mathbf{a} - \mathbf{c}) = 0 \Leftrightarrow (\mathbf{b}, \mathbf{a}) = (\mathbf{b}, \mathbf{c})$。
- $CH \perp AB \Leftrightarrow (\mathbf{c}, \mathbf{a} - \mathbf{b}) = 0 \Leftrightarrow (\mathbf{c}, \mathbf{a}) = (\mathbf{c}, \mathbf{b})$。

而我们只需证明 $AH \perp BC \Leftrightarrow (\mathbf{a}, \mathbf{b} - \mathbf{c}) \Leftrightarrow (\mathbf{a}, \mathbf{b}) = (\mathbf{a}, \mathbf{c})$。

由内积的对称性和上面的两个等式可知 $(\mathbf{a}, \mathbf{b}) = (\mathbf{b}, \mathbf{a}) = (\mathbf{b}, \mathbf{c}) = (\mathbf{c}, \mathbf{b}) = (\mathbf{c}, \mathbf{a}) = (\mathbf{a}, \mathbf{c})$，遂得证。

#### 角平分线定理

考察三角形 $\Delta ABC$，作角 $A$ 的平分线交 $BC$ 于 $D$。

- _Motivation：我们想要方便地表出 $\overrightarrow{AB}, \overrightarrow{AC}, \overrightarrow{AD}$，这样就好表示角度了。_

以 $A$ 为原点建立坐标系，设 $B, C$ 的矢径分别为 $\mathbf{b}, \mathbf{c}$。

由于 $D$ 在 $B, C$ 之间，考虑定比分点。设 $|\overrightarrow{BD}| : |\overrightarrow{DC}| = \lambda : (1 - \lambda)$，则其矢径为 $\mathbf{d} = (1 - \lambda) \mathbf{b} + \lambda \mathbf{c}$。

由角平分线的定义可知：

$$
\begin{aligned}
&\langle \mathbf{b}, \mathbf{d} \rangle = \langle \mathbf{c}, \mathbf{d} \rangle \\
\Leftrightarrow &\dfrac{(\mathbf{b}, \mathbf{d})}{||\mathbf{b}|| \cdot ||\mathbf{d}||} = \dfrac{(\mathbf{c}, \mathbf{d})}{||\mathbf{c}|| \cdot ||\mathbf{d}||} \\
\Leftrightarrow &\dfrac{(\mathbf{b}, (1 - \lambda) \mathbf{b} + \lambda \mathbf{c})}{||\mathbf{b}||} = \dfrac{(\mathbf{c}, (1 - \lambda) \mathbf{b} + \lambda \mathbf{c})}{||\mathbf{c}||} \\
\Leftrightarrow &(||\mathbf{b}|| \cdot ||\mathbf{c}|| - (\mathbf{b}, \mathbf{c})) ((1 - \lambda) ||\mathbf{b}|| - \lambda ||\mathbf{c}||) = 0
\end{aligned}
$$

由 $AB, AC$ 不共线可知 $||\mathbf{b}|| \cdot ||\mathbf{c}|| - (\mathbf{b}, \mathbf{c}) \neq 0$，故 $(1 - \lambda) ||\mathbf{b}|| - \lambda ||\mathbf{c}|| = 0$。

于是 $\dfrac{|AB|}{|AC|} = \dfrac{||\mathbf{b}||}{||\mathbf{c}||} = \dfrac{\lambda}{1 - \lambda} = \dfrac{|BD|}{|DC|}$，遂得证。

#### 三垂线定理

内容：若 $L(C; \mathbf{c}) \subset \Pi (O; \mathbf{a}, \mathbf{b})$，将 $L(D; \mathbf{d}) \not\subset \Pi (O; \mathbf{a}, \mathbf{b})$ 投影到 $\Pi (O; \mathbf{a}, \mathbf{b})$ 上得到 $L(D'; \mathbf{d}')$，则 $L(C; \mathbf{c}) \perp L(D, \mathbf{d}) \Leftrightarrow L(C; \mathbf{c}) \perp L(D', \mathbf{d}')$。

证明：在平面上和垂直于平面两个方向分解向量即可，略。

#### 外心

考察三角形 $\Delta ABC$，作 $AB, AC$ 的中垂线交于 $O$。

- 跟前面一样，需要说明 $H$ 存在。这里仍略去过程。

以 $O$ 为原点建立坐标系，设 $A, B, C$ 的矢径分别为 $\mathbf{a}, \mathbf{b}, \mathbf{c}$，于是 $AB, AC, BC$ 的中点 $D, E, F$ 的矢径分别为 $\dfrac{\mathbf{a} + \mathbf{b}}{2}, \dfrac{\mathbf{a} + \mathbf{c}}{2}, \dfrac{\mathbf{b} + \mathbf{c}}{2}$，则：

- $DO \perp AB \Leftrightarrow (\dfrac{\mathbf{a} + \mathbf{b}}{2}, \mathbf{a} - \mathbf{b}) = 0 \Leftrightarrow ||\mathbf{a}|| = ||\mathbf{b}||$。
- $EO \perp AC \Leftrightarrow (\dfrac{\mathbf{a} + \mathbf{c}}{2}, \mathbf{a} - \mathbf{c}) = 0 \Leftrightarrow ||\mathbf{a}|| = ||\mathbf{c}||$。

因此 $||\mathbf{b}|| = ||\mathbf{a}|| = ||\mathbf{c}||$，同上可推知 $FO \perp BC$，遂得证。

#### 内积空间中的仿射坐标系

##### 度量阵

对于内积空间 $V$ 上的 $\mathbf{a}, \mathbf{b}$，设 $\mathbf{a} = a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3, \mathbf{b} = b_1 \mathbf{e}_1 + b_2 \mathbf{e}_2 + b_3 \mathbf{e}_3$，则由**线性性**可知 $(\mathbf{a}, \mathbf{b}) = \displaystyle\sum_{i = 1}^3 \sum_{j = 1}^3 a_i \cdot (\mathbf{e}_i, \mathbf{e}_j) \cdot b_j$。

- _Motivation：诶，这个不是枚举路径 $(1 \to) i \to j (\to 1)$ 吗？_

注意到该内积还可以被这样表出：

$$
(\mathbf{a}, \mathbf{b}) = \begin{bmatrix} a_1 & a_2 & a_3 \end{bmatrix} \begin{bmatrix} (\mathbf{e}_1, \mathbf{e}_1) & (\mathbf{e}_1, \mathbf{e}_2) & (\mathbf{e}_1, \mathbf{e}_3) \\ (\mathbf{e}_2, \mathbf{e}_1) & (\mathbf{e}_2, \mathbf{e}_2) & (\mathbf{e}_2, \mathbf{e}_3) \\ (\mathbf{e}_3, \mathbf{e}_1) & (\mathbf{e}_3, \mathbf{e}_2) & (\mathbf{e}_3, \mathbf{e}_3) \end{bmatrix} \begin{bmatrix} b_1 \\ b_2 \\ b_3 \end{bmatrix}
$$

可以发现该仿射坐标系中坐标与内积的关系由中间这个 $3 \times 3$ 的矩阵决定。我们称之为度量阵，记作 $\mathbf{G}$。

- Fun Fact：内积空间的“自由度”不会超过 $\mathbb{R}^6$（当然，对“内积”的要求会给出额外的限制）。

##### 单位正交基

当 $\mathbf{G} = \mathbf{I}_3$，我们便回到了**基向量正交且均为单位长度**的情况，也就是高中时我们在立体几何问题中所建的空间直角坐标系。我们称这样的一组基为单位正交基。

- 注：从“内积”的角度我们看不出高中立体几何中所谓“右手系”和“左手系”的差别。~~但是别急，很快就知道了。~~

取单位正交基时，我们常将坐标系记作 $\{O; \mathbf{i}, \mathbf{j}, \mathbf{k}\}$。此时，$\mathbf{a} = x_a \mathbf{i} + y_a \mathbf{j} + z_a \mathbf{k}$ 和 $\mathbf{b} = x_b \mathbf{i} + y_b \mathbf{j} + z_b \mathbf{k}$ 的内积形如：

$$
(\mathbf{a}, \mathbf{b}) = \begin{bmatrix} x_a & y_a & z_a \end{bmatrix} \begin{bmatrix} x_b \\ y_b \\ z_b \end{bmatrix} = x_a x_b + y_a y_b + z_a z_b
$$

此时诱导出的范数为：

$$
||\mathbf{a}|| = \sqrt{(\mathbf{a}, \mathbf{a})} = \sqrt{x_a^2 + y_a^2 + z_a^2}
$$

可以发现这正是三维代数向量的**欧氏范数** $||(x_a, y_a, z_a)||_E$。

在这样的坐标系下，称 $\alpha = \langle \mathbf{a}, \mathbf{i} \rangle, \beta = \langle \mathbf{a}, \mathbf{j} \rangle, \gamma = \langle \mathbf{a}, \mathbf{k} \rangle$ 为其三个方向余弦。

#### 定义：标架 Frame、过渡阵与定向

在三维空间 $V$ 上，定义一组**规定顺序**的基向量为一个标架。

考察在不同标架确定的坐标系间的向量坐标变换，不难发现这等价于乘上了一个矩阵。

具体地说，对于标架 $\mathbf{E} = (\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3)$ 和 $\mathbf{F} = (\mathbf{f}_1, \mathbf{f}_2, \mathbf{f}_3)$，设后者用前者的表示为：

$$
\begin{cases}
\mathbf{f}_1 &= t_{1, 1} \mathbf{e}_1 + t_{2, 1} \mathbf{e}_2 + t_{3, 1} \mathbf{e}_3 \\
\mathbf{f}_2 &= t_{1, 2} \mathbf{e}_1 + t_{2, 2} \mathbf{e}_2 + t_{3, 2} \mathbf{e}_3 \\
\mathbf{f}_3 &= t_{1, 3} \mathbf{e}_1 + t_{2, 3} \mathbf{e}_2 + t_{3, 3} \mathbf{e}_3
\end{cases}
$$

如果允许将几何向量放进行向量并与 $\mathbb{R}^{3 \times 3}$ 做矩阵乘法，可得：

$$
\begin{bmatrix} \mathbf{e}_1 & \mathbf{e}_2 & \mathbf{e}_3 \end{bmatrix}
\begin{bmatrix}
t_{1, 1} & t_{1, 2} & t_{1, 3} \\
t_{2, 1} & t_{2, 2} & t_{2, 3} \\
t_{3, 1} & t_{3, 2} & t_{3, 3}
\end{bmatrix}
= \begin{bmatrix} \mathbf{f}_1 & \mathbf{f}_2 & \mathbf{f}_3 \end{bmatrix}
$$

此时称 $\mathbf{T}_{\mathbf{E}, \mathbf{F}} = (t_{i, j})_{3 \times 3}$ 为从 $\mathbf{E}$ 到 $\mathbf{F}$ 的过渡阵，它显然是可逆的。

- _Motivation：我们希望用一种自然的方式区分所谓“右手系”与“左手系”，但基于几何直观定义的“右”“左”是“人工”而非“自然”的。有没有一种相对“自然”的、将代数对象一分为二的方式？_

考虑在标架集上定义**等价关系**：

- 标架 $\mathbf{A}, \mathbf{B}$ 定向相同，当且仅当 $|\mathbf{T}_{\mathbf{A}, \mathbf{B}}| > 0$。

证明：

- (1) 自反性：$|\mathbf{T}_{\mathbf{A}, \mathbf{B}}| = |\mathbf{I}_3| = 1 > 0$。
- (2) 对称性：$\mathbf{T}_{\mathbf{A}, \mathbf{B}} \mathbf{T}_{\mathbf{B}, \mathbf{A}} = \mathbf{I}_3 \Rightarrow |\mathbf{T}_{\mathbf{A}, \mathbf{B}}| |\mathbf{T}_{\mathbf{B}, \mathbf{A}}| = 1 > 0$，故 $|\mathbf{T}_{\mathbf{A}, \mathbf{B}}| > 0 \Leftrightarrow |\mathbf{T}_{\mathbf{B}, \mathbf{A}}| > 0$。
- (3) 传递性：$|\mathbf{T}_{\mathbf{A}, \mathbf{B}}|, |\mathbf{T}_{\mathbf{B}, \mathbf{C}}| > 0 \Rightarrow |\mathbf{T}_{\mathbf{A}, \mathbf{C}}| = |\mathbf{T}_{\mathbf{A}, \mathbf{B}} \mathbf{T}_{\mathbf{B}, \mathbf{C}}| = |\mathbf{T}_{\mathbf{A}, \mathbf{B}}| |\mathbf{T}_{\mathbf{B}, \mathbf{C}}| > 0$。~~`deriving determinant`~~

任取标架 $\mathbf{E}_+ = (\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3)$，令 $\mathbf{E}_- = (-\mathbf{e}_1, -\mathbf{e}_2, -\mathbf{e}_3)$，则 $\mathbf{E}_+, \mathbf{E}_-$ 不属于同一等价类。

不难发现任取标架 $\mathbf{F}$，它要么与 $\mathbf{E}_+$ 属于同一等价类，要么与 $\mathbf{E}_-$ 属于同一等价类。因此，我们将标架集一分为二，得到的两个等价类各自称为一种定向。

- “右手系”只需表述为“与右手确定的某个标架具有同一定向的标架给出的仿射坐标系”，它无关数学结构本身，因此定义本身是“干净”的。

#### 定义：外积 Exterior / Wedge Product

在内积空间 $V$ 上，**选定标架** $\mathbf{F}$，定义外积为一个函数 $V \times V \to V$，记作 $\mathbf{a} \times \mathbf{b}$，满足：

- (1) 长度：$||\mathbf{a} \times \mathbf{b}|| = ||\mathbf{a}|| \cdot ||\mathbf{b}|| \cdot \sin \langle \mathbf{a}, \mathbf{b} \rangle$。
- (2) 方向 I：$\mathbf{a} \times \mathbf{b}$ 与 $\mathbf{a}, \mathbf{b}$ 正交。
- (3) 方向 II（“向上还是向下”）：当 $\mathbf{a}, \mathbf{b}$ 不共线，$(\mathbf{a}, \mathbf{b}, \mathbf{a} \times \mathbf{b})$ 与 $\mathbf{F}$ 定向一致。

显然有：当 $\mathbf{a}, \mathbf{b}$ 共线，$\mathbf{a} \times \mathbf{b} = \mathbf{0}$。

#### 外积的性质

几何上，外积的长度恰为以 $\mathbf{a}, \mathbf{b}$ 为两边的平行四边形的面积。

代数上，其还具有如下性质：

- (1) **反**对称性：$\mathbf{a} \times \mathbf{b} = -(\mathbf{b} \times \mathbf{a})$。
- (2) 线性性：$(\lambda \mathbf{a} + \mu \mathbf{b}) \times \mathbf{c} = \lambda (\mathbf{a} \times \mathbf{c}) + \mu (\mathbf{b} \times \mathbf{c})$。

为证明以上性质，引入仿射坐标系 $\{O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$，考察坐标表示的向量的外积：

- 对于向量 $\mathbf{a} = a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3, \mathbf{b} = b_1 \mathbf{e}_1 + b_2 \mathbf{e}_2 + b_3 \mathbf{e}_3$，有：

$$
\begin{aligned}
\mathbf{a} \times \mathbf{b} &= (a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3) \times (b_1 \mathbf{e}_1 + b_2 \mathbf{e}_2 + b_3 \mathbf{e}_3) \\
&= (a_1 b_1) (\mathbf{e}_1 \times \mathbf{e}_1) + (a_1 b_2 - a_2 b_1) (\mathbf{e}_1 \times \mathbf{e}_2) + (a_1 b_3 - a_3 b_1) (\mathbf{e}_1 \times \mathbf{e}_3) + (a_2 b_2) (\mathbf{e}_2 \times \mathbf{e}_2) + (a_2 b_3 - a_3 b_2) (\mathbf{e}_2 \times \mathbf{e}_3) + (a_3 b_3) (\mathbb{e}_3 \times \mathbb{e}_3) \\
&= \begin{vmatrix} a_2 & a_3 \\ b_2 & b_3 \end{vmatrix} (\mathbf{e}_2 \times \mathbf{e}_3) - \begin{vmatrix} a_1 & a_3 \\ b_1 & b_3 \end{vmatrix} (\mathbf{e}_3 \times \mathbf{e}_1) + \begin{vmatrix} a_1 & a_2 \\ b_1 & b_2 \end{vmatrix} (\mathbf{e}_1 \times \mathbf{e}_2) \\
&\equiv \begin{vmatrix} \mathbf{e}_2 \times \mathbf{e}_3 & \mathbf{e}_3 \times \mathbf{e}_1 & \mathbf{e}_1 \times \mathbf{e}_2 \\ a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \end{vmatrix}
\end{aligned}
$$

- 注意：这里最后一行仅为记号，而非真正的行列式。~~这样写只是因为它确实跟真正的行列式挺像。~~

易证在不同仿射坐标系下，上述表达式给出的外积结果是一致的，这也验证了外积的定义不依赖于坐标系的选取。

- **注意区分用于定向的标架和用于计算的坐标系！**

在此基础上 `deriving determinant` 即可。

#### 定义：右手系与左手系

在三维空间 $V$ 上，对于标架 $\mathbf{F}$ 导出的外积 $\times$，在**单位正交基**确定的仿射坐标系 $\{O; \mathbf{i}, \mathbf{j}, \mathbf{k}\}$ 下，易知 $\mathbf{i} \times \mathbf{j} = \pm \mathbf{k}$。

称该坐标系为右手系，若 $\mathbf{i} \times \mathbf{j} = \mathbf{k}$；反之，称其为左手系，若 $\mathbf{i} \times \mathbf{j} = -\mathbf{k}$。

下面讨论右手系的一些基本性质，左手系同理而略之。

我们可以给出与 $\mathbf{i} \times \mathbf{j} = \mathbf{k}$ 对称的 $\mathbf{j} \times \mathbf{k} = \mathbf{i}, \mathbf{k} \times \mathbf{i} = \mathbf{j}$。下面证明前者：

- 设 $\mathbf{j} \times \mathbf{k} = c \mathbf{i}$，其中 $c \in \{-1, 1\}$。
- 由 $\mathbf{i} \times \mathbf{j} = \mathbf{k}$ 有 $\mathbf{j} \times \mathbf{i} = -\mathbf{k}$，与 $\mathbf{j} \times \mathbf{k} = c \mathbf{i}$ 相加可得 $\mathbf{j} \times (\mathbf{i} + \mathbf{k}) = c \mathbf{i} - \mathbf{k}$。
- 若 $c = -1$，则 $\mathbf{j} \times (\mathbf{i} + \mathbf{k}) = -(\mathbf{i} + \mathbf{k})$，但由 $\mathbf{i} + \mathbf{k} \neq \mathbf{0}$ 可知 $(\mathbf{i} + \mathbf{k}) \not\perp -(\mathbf{i} + \mathbf{k})$，与 (4) 矛盾。
- 故有 $c = 1$，即 $\mathbf{j} \times \mathbf{k} = \mathbf{i}$。

在此基础上，对于向量 $\mathbf{a} = x_a \mathbf{i} + y_a \mathbf{j} + z_a \mathbf{k}, \mathbf{b} = x_b \mathbf{i} + y_b \mathbf{j} + z_b \mathbf{k}$，有：

$$
\begin{aligned}
\mathbf{a} \times \mathbf{b} &= \begin{vmatrix} y_a & z_a \\ y_b & z_b \end{vmatrix} \mathbf{i} - \begin{vmatrix} x_a & z_a \\ x_b & z_b \end{vmatrix} \mathbf{j} + \begin{vmatrix} x_a & y_a \\ x_b & y_b \end{vmatrix} \mathbf{k} \\
&\equiv \begin{vmatrix} \mathbf{i} & \mathbf{j} & \mathbf{k} \\ x_a & y_a & z_a \\ x_b & y_b & z_b \end{vmatrix}
\end{aligned}
$$

#### 定义：混合积 Mixed Product

在内积空间 $V$ 上，对于标架 $\mathbf{F}$ 导出的外积 $\times$，定义混合积为一个函数 $V \times V \times V \to \mathbb{R}$，记作 $(\mathbf{a}, \mathbf{b}, \mathbf{c})$，满足 $(\mathbf{a}, \mathbf{b}, \mathbf{c}) = (\mathbf{a} \times \mathbf{b}) \cdot \mathbf{c}$。

#### 混合积的性质

几何上，混合积的绝对值恰为以 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 为三边的平行六面体的体积。

代数数，其还具有以下性质：

- (1) 对换**反**对称性：$(\mathbf{a}, \mathbf{b}, \mathbf{c}) = -(\mathbf{b}, \mathbf{a}, \mathbf{c})$。
- (2) 轮换对称性：$(\mathbf{a}, \mathbf{b}, \mathbf{c}) = (\mathbf{b}, \mathbf{c}, \mathbf{a}) = (\mathbf{c}, \mathbf{a}, \mathbf{b})$。
- (3) 线性性：$(\lambda \mathbf{a} + \mu \mathbf{b}, \mathbf{c}, \mathbf{d}) = \lambda (\mathbf{a}, \mathbf{c}, \mathbf{d}) + \mu (\mathbf{b}, \mathbf{c}, \mathbf{d})$，对另外两个参数同样也有线性性。~~`deriving ×, ·`~~
- (4) 消零性：$(\mathbf{a}, \mathbf{a}, \mathbf{b}) = 0$。

(1)(3)(4) 的证明是显然的。

为证明 (2)，在内积空间 $V$ 上，对于标架 $\mathbf{F}$ 导出的外积 $\times$，考察**右手系** $\{O; \mathbf{i}, \mathbf{j}, \mathbf{k}\}$ 下，坐标表示的向量的混合积：

- 对于向量 $\mathbf{a} = x_a \mathbf{i} + y_a \mathbf{j} + z_a \mathbf{k}, \mathbf{b} = x_b \mathbf{i} + y_b \mathbf{j} + z_b \mathbf{k}, \mathbf{c} = x_c \mathbf{i} + y_c \mathbf{j} + z_c \mathbf{k}$，有：

$$
\begin{aligned}
(\mathbf{a}, \mathbf{b}, \mathbf{c}) &= ((\mathbf{a} \times \mathbf{b}), \mathbf{c}) \\
&= (\begin{vmatrix} y_a & z_a \\ y_b & z_b \end{vmatrix}, \begin{vmatrix} z_a & x_a \\ z_b & x_b \end{vmatrix}, \begin{vmatrix} x_a & y_a \\ x_b & y_b \end{vmatrix}) \cdot (x_c, y_c, z_c) \\
&= \begin{vmatrix} y_a & z_a \\ y_b & z_b \end{vmatrix} x_c + \begin{vmatrix} z_a & x_a \\ z_b & x_b \end{vmatrix} y_c + \begin{vmatrix} x_a & y_a \\ x_b & y_b \end{vmatrix} z_c \\
&= \begin{vmatrix} x_c & y_c & z_c \\ x_a & y_a & z_a \\ x_b & y_b & z_b \end{vmatrix} \\
&= \begin{vmatrix} x_a & y_a & z_a \\ x_b & y_b & z_b \\ x_c & y_c & z_c \end{vmatrix} \\
\end{aligned}
$$

在此基础上 `deriving determinant` 即可。

作为 (3) + (4) 或上面给出的行列式表示的直接推论，可以发现 $(\mathbf{a}, \mathbf{b}, \mathbf{c}) = 0$ 当且仅当 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 共面，这为我们提供了一种判定共面的依据。

#### 定理：海伦 Heron 公式

- _Motivation：展开面积平方（即外积平方）的计算式涉及邻边向量的内积，余弦定理同样涉及邻边向量内积的余弦定理。_

由外积的几何意义可得：

$$
\begin{aligned}
(2 S_{\Delta ABC})^2 &= ||\overrightarrow{AB} \times \overrightarrow{AC}||^2 \\
&= ||\overrightarrow{AB}||^2 ||\overrightarrow{AC}||^2 \sin^2 \angle A \\
&= ||\overrightarrow{AB}||^2 ||\overrightarrow{AC}||^2 - (\overrightarrow{AB}, \overrightarrow{AC})^2 \\
&= b^2 c^2 - (\dfrac{b^2 + c^2 - a^2}{2})^2 \\
&= (bc - \dfrac{b^2 + c^2 - a^2}{2}) (bc + \dfrac{b^2 + c^2 - a^2}{2}) \\
&= \dfrac{1}{4} (a^2 - (b - c)^2) ((b + c)^2 - a^2) \\
&= \dfrac{1}{4} (a + b - c) (a - b + c) (b + c - a) (a + b + c)
\end{aligned}
$$

令 $p = \dfrac{1}{2} (a + b + c)$，则：

$$
\begin{aligned}
&(2 S_{\Delta ABC})^2 = \dfrac{1}{4} \cdot (2p - 2c) \cdot (2p - 2b) \cdot (2p - 2a) \cdot 2p \\
\Rightarrow &S_{\Delta ABC} = \sqrt{p (p - a) (p - b) (p - c)}
\end{aligned}
$$

#### 正弦定理

内容：在 $\Delta ABC$ 中，$\dfrac{a}{\sin \angle A} = \dfrac{b}{\sin \angle B} = \dfrac{c}{\sin \angle C}$。

证明：

- 只需证明后面两者相等，然后同理可得前面两者相等。
- 考察邻边向量的外积 $\overrightarrow{AB} \times \overrightarrow{AC} = \overrightarrow{AB} \times (\overrightarrow{AB} + \overrightarrow{BC}) = \overrightarrow{AB} \times \overrightarrow{BC} = -\overrightarrow{BA} \times \overrightarrow{BC}$。
- 故有 $||\overrightarrow{AB} \times \overrightarrow{AC}|| = ||\overrightarrow{BA} \times \overrightarrow{BC}||$，展开可得 $cb \sin \angle A = ca \sin \angle{B}$。
- 化简即得 $\dfrac{a}{\sin \angle A} = \dfrac{b}{\sin \angle B}$。

#### 混合积的应用：求仿射坐标系下的坐标

现有右手系 $\{O; \mathbf{i}, \mathbf{j}, \mathbf{k}\}$ 和该系下的 $\mathbf{a} = x_a \mathbf{i} + y_a \mathbf{j} + z_a \mathbf{k}$，我们想要求出其在 $\{O'; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 下的坐标 $\mathbf{a} = a_1 \mathbf{e}_1 + a_2 \mathbf{e}_2 + a_3 \mathbf{e}_3$。

若已知：

$$
\begin{cases}
\mathbf{e}_1 = e_{1, 1} \mathbf{i} + e_{1, 2} \mathbf{j} + e_{1, 3} \mathbf{k} \\
\mathbf{e}_2 = e_{2, 1} \mathbf{i} + e_{2, 2} \mathbf{j} + e_{2, 3} \mathbf{k} \\
\mathbf{e}_3 = e_{3, 1} \mathbf{i} + e_{3, 2} \mathbf{j} + e_{3, 3} \mathbf{k}
\end{cases}
$$

一个最暴躁的想法是解线性方程组：

$$
\begin{bmatrix}
e_{1, 1} & e_{2, 1} & e_{3, 1} \\
e_{1, 2} & e_{2, 2} & e_{3, 2} \\
e_{1, 3} & e_{2, 3} & e_{3, 3}
\end{bmatrix}
\begin{bmatrix}
a_1 \\
a_2 \\
a_3
\end{bmatrix}
= \begin{bmatrix}
x_a \\
y_a \\
z_a
\end{bmatrix}
$$

由 Cramer 法则可知：

$$
\begin{cases}
a_1 = \dfrac{\begin{bmatrix} x_a & e_{2, 1} & e_{3, 1} \\ y_a & e_{2, 2} & e_{3, 2} \\ z_a & e_{2, 3} & e_{3, 3} \end{bmatrix}}{\begin{bmatrix} e_{1, 1} & e_{2, 1} & e_{3, 1} \\ e_{1, 2} & e_{2, 2} & e_{3, 2} \\ e_{1, 3} & e_{2, 3} & e_{3, 3} \end{bmatrix}} \\
a_2 = \dfrac{\begin{bmatrix} e_{1, 1} & x_a & e_{3, 1} \\ e_{1, 2} & y_a & e_{3, 2} \\ e_{1, 3} & z_a & e_{3, 3} \end{bmatrix}}{\begin{bmatrix} e_{1, 1} & e_{2, 1} & e_{3, 1} \\ e_{1, 2} & e_{2, 2} & e_{3, 2} \\ e_{1, 3} & e_{2, 3} & e_{3, 3} \end{bmatrix}} \\
a_3 = \dfrac{\begin{bmatrix} e_{1, 1} & e_{2, 1} & x_a \\ e_{1, 2} & e_{2, 2} & y_a \\ e_{1, 3} & e_{2, 3} & z_a \end{bmatrix}}{\begin{bmatrix} e_{1, 1} & e_{2, 1} & e_{3, 1} \\ e_{1, 2} & e_{2, 2} & e_{3, 2} \\ e_{1, 3} & e_{2, 3} & e_{3, 3} \end{bmatrix}}
\end{cases}
$$

与此同时，我们可以采取另一个视角：

- 注意到 $(\mathbf{a}, \mathbf{e}_2, \mathbf{e}_3) = a_1 (\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3) + a_2 (\mathbf{e}_2, \mathbf{e}_2, \mathbf{e}_3) + a_3 (\mathbf{e}_3, \mathbf{e}_2, \mathbf{e}_3) + a_1 (\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3)$。
- 故 $a_1 = \dfrac{(\mathbf{a}, \mathbf{e}_2, \mathbf{e}_3)}{(\mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3)}$，利用混合积的行列式形式展开后即得上面的结果。
- $a_2, a_3$ 的计算是同理的。

#### 定义：复合积

在内积空间 $V$ 上，对于标架 $\mathbf{F}$ 导出的外积 $\times$，称 $(\mathbf{a} \times \mathbf{b}) \times \mathbf{c}$ 为复合积。

- **注意：外积没有交换律和结合律！**

#### 复合积的性质

由于 $\mathbf{a}, \mathbf{b}$ 与 $\mathbf{a} \times \mathbf{b}$ 垂直，上述复合积也与 $\mathbf{a}, \mathbf{b}$ 垂直，故 $\mathbf{a}, \mathbf{b}, (\mathbf{a} \times \mathbf{b}) \times \mathbf{c}$ 共面。

因此，当 $\mathbf{a}, \mathbf{b}$ 不共线，$(\mathbf{a} \times \mathbf{b}) \times \mathbf{c}$ 可以表示为 $\lambda \mathbf{a} + \mu \mathbf{b}$ 的形式。

#### 复合积的计算

取右手系 $\{O; \mathbf{i}, \mathbf{j}, \mathbf{k}\}$，考虑用**内积**得到在各坐标轴上的投影。

故计算 $(\mathbf{a} \times \mathbf{b}) \times \mathbf{c}$ 与各基向量的内积：

$$
\begin{aligned}
((\mathbf{a} \times \mathbf{b}) \times \mathbf{c}) \cdot \mathbf{i} &= (\mathbf{a} \times \mathbf{b}) \cdot (\mathbf{c} \times \mathbf{i}) \\
&= (\begin{vmatrix} y_a & z_a \\ y_b & z_b \end{vmatrix}, \begin{vmatrix} z_a & x_a \\ z_b & x_b \end{vmatrix}, \begin{vmatrix} x_a & y_a \\ x_b & y_b \end{vmatrix}) \cdot (0, z_c, -y_c) \\
&= z_c \begin{vmatrix} z_a & x_a \\ z_b & x_b \end{vmatrix} - y_c \begin{vmatrix} x_a & y_a \\ x_b & y_b \end{vmatrix} \\
&= -z_c \begin{vmatrix} x_a & z_a \\ x_b & z_b \end{vmatrix} - y_c \begin{vmatrix} x_a & y_a \\ x_b & y_b \end{vmatrix} \\
&= - \begin{vmatrix} x_a & z_a z_c \\ x_b & z_b z_c \end{vmatrix} - \begin{vmatrix} x_a & y_a y_c \\ x_b & y_b y_c \end{vmatrix} \\
&= - \begin{vmatrix} x_a & y_a y_c + z_a z_c \\ x_b & y_b y_c + z_b z_c \end{vmatrix} \\
&= - \begin{vmatrix} \mathbf{a} \cdot \mathbf{i} & \mathbf{a} \cdot \mathbf{c} \\ \mathbf{b} \cdot \mathbf{i} & \mathbf{b} \cdot \mathbf{c} \end{vmatrix} \\
&= (\mathbf{a} \cdot \mathbf{c}) (\mathbf{b} \cdot \mathbf{i}) - (\mathbf{b} \cdot \mathbf{c}) (\mathbf{a} \cdot \mathbf{i}) \\
&= ((\mathbf{a} \cdot \mathbf{c}) \mathbf{b} - (\mathbf{b} \cdot \mathbf{c}) \mathbf{a}) \cdot \mathbf{i}
\end{aligned}
$$

同理有 $((\mathbf{a} \times \mathbf{b}) \times \mathbf{c}) \cdot \mathbf{j} = ((\mathbf{a} \cdot \mathbf{c}) \mathbf{b} - (\mathbf{b} \cdot \mathbf{c}) \mathbf{a}) \cdot \mathbf{j}, ((\mathbf{a} \times \mathbf{b}) \times \mathbf{c}) \cdot \mathbf{k} = ((\mathbf{a} \cdot \mathbf{c}) \mathbf{b} - (\mathbf{b} \cdot \mathbf{c}) \mathbf{a}) \cdot \mathbf{k}$。

进而求得 $(\mathbf{a} \times \mathbf{b}) \times \mathbf{c} = (\mathbf{a} \cdot \mathbf{c}) \mathbf{b} - (\mathbf{b} \cdot \mathbf{c}) \mathbf{a}$。

#### 定理：拉格朗日 Lagrange 公式

内容：$(\mathbf{a} \times \mathbf{b}) \cdot (\mathbf{c}, \mathbf{d}) = (\mathbf{a}, \mathbf{c}) (\mathbf{b}, \mathbf{d}) - (\mathbf{a}, \mathbf{d}) (\mathbf{b}, \mathbf{c})$。

证明：

$$
\begin{aligned}
(\mathbf{a} \times \mathbf{b}) \cdot (\mathbf{c} \times \mathbf{d}) &= (\mathbf{a}, \mathbf{b}, \mathbf{c} \times \mathbf{d}) \\
&= (\mathbf{b}, \mathbf{c} \times \mathbf{d}, \mathbf{a}) \\
&= (\mathbf{b} \times (\mathbf{c} \times \mathbf{d})) \cdot \mathbf{a} \\
&= \mathbf{a} \cdot (-(\mathbf{c} \times \mathbf{d}) \times \mathbf{b}) \\
&= \mathbf{a} \cdot ((\mathbf{d} \cdot \mathbf{b}) \mathbf{c} - (\mathbf{c} \cdot \mathbf{b}) \mathbf{d}) \\
&= (\mathbf{a}, \mathbf{c}) (\mathbf{b}, \mathbf{d}) - (\mathbf{a}, \mathbf{d}) (\mathbf{b}, \mathbf{c})
\end{aligned}
$$

#### 定理：雅可比 Jacobi 公式

内容：$(\mathbf{a} \times \mathbf{b}) \times \mathbf{c} + (\mathbf{b} \times \mathbf{c}) \times \mathbf{a} + (\mathbf{c} \times \mathbf{a}) \times \mathbf{b} = \mathbf{0}$。

- 注意到这个式子非常轮换对称！

证明：

$$
\begin{aligned}
(\mathbf{a} \times \mathbf{b}) \times \mathbf{c} + (\mathbf{b} \times \mathbf{c}) \times \mathbf{a} + (\mathbf{c} \times \mathbf{a}) \times \mathbf{b} &= ((\mathbf{a} \cdot \mathbf{c}) \mathbf{b} - (\mathbf{b} \cdot \mathbf{c}) \mathbf{a}) + ((\mathbf{b} \cdot \mathbf{a}) \mathbf{c} - (\mathbf{c} \cdot \mathbf{a}) \mathbf{b}) + ((\mathbf{c} \cdot \mathbf{b}) \mathbf{a} - (\mathbf{a} \cdot \mathbf{b}) \mathbf{c}) \\
&= ((\mathbf{c} \cdot \mathbf{b}) - (\mathbf{b} \cdot \mathbf{c})) \mathbf{a} + ((\mathbf{a} \cdot \mathbf{c}) - (\mathbf{c} \cdot \mathbf{a})) \mathbf{b} + ((\mathbf{b} \cdot \mathbf{a}) - (\mathbf{a} \cdot \mathbf{b})) \mathbf{c} \\
&= \mathbf{0}
\end{aligned}
$$

### 点线面 Revisit

在建立了仿射坐标系 $\{O; \mathbf{e}_1, \mathbf{e}_2, \mathbf{e}_3\}$ 的三维空间 $V$ 中，我们重访点线面。

#### 点

对于点 $A$，我们可以不引起混淆地用其**矢径** $\mathbf{x} = \overrightarrow{OA}$ 表征，记作 $\mathbf{x} = x_1 \mathbf{e}_1 + x_2 \mathbf{e}_2 + x_3 \mathbf{e}_3$。

#### 面

##### 平面的参数方程

对于平面 $\Pi (O'; \mathbf{a}, \mathbf{b})$，我们可以用其上点的矢径集合表征，记作 $\Pi (\mathbf{x}^*, \mathbf{a}, \mathbf{b}) = \{\mathbf{x} \mid \mathbf{x}^* + \lambda \mathbf{a} + \mu \mathbf{b}, \lambda, \mu \in \mathbb{R}\}$。

这被称作平面的**参数方程**，其中参数为 $\lambda, \mu$。

##### 平面的一般方程

###### 法一

- 这个做法从“两个参数”的代数结构出发，**反演**出与之相应的线性方程组的结构。

确定坐标中的三个未知量 $(x, y, z)$ 需要两个自由参数 $\lambda, \mu$，这意味着：

- 如果能构造线性方程组 $\mathbf{P}_{n \times 3} \begin{bmatrix} x \\ y \\ z \end{bmatrix} = \mathbf{q}_n$，则 $\operatorname{rank}(\mathbf{P}) = 3 - 2 = 1$，即只有一个有效方程。
- $\begin{bmatrix} x_0 \\ y_0 \\ z_0 \end{bmatrix}$ 恰为一组特解。

因此，选定恰当的 $(A, B, C, D)$ 后即可通过 $Ax + By + Cz + D = 0$ 表征解空间。这一形式被称作平面的**一般方程**。

- 事实上，$\mathbf{a}, \mathbf{b}$ 正是 $Ax + By + Cz = 0$ 的两个线性无关的解。

##### 法二

- ~~这个做法从右手系出发，虽易于理解，但委实不太漂亮（~~

由**混合积性质的推论**可知：$\mathbf{a}, \mathbf{b}, \mathbf{x} - \mathbf{x}^*$ 共面当且仅当 $(\mathbf{a}, \mathbf{b}, \mathbf{x} - \mathbf{x}^*) = 0$。

方便起见，在右手系下考虑该问题，设 $\mathbf{a}, \mathbf{b}, \mathbf{x}, \mathbf{x}^*$ 的坐标为 $(a_1, a_2, a_3), (b_1, b_2, b_3), (x, y, z), (x_0, y_0, z_0)$，则：

$$
\begin{aligned}
\begin{vmatrix} a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \\ x - x_0 & y - y_0 & z - z_0 \end{vmatrix} &= 0 \\
\Leftrightarrow (x - x_0) \begin{vmatrix} a_2 & a_3 \\ b_2 & b_3 \end{vmatrix} - (y - y_0) \begin{vmatrix} a_1 & a_3 \\ b_1 & b_3 \end{vmatrix} + (z - z_0) \begin{vmatrix} a_1 & a_2 \\ b_1 & b_2 \end{vmatrix} &= 0 \\
\Leftrightarrow \begin{vmatrix} a_2 & a_3 \\ b_2 & b_3 \end{vmatrix} x - \begin{vmatrix} a_1 & a_3 \\ b_1 & b_3 \end{vmatrix} y + \begin{vmatrix} a_1 & a_2 \\ b_1 & b_2 \end{vmatrix} z - \begin{vmatrix} a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \\ x_0 & y_0 & z_0 \end{vmatrix} &= 0 \\
\Leftrightarrow \begin{vmatrix} a_2 & a_3 \\ b_2 & b_3 \end{vmatrix} x + \begin{vmatrix} a_3 & a_1 \\ b_3 & b_1 \end{vmatrix} y + \begin{vmatrix} a_1 & a_2 \\ b_1 & b_2 \end{vmatrix} z - \begin{vmatrix} a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \\ x_0 & y_0 & z_0 \end{vmatrix} &= 0 \\
\end{aligned}
$$

由此可见，在右手系下，平面方程总能表示为 $Ax + By + Cz + D = 0$ 的形式。

若将其推广到任意仿射坐标系下，只需进行一次线性变换。这一形式被称作平面的**一般方程**。

具体地，在上例中有：

$$
\begin{cases}
A &= \begin{vmatrix} a_2 & a_3 \\ b_2 & b_3 \end{vmatrix} \\
B &= \begin{vmatrix} a_3 & a_1 \\ b_3 & b_1 \end{vmatrix} \\
C &= \begin{vmatrix} a_1 & a_2 \\ b_1 & b_2 \end{vmatrix} \\
D &= -\begin{vmatrix} a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3 \\ x_0 & y_0 & z_0 \end{vmatrix}
\end{cases}
$$

显然，将 $A, B, C, D$ 同时乘上一个非零常数同样是该平面的方程。

##### 平面的截距式方程

在平面的一般方程 $Ax + By + Cz + D = 0$ 中，若四个参数均非零，我们可以将其改写为：

$$
\begin{aligned}
\dfrac{x}{\tilde{A}} + \dfrac{y}{\tilde{B}} + \dfrac{z}{\tilde{C}} = 1, &\quad \tilde{A} = -\dfrac{D}{A}, \tilde{B} = -\dfrac{D}{B}, \tilde{C} = -\dfrac{D}{C}
\end{aligned}
$$

由此可见，平面过坐标轴上的 $(\tilde{A}, 0, 0), (0, \tilde{B}, 0), (0, 0, \tilde{C})$ 三点，这被称作平面的**截距式方程**。

- 这跟平面解析几何中的截距式方程 $\dfrac{x}{a} + \dfrac{y}{a} = 1$ 是本质相同的。

##### 平面的三点式方程

在平面解析几何中，由于“不重合的两点确定一条直线”，我们有两点式方程。

同理，在三维空间 $V$ 中，不共线的三点也可以确定一个平面，但写出这个方程似乎就没有平面解析几何中的情况那么容易了。

考虑间接法，即先通过三点确定平面的**一般方程**中 $A, B, C, D$ 的一组解（**但我们暂时不实际地求解它们**），再给出对新点的限制。

设在右手系下，已知不共线的三点坐标 $(x_1, y_1, z_1), (x_2, y_2, z_2), (x_3, y_3, z_3)$，则下列**齐次**线性方程组的非零解就给出了一组 $A, B, C, D$：

$$
\begin{bmatrix}
x_1 & y_1 & z_1 & 1 \\
x_2 & y_2 & z_2 & 1 \\
x_3 & y_3 & z_3 & 1
\end{bmatrix}
\begin{bmatrix}
A \\
B \\
C \\
D \\
\end{bmatrix} = \mathbf{0}_3
$$

由三点不共线可知，不存在 $\begin{bmatrix} x_1 & y_1 & z_1 \\ x_2 & y_2 & z_2 \\ x_3 & y_3 & z_3 \end{bmatrix}$ 的行向量非全零系数线性组合使其为 $\mathbf{0}_3$，故该 $3$ 阶方阵满秩，于是有：

$$
\begin{cases}
\operatorname{rank} \left(
\begin{bmatrix}
x_1 & y_1 & z_1 & 1 \\
x_2 & y_2 & z_2 & 1 \\
x_3 & y_3 & z_3 & 1
\end{bmatrix}
\right) \leq \min(3, 4) = 3 \\
\operatorname{rank} \left(
\begin{bmatrix}
x_1 & y_1 & z_1 & 1 \\
x_2 & y_2 & z_2 & 1 \\
x_3 & y_3 & z_3 & 1
\end{bmatrix}
\right)
\geq \operatorname{rank} \left(
\begin{bmatrix} x_1 & y_1 & z_1 \\
x_2 & y_2 & z_2 \\
x_3 & y_3 & z_3
\end{bmatrix}
\right) = 3
\end{cases}
\Rightarrow
\operatorname{rank} \left(
\begin{bmatrix}
x_1 & y_1 & z_1 & 1 \\
x_2 & y_2 & z_2 & 1 \\
x_3 & y_3 & z_3 & 1
\end{bmatrix}
\right) = 3
$$

因此 $A, B, C, D$ 中自由变量数为 $4 - 3 = 1$，由齐次线性方程组的结构可知 $(A, B, C, D)$ 在相差非零常数倍的意义下唯一。

考虑平面上一点 $(x, y, z)$，则它也应当适用平面方程，即下列齐次线性方程组有非零解：

$$
\begin{bmatrix}
x_1 & y_1 & z_1 & 1 \\
x_2 & y_2 & z_2 & 1 \\
x_3 & y_3 & z_3 & 1 \\
x & y & z & 1
\end{bmatrix}
\begin{bmatrix}
A \\
B \\
C \\
D \\
\end{bmatrix} = \mathbf{0}_4
$$

有非零解意味着 $\begin{vmatrix} x_1 & y_1 & z_1 & 1 \\ x_2 & y_2 & z_2 & 1 \\ x_3 & y_3 & z_3 & 1 \\ x & y & z & 1 \end{vmatrix} = 0$，这被称作平面的**三点式方程**。

- 其实在平面解析几何中我们也可以将两点式方程写作 $\begin{vmatrix} x_1 & y_1 & 1 \\ x_2 & y_2 & 1 \\ x & y & 1 \end{vmatrix} = 0$。
- ~~我想这个结构是美的，因为它天然地彰显了自身的代数结构，不再需要人为施加诸如“是否为零”的讨论，保持了完整的对称与和谐（划掉）~~

##### 法向量与平面的点法式方程

根据利用混合积推导平面的一般方程的中间结果，我们发现，在右手系下，平面方程还可以表示为：

$$
A (x - x_0) + B (y - y_0) + C (z - z_0) = 0
$$

令 $\mathbf{n} = \dfrac{(A, B, C)}{||(A, B, C)||}$，则上式等价于 $\mathbf{n} \cdot (\mathbf{x} - \mathbf{x}^*) = 0$，即：平面过 $\mathbf{x}^*$ 且垂直于 $\mathbf{n}$。

我们称 $\mathbf{n}$ 为平面的单位法向量，则称该形式为平面的**点法式方程**。

- 当然，考虑到法向量自身的方向，$\mathbf{n}, -\mathbf{n}$ 都是法向量。

#### 线

##### 直线的参数方程

对于直线 $L(A; \mathbf{a})$，我们可以用其上点的矢径集合表征，记作 $L(\mathbf{x}^*, \mathbf{a}) = \{\mathbf{x} \mid \mathbf{x}^* + \lambda \mathbf{a}, \lambda \in \mathbb{R}\}$。

这被称作直线的**参数方程**，其中参数为 $\lambda$。

##### 直线的点向式方程

当 $\mathbf{a}$ 的各坐标非零，我们也可以将参数方程写作 $\dfrac{x_1 - x^*_1}{a_1} = \dfrac{x_2 - x^*_2}{a_2} = \dfrac{x_3 - x^*_3}{a_3} = \lambda$。

省去 $= \lambda$，这被称作直线的**点向式方程**。

##### 直线的两点式方程

在 $L$ 上任取不重合的两点 $\mathbf{x}^*, \tilde{\mathbf{x}}$，则 $L(A; \mathbf{a}) = L(A, \tilde{\mathbf{x}} - \mathbf{x}^*)$，故其点向式方程可以改写为 $\dfrac{x_1 - x^*_1}{\tilde{x}_1 - x^*_1} = \dfrac{x_2 - x^*_2}{\tilde{x}_2 - x^*_2} = \dfrac{x_3 - x^*_3}{\tilde{x}_3 - x^*_3}$。

这被称作直线的**两点式方程**。

##### 直线的一般方程

- ~~`deriving plane`~~

##### 法一

确定坐标中的三个未知量 $(x, y, z)$ 需要一个自由参数 $\lambda$，这意味着：

- 如果能构造线性方程组 $\mathbf{P}_{n \times 3} \begin{bmatrix} x \\ y \\ z \end{bmatrix} = \mathbf{q}_n$，则 $\operatorname{rank}(\mathbf{P}) = 3 - 1 = 2$，即有两个有效方程。
- $\begin{bmatrix} x_0 \\ y_0 \\ z_0 \end{bmatrix}$ 恰为一组特解。

因此，选定恰当的 $(A_1, B_1, C_1, D_1), (A_2, B_2, C_2, D_2)$ 后即可通过 $\begin{cases} A_1 x + B_1 y + C_1 z + D_1 = 0 \\ A_2 x + B_2 y + C_2 z + D_2 = 0 \end{cases}$ 表征解空间。

这一形式被称作直线的**一般方程**。

- 事实上，$\mathbf{a}$ 正是 $\begin{cases} A_1 x + B_1 y + C_1 z = 0 \\ A_2 x + B_2 y + C_2 z = 0 \end{cases}$ 的一个非零解，其中 $(A_1, B_1, C_1), (A_2, B_2, C_2)$ 线性无关。
- 考虑这两个用于表征直线的方程，可以发现它们各为一个**平面**的一般方程，这意味着直线总可以表示为两平面的**交线**，故可写作 $L = \Pi_1 \cap \Pi_2$。
- 在右手系下，有 $\mathbf{a} \perp (A_1, B_1, C_1), \mathbf{a} \perp (A_2, B_2, C_2) \Rightarrow \mathbf{a} \parallel (A_1, B_1, C_1) \times (A_2, B_2, C_2)$。因此，我们可以通过直线的一般方程给出一组 $\mathbf{a}$。

###### 法二

由外积的性质可知：$\mathbf{a}, \mathbf{x} - \mathbf{x}^*$ 共线当且仅当 $\mathbf{a} \times (\mathbf{x} - \mathbf{x}^*) = \mathbf{0}$。

方便起见，在右手系下考虑该问题，设 $\mathbf{a}, \mathbf{x}, \mathbf{x}^*$ 的坐标为 $(a_1, a_2, a_3), (x, y, z), (x_0, y_0, z_0)$，则：

$$
\begin{cases}
\begin{vmatrix} a_1 & a_2 \\ x - x_0 & y - y_0 \end{vmatrix} = 0 \\
\begin{vmatrix} a_2 & a_3 \\ y - y_0 & z - z_0 \end{vmatrix} = 0 \\
\begin{vmatrix} a_3 & a_1 \\ z - z_0 & x - x_0 \end{vmatrix} = 0
\end{cases}
$$

- _Motivation：这里咋有三个要求啊？能不能少一个？_

拉普拉斯展开可得：

$$
\begin{vmatrix} a_1 & a_2 & a_3 \\ a_1 & a_2 & a_3 \\ x - x_0 & y - y_0 & z - z_0 \end{vmatrix} = a_1 \begin{vmatrix} a_2 & a_3 \\ y - y_0 & z - z_0 \end{vmatrix} + a_2 \begin{vmatrix} a_3 & a_1 \\ z - z_0 & x - x_0 \end{vmatrix} + a_3 \begin{vmatrix} a_1 & a_2 \\ x - x_0 & y - y_0 \end{vmatrix} = 0
$$

由于 $a_1, a_2, a_3$ 中至少一个非零（不妨设其为 $a_i$），则当 $\forall j \in \{1, 2, 3\} \backslash \{j\}$，$a_j$ 对应的行列式为零，即可推知 $a_i$ 对应的行列式为零。

故我们只需保留两个条件，最终得到的形式与法一中的一致。

##### 从直线的一般方程到平面束

从上述法一和法二给出的结果的差别可以发现，即便忽略非零常数倍的差别，直线的一般方程也不是唯一的。

从几何直观上讲，对于直线 $L$，我们只需给出两个过 $L$ 且不重合的平面，就能唯一确定 $L$。或者说，从绕着 $L$ “转起来”得到的**平面束**中选出两个不重合的平面。

考虑我们刚刚用 $L = \Pi_1 \cap \Pi_2$ 表出直线的式子，我们可以得到过 $L$ 的平面形如 $\Pi^* = \alpha \Pi_1 + \beta \Pi_2$，其中参数 $\alpha, \beta$ 非全零。

### 点线面间的关系 Revisit

- 下面涉及距离与夹角时，默认在右手系下讨论。

#### 点点关系

两点 $\mathbf{x}_1, \mathbf{x}_2$ 间的关系仅可能是相同和相异，可以形式化地说成 $\operatorname{rank}(\mathbf{x}_1 - \mathbf{x}_2) = \begin{cases} 0, &\quad \mathbf{x}_1 = \mathbf{x}_2 \\ 1, &\quad \mathbf{x}_1 \neq \mathbf{x}_2 \end{cases}$。

它们的定量关系是距离 $d(\mathbf{x}_1, \mathbf{x}_2) = ||\mathbf{x}_1 - \mathbf{x}_2||$。

#### 点线关系

点 $\mathbf{y}$ 和线 $L(\mathbf{x}^*, \mathbf{a})$ 间的定性关系有：

- 点在线上：$\exists \lambda \in \mathbb{R}, \text{s.t. } \mathbf{y} = \mathbf{x}^* + \lambda \mathbf{a} \Rightarrow \operatorname{rank}(\mathbf{a}, \mathbf{y} - \mathbf{x}^*) = 1$。
- 点在线外：$\not\exists \lambda \in \mathbb{R}, \text{s.t. } \mathbf{y} = \mathbf{x}^* + \lambda \mathbf{a} \Rightarrow \operatorname{rank}(\mathbf{a}, \mathbf{y} - \mathbf{x}^*) = 2$。
- _这里可以理解为“逐个添加向量求线性基”。_

它们的定量关系是距离 $d(\mathbf{y}, L)$：

$$
d(\mathbf{y}, L) = \min_{\mathbf{x} \in L} d(\mathbf{y}, \mathbf{x}) = \min_{\lambda \in \mathbb{R}} d(\mathbf{y}, \mathbf{x}^* + \lambda \mathbf{a})
$$

若考虑直接计算，一个自然的求法是用 $\lambda$ 表出 $d(\mathbf{y}, \mathbf{x}^* + \lambda \mathbf{a})$ 后求解二次函数最值，过程略。

而在几何上，一个自然的求法是通过投影作垂线（**从一般到特殊**）：

- $\mathbf{y} - \mathbf{x}^*$ 沿 $\mathbf{a}$ 方向的分量为 $\dfrac{(\mathbf{y} - \mathbf{x}^*, \mathbf{a})}{||\mathbf{a}||} \cdot \dfrac{\mathbf{a}}{||\mathbf{a}||}$。
- 故其垂直于 $\mathbf{a}$ 方向的分量为 $\mathbf{y} - \dfrac{(\mathbf{y} - \mathbf{x}^*, \mathbf{a})}{||\mathbf{a}||} \cdot \dfrac{\mathbf{a}}{||\mathbf{a}||}$。
- 因此 $d(\mathbf{y}, L) = ||\mathbf{y} - \dfrac{(\mathbf{y} - \mathbf{x}^*, \mathbf{a})}{||\mathbf{a}||} \cdot \dfrac{\mathbf{a}}{||\mathbf{a}||}||$。

#### 点面关系

点 $\mathbf{y}$ 和面 $\Pi (\mathbf{x}^*, \mathbf{a}, \mathbf{b})$ 间的定性关系有：

- 点在面上：$\exists \lambda, \mu \in \mathbb{R}, \text{s.t. } \mathbf{y} = \mathbf{x}^* + \lambda \mathbf{a} + \mu \mathbf{b} \Rightarrow (\mathbf{a}, \mathbf{b}, \mathbf{y} - \mathbf{x}^*) = 2$。
- 点在面外：$\not\exists \lambda, \mu \in \mathbb{R}, \text{s.t. } \mathbf{y} = \mathbf{x}^* + \lambda \mathbf{a} + \mu \mathbf{b} \Rightarrow (\mathbf{a}, \mathbf{b}, \mathbf{y} - \mathbf{x}^*) = 3$。

它们的定量关系是距离 $d(\mathbf{y}, \Pi)$：

$$
d(\mathbf{y}, \Pi) = \min_{\mathbf{x} \in \Pi} d(\mathbf{y}, \mathbf{x}) = \min_{\lambda, \mu \in \mathbb{R}} d(\mathbf{y}, \mathbf{x}^* + \lambda \mathbf{a} + \mu \mathbf{b})
$$

若考虑直接计算，一个自然的求法是“剥洋葱”：

- 先在固定 $\lambda$ 的前提下，求出 $\mu \in \mathbb{R}$ 对应的 $d(\mathbf{y}, (\mathbf{x}^* + \lambda \mathbf{a}) + \mu \mathbf{b})$ 的最大值。
- 再求出 $\lambda \in \mathbb{R}$ 对应的上述最大值的最大值。
- _这里也可以直观地理解为先求出过 $\mathbf{y}$ 且与 $\Pi$ 垂直的一个平面 $\Pi'$，再从 $\mathbf{y}$ 出发向 $\Pi \cap \Pi'$ 作垂线。_

而在几何上，一个自然的求法是将连线投影到法向量上：

- $d(\mathbf{y}, \Pi) = |\dfrac{(\mathbf{y} - \mathbf{x}^*, \mathbf{n})}{||\mathbf{n}||}| = |(\mathbf{y} - \mathbf{x}^*, \mathbf{n})|$。
- 如果用 $Ax + By + Cz + D = 0$ 表征 $\Pi$，则可以发现 $d(y, \Pi) = \dfrac{|Ax + By + Cz + D|}{\sqrt{A^2 + B^2 + C^2}}$。
- _该表达式与平面解析几何中点到直线的距离的表达式是相似的。_

#### 线线关系

考察直线 $L_1 = \Pi_1 \cap \Pi_2, L_2 = \Pi_3 \cap \Pi_4$，其中 $\forall i \in \{1, 2, 3, 4\}, \Pi_i : A_i x + B_i y + C_i z + D_i = 0$。

为考察 $L_1, L_2$ 间的定性关系，考虑联立其一般方程：

$$
\begin{bmatrix}
A_1 & B_1 & C_1 & D_1 \\
A_2 & B_2 & C_2 & D_2 \\
A_3 & B_3 & C_3 & D_3 \\
A_4 & B_4 & C_4 & D_4
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z \\
1
\end{bmatrix}
= \mathbf{0}_4
$$

考虑从该 $4$ 阶方阵 $\mathbf{P}$ 的**秩**出发加以讨论：

- (1) 当 $\operatorname{rank}(\mathbf{P}) = 2$，$(A_3, B_3, C_3, D_3), (A_4, B_4, C_4, D_4)$ 可由 $(A_1, B_1, C_1, D_1), (A_2, B_2, C_2, D_2)$ 线性表出，则 $\Pi_3, \Pi_4$ 都属于 $\Pi_1, \Pi_2$ 的平面束，故 $L_1, L_2$ **重合**。
- (2) 当 $\operatorname{rank}(\mathbf{P}) = 3$，此时 $\exists \alpha, \beta, \gamma, \theta$ 非全零，$\text{s.t. } \alpha \Pi_1 + \beta \Pi_2 = \gamma \Pi_3 + \theta \Pi_4$，则两者的平面束有交，故 $L_1, L_2$ **共面**。
- 但“共面”有平行和相交两种情况，还需要加以进一步讨论。
- (3) 当 $\operatorname{rank}(\mathbf{P}) = 4$，线性方程组 $\mathbf{P} \begin{bmatrix} x \\ y \\ z \\ w \end{bmatrix} = \mathbf{0}_4$ 仅有唯一解，故在 $w = 1$ 的额外要求下无解，故 $L_1, L_2$ 不交。
- 而此时 $\not\exists \alpha, \beta, \gamma, \theta$ 非全零，$\text{s.t. } \alpha \Pi_1 + \beta \Pi_2 = \gamma \Pi_3 + \theta \Pi_4$，则两者的平面束无解，故 $L_1, L_2$ **异面**。

在 (2) 的前提下，考察 $3 \times 4$ 矩阵 $\mathbf{Q} = \begin{bmatrix} A_1 & B_1 & C_1 \\ A_2 & B_2 & C_2 \\ A_3 & B_3 & C_3 \\ A_4 & B_4 & C_4 \end{bmatrix}$ 的**秩**：

- 由于从 $\mathbf{P}$ 中删去列向量 $\mathbf{d} = \begin{bmatrix} D_1 \\ D_2 \\ D_3 \\ D_4 \end{bmatrix}$ 后秩要么不变、要么减少 $1$，故有 $\operatorname{rank}(\mathbf{Q}) \in \{2, 3\}$。
- (1) 当 $\operatorname{rank}(\mathbf{Q}) = 2$，此时 $\operatorname{rank}(\mathbf{Q}) \neq \operatorname{rank}(\mathbf{P}) = \operatorname{rank}([\mathbf{Q} \mid -\mathbf{d}])$，则 $\mathbf{Q} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = -\mathbf{d}$ 无解，又由 $L_1, L_2$ **共面**可知 $L_1, L_2$ **平行**。
- (2) 当 $\operatorname{rank}(\mathbf{Q}) = 3$，此时 $\operatorname{rank}(\mathbf{Q}) = \operatorname{rank}(\mathbf{P}) = \operatorname{rank}([\mathbf{Q} \mid -\mathbf{d}])$，则 $\mathbf{Q} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = -\mathbf{d}$ 有唯一解，故 $L_1, L_2$ **相交**，且交为**单点集**。

论及它们的定量关系，一是距离 $d(L_1, L_2)$：

$$
d(L_1, L_2) = \min_{\mathbf{x}_1 \in L_1, \mathbf{x}_2 \in L_2} d(\mathbf{x}_1, \mathbf{x}_2) = \min_{\lambda, \mu \in \mathbb{R}} d(\mathbf{x}^*_1 + \lambda \mathbf{a}, \mathbf{x}^*_2 + \mu \mathbf{b})
$$

直接计算略去，下面讨论几何的观点：

- 直观地说，$d(\mathbf{x}_1, \mathbf{x}_2)$ 最小当且仅当 $\mathbf{x}_2 - \mathbf{x}_1$ 与 $\mathbf{a}, \mathbf{b}$ 相垂直，这可以通过“调整法”加以验证。
- 因此，可以求得公垂线的一个方向向量 $\mathbf{v} = \mathbf{a} \times \mathbf{b} = ((A_1, B_1, C_1) \times (A_2, B_2, C_2)) \times ((A_3, B_3, C_3) \times (A_4, B_4, C_4))$。
- 在 $L_1, L_2$ 上任取两点 $\mathbf{x}_1^*, \mathbf{x}_2^*$，求其在 $\mathbf{v}$ 上的投影即得答案。
- 故 $d(L_1, L_2) = \dfrac{|(\mathbf{x}^*_2 - \mathbf{x}^*_1, \mathbf{v})|}{||\mathbf{v}||}$。

另一个定量关系是夹角 $\langle L_1, L_2 \rangle$：

$$
\langle L_1, L_2 \rangle = \langle \mathbf{a}, \mathbf{b} \rangle = \langle (A_1, B_1, C_1) \times (A_2, B_2, C_2), (A_3, B_3, C_3) \times (A_4, B_4, C_4) \rangle
$$

#### 线面关系

考察直线 $L : \begin{cases} A_1 x + B_1 y + C_1 z + D_1 = 0 \\ A_2 x + B_2 y + C_2 z + D_2 = 0 \end{cases}$ 和平面 $\Pi : A_3 x + B_3 y + C_3 z + D_3 = 0$。

为考察 $L, \Pi$ 间的定性关系，仍考虑联立其一般方程：

$$
\begin{bmatrix}
A_1 & B_1 & C_1 & D_1 \\
A_2 & B_2 & C_2 & D_2 \\
A_3 & B_3 & C_3 & D_3
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z \\
1
\end{bmatrix}
= \mathbf{0}_3
$$

考虑从该 $3 \times 4$ 矩阵 $\mathbf{P}$ 的**秩**出发加以讨论：

- (1) 当 $\operatorname{rank}(\mathbf{P}) = 2$，此时 $(A_3, B_3, C_3, D_3)$ 可由 $(A_1, B_1, C_1, D_1), (A_2, B_2, C_2, D_2)$ 线性表出，故 $L \subset \Pi$ 即**线在面上**。
- (2) 当 $\operatorname{rank}(\mathbf{P}) = 3$，此时 $L \not\subset \Pi$，但有平行和相交两种情况，还需要加以进一步讨论。

在 (2) 的前提下，考察 $3$ 阶方阵 $\mathbf{Q} = \begin{bmatrix} A_1 & B_1 & C_1 \\ A_2 & B_2 & C_2 \\ A_3 & B_3 & C_3 \end{bmatrix}$ 的**秩**：

- 由于从 $\mathbf{P}$ 中删去列向量 $\mathbf{d} = \begin{bmatrix} D_1 \\ D_2 \\ D_3 \end{bmatrix}$ 后秩要么不变、要么减少 $1$，故有 $\operatorname{rank}(\mathbf{Q}) \in \{2, 3\}$。
- (1) 当 $\operatorname{rank}(\mathbf{Q}) = 2$，此时 $\operatorname{rank}(\mathbf{Q}) \neq \operatorname{rank}(\mathbf{P}) = \operatorname{rank}([\mathbf{Q} \mid -\mathbf{d}])$，则 $\mathbf{Q} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = -\mathbf{d}$ 无解，则 $L, \Pi$ **平行**。
- (2) 当 $\operatorname{rank}(\mathbf{Q}) = 3$，此时 $\operatorname{rank}(\mathbf{Q}) = \operatorname{rank}(\mathbf{P}) = \operatorname{rank}([\mathbf{Q} \mid -\mathbf{d}])$，则 $\mathbf{Q} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = -\mathbf{d}$ 有唯一解，故 $L, \Pi$ **相交**，且交为**单点集**。

论及它们的定量关系：

- (1) 平面和**与之平行**的平面的距离 $d(L, \Pi) = d(\mathbf{x}^*, \Pi)$。
- (2) 夹角 $\langle L, \Pi \rangle = \displaystyle\min_{L' \subset \Pi} \langle L, L' \rangle = \arcsin \dfrac{|\mathbf{a} \cdot \mathbf{n}|}{||\mathbf{a}||}$。

#### 面面关系

考察平面 $\Pi_1 : A_1 x + B_1 y + C_1 z + D_1 = 0, \Pi_2 : A_2 x + B_2 y + C_2 z + D_2 = 0$。

为考察 $\Pi_1, \Pi_2$ 间的定性关系，依然考虑联立其一般方程：

$$
\begin{bmatrix}
A_1 & B_1 & C_1 & D_1 \\
A_2 & B_2 & C_2 & D_2
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z \\
1
\end{bmatrix}
= \mathbf{0}_2
$$

考虑从该 $2 \times 4$ 矩阵 $\mathbf{P}$ 的**秩**出发加以讨论：

- (1) 当 $\operatorname{rank}(\mathbf{P}) = 1$，此时 $(A_1, B_1, C_1, D_1), (A_2, B_2, C_2, D_2)$ 在相差非零常数倍的意义下相同，则 $\Pi_1 = \Pi_2$。
- (2) 当 $\operatorname{rank}(\mathbf{P}) = 2$，此时 $\Pi_1 \neq \Pi_2$，但有平行和相交两种情况，还需要加以进一步讨论。

在 (2) 的前提下，考察 $2 \times 3$ 矩阵 $\mathbf{Q} = \begin{bmatrix} A_1 & B_1 & C_1 \\ A_2 & B_2 & C_2 \end{bmatrix}$ 的**秩**：

- 由于从 $\mathbf{P}$ 中删去列向量 $\mathbf{d} = \begin{bmatrix} D_1 \\ D_2 \end{bmatrix}$ 后秩要么不变、要么减少 $1$，故有 $\operatorname{rank}(\mathbf{Q}) \in \{1, 2\}$。
- (1) 当 $\operatorname{rank}(\mathbf{Q}) = 1$，此时 $\operatorname{rank}(\mathbf{Q}) \neq \operatorname{rank}(\mathbf{P}) = \operatorname{rank}([\mathbf{Q} \mid -\mathbf{d}])$，则 $\mathbf{Q} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = -\mathbf{d}$ 无解，则 $\Pi_1, \Pi_2$ **平行**。
- (2) 当 $\operatorname{rank}(\mathbf{Q}) = 2$，由前面对直线一般方程的讨论可知：$\Pi_1, \Pi_2$ **相交**，且交为**直线**。

论及它们的定量关系：

- (1) **平行**平面间的距离 $d(\Pi_1, \Pi_2) = d(\mathbf{x}^*_1, \Pi_2) = d(\mathbf{x}^*_2, \Pi_1)$。
- (2) 夹角 $\langle \Pi_1, \Pi_2 \rangle = \displaystyle\max_{L_1 \subset \Pi_1} \min_{L_2 \subset \Pi_2} \langle L_1, L_2 \rangle = \arccos |\mathbf{n}_1 \cdot \mathbf{n}_2|$。
- 对于相交的 $\Pi_1, \Pi_2$，至于为什么后两者相等，可以这样直观理解：如果 $L_1$ 不与交线垂直，则 $L_2$ 只需向 $L_1$ “那边”偏移一些即可取得比与交线垂直时更小的夹角。
