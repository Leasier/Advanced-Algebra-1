# 第五章 线性空间

### 定义：线性空间

称 $(V; +, \cdot; \mathbb{F})$ 为数域 $\mathbb{F}$ 上的线性空间，若：

1. 加法 $+ : V \times V \to V$ 封闭，且满足：

- (1) 交换律：$\mathbf{a} + \mathbf{b} = \mathbf{b} + \mathbf{a}$。
- (2) 结合律：$\mathbf{a} + (\mathbf{b} + \mathbf{c}) = (\mathbf{a} + \mathbf{b}) + \mathbf{c}$。
- (3) 零元：$\exists \mathbf{0} = (0, \cdots, 0) \in \mathbb{F}^n, \text{s.t. } \forall a \in \mathbb{F}^n, \mathbf{a} + \mathbf{0} = \mathbf{0} + \mathbf{a} = \mathbf{a}$。
- (4) 负元：$\forall \mathbf{a} \in \mathbb{F}^n, \exists (-\mathbf{a}) \in \mathbb{F}^n, \text{s.t. } \mathbf{a} + (-\mathbf{a}) = (-\mathbf{a}) + \mathbf{a} = \mathbf{0}$。

2. 数乘 $\cdot : \mathbb{F} \times V \to V$ 封闭，且满足：

- (1) 关于向量的分配律：$\lambda (\mathbf{a} + \mathbf{b}) = \lambda \mathbf{a} + \lambda \mathbf{b}$。
- (2) 关于标量的分配律：$(\lambda + \mu) \mathbf{a} = \lambda \mathbf{a} + \mu \mathbf{a}$。
- (3) 关于标量的结合律：$\lambda (\mu \mathbf{a}) = (\lambda \mu) \mathbf{a}$。
- (4) 单位元：$\exists 1 \in \mathbb{F}, \text{s.t. } \forall \mathbf{a} \in \mathbb{F}^n, 1 \cdot \mathbf{a} = \mathbf{a}$。

[例 1] $\mathbb{R}$ 上的 $n$ 维**行**向量空间，加法就是逐分量相加，数乘就是逐分量乘；$\mathbb{R}$ 上的 $n$ 维**列**向量空间亦然。

但当 $n \neq 1$，这两者并非相同的线性空间，因为行向量和列向量不能直接相加。

不过注意到通过**转置**，我们可以在两者间建立一一映射，这也是为什么我们在使用中将两者等同。

[例 2] 三维几何向量空间，定义 $\overrightarrow{AB} + \overrightarrow{BC} = \overrightarrow{AC}$（三角形法则）和基于延长与截取的数乘。

找一组放射坐标系的基，我们可以在三维几何向量和 $\mathbb{R}$ 上的三维行 / 列向量间建立一一映射。

[例 3] $n$ 阶实系数多项式空间 $\mathbb{P}_n[x] = \{\displaystyle\sum_{i = 0}^n a_i x^i \mid a_i \in \mathbb{R}\}$，加法就是逐系数相加，数乘就是逐系数乘。

- 这里可以不理解为“代数式”的运算，而是理解为对系数的操作。

[例 4] 实系数多项式空间 $\mathbb{P}[x] = \cup_{n \in \mathbb{N}} \mathbb{P}_n[x]$，加法就是对齐到高阶者后逐系数相加，数乘就是逐系数乘。

- 由于**零元唯一**，这里认为各 $\mathbb{P}_n[x]$ 中的系数全零的多项式都是零。
- 进一步地，只要 $\forall x \in \mathbb{R}, f(x) = g(x)$，就认为多项式函数 $f, g$ 相等。于是，我们认为添加或删去“前导零”得到的多项式与原多项式一致。
- 这里不包括 $e^x$ 这样的东西，因为它不能被**有限阶**多项式表出。

[例 5] （有限元法 Finite Element Method）我们尝试拟合函数 $f : [0, 1] \to \mathbb{R}$。

考虑采样 $\forall i \in \mathbb{N}_{\leq n}, f(\dfrac{i}{n})$，此时构造**折线**拟合 $\forall x \in [0, 1), \tilde{f}(x) = f(\dfrac{i}{n}) + n(f(\dfrac{i + 1}{n}) - f(\dfrac{i}{n}))) (x - \dfrac{i}{n})$，其中 $x \in [\dfrac{i}{n}, \dfrac{i + 1}{n})$。

可以发现 $f(\dfrac{i}{n})$ 对 $\tilde{f}(x)$ 的影响在区间 $[\max(\dfrac{i - 1}{n}, 0), \min(\dfrac{i + 1}{n}, 1)]$ 上形如两段折线，不妨记作 $f(\dfrac{i}{n}) e_i(x)$，其中：

$$
e_i(x) = \begin{cases}
n(x - \dfrac{i - 1}{n}), &\quad x \in [\dfrac{i - 1}{n}, \dfrac{i}{n}] \cap [0, 1] \\
n(\dfrac{i + 1}{n} - x), &\quad x \in [\dfrac{i}{n}, \dfrac{i + 1}{n}] \cap [0, 1] \\
0, &\quad x \in [0, 1] \backslash [\dfrac{i - 1}{n}, \dfrac{i + 1}{n}]
\end{cases}
$$

在此基础上，构造 $[0, 1]$ 上的分段线性函数空间 $V = \{\tilde{f} = \displaystyle\sum_{i = 0}^n f_i e_i \mid f_i \in \mathbb{R}\}$，加法就是逐系数相加，数乘就是逐系数乘。

[例 6] 闭区间 $[0, 1]$ 上的实连续函数空间 $C[0, 1]$，加法就是“逐点值”相加，数乘就是“逐点值”乘。

- 这里“逐点值”即 $\forall x \in [0, 1], (f + g)(x) \equiv f(x) + g(x), (\lambda f)(x) \equiv \lambda f(x)$。

[例 7] 定义线性空间 $(V; \oplus, \odot; \mathbb{R}^+)$，其中 $\oplus$ 表示正实数的乘法（即 $a \oplus b = ab$）、其零元为 $1$、逆元为其导数，$\odot$ 表示正实数的乘方（即 $\lambda \odot x = x^{\lambda}$）、其单位元为 $1$。

可以从两个角度来理解这个问题：

- (1) 考虑映射 $\ln : \mathbb{R}^+ \to \mathbb{R}$，则原域上的 $\oplus$（$\times$）和 $\odot$ 被映射到新域上的 $+$ 和 $\times$。
- (2) 考虑先在自然数上研究问题，可以发现 $+, \times$ 和幂的 Peano 公理化定义是同构的。

[例 8] $\mathbb{R}^{m \times n}$ 上的矩阵空间，加法就是逐分量相加，数乘就是逐分量乘。

令 $\mathbf{E}_{x, y} = ([i = x] [j = y])_{m \times n}$，则 $\mathbf{A} = (a_{i, j})_{m \times n} = \displaystyle\sum_{i = 1}^m \sum_{j = 1}^n a_{i, j} \mathbf{E}_{i, j}$；反之亦然。

由此可见 $\mathbb{R}^{m \times n}$ 与 $\mathbb{R}^{mn}$ 一一对应，即“排成表”和“排成行 / 列”的表示是同构的。

[例 9] 像空间 Image / Range Space $\mathcal{R}(\mathbf{A}_{n \times m}) = \{\mathbf{A} \mathbf{x} \mid \mathbf{x} \in \mathbb{R}^n\} \subset \mathbb{R}^m$，其中的加法和数乘继承自 $\mathbb{R}^m$。

由继承可知加法的性质 (1)(2) 和数乘的各项性质均被保留，下面验证封闭性和其他性质：

- 由定义可知 $\forall \mathbf{u}, \mathbf{v} \in \mathcal{R}(\mathbf{A}), \exists \mathbf{x}, \mathbf{y} \in \mathbb{R}^n, \text{s.t. } \mathbf{A} \mathbf{x} = \mathbf{u}, \mathbf{A} \mathbf{y} = \mathbf{v}$。
- (1) 加法的**封闭性**：$\mathbf{u} + \mathbf{v} = \mathbf{A} \mathbf{x} + \mathbf{A} \mathbf{y} = \mathbf{A} (\mathbf{x} + \mathbf{y}) \in \mathcal{R}(\mathbf{A})$。
- (2) 数乘的**封闭性**：$\lambda \mathbf{u} = \lambda (\mathbf{A} \mathbf{x}) = \mathbf{A} (\lambda \mathbf{x}) \in \mathcal{R}(\mathbf{A})$。
- (3) 加法的零元：$\mathbf{A} \mathbf{0}_n = \mathbf{0}_m \in \mathcal{R}(\mathbf{A})$，$\mathbf{u} + \mathbf{0}_m = \mathbf{u}$。
- (4) 加法的负元：$\mathbf{u} + \mathbf{A} (-\mathbf{x}) = \mathbf{u} + (-\mathbf{u}) = \mathbf{0}_m$。

[例 10] 对 $\mathbf{A} \in \mathbb{R}^{m \times n}$ 而言，其核空间 Kernal Space $\ker(\mathbf{A})$ / 零空间 Null Space $\mathcal{N}(\mathbf{A})$ 为 $\{\mathbf{x} \in \mathbb{R}^n \mid \mathbf{A} \mathbf{x} = \mathbf{0}_m\} \subset \mathbb{R}^n$，其中的加法和数乘继承自 $\mathbb{R}^n$。

可同例 9 验证性质，不再赘述。

--------

线性空间的八条性质已经在第二章中证明过了，不再赘述。

### 定义：线性表出、线性组合与线性相关

在线性空间 $V$ 中，若 $\exists \lambda_1, \cdots, \lambda_n \in \mathbb{F}, \text{s.t. } \mathbf{a} = \displaystyle\sum_{i = 1}^n \lambda_i \mathbf{a}_i$，则称 $\mathbf{a}$ 能被 $\mathbf{a}_1, \cdots, \mathbf{a}_n$ 线性表出，$\mathbf{a}$ 是 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 的一个线性组合，

若对于 $S \subset V$，$\forall \mathbf{a} \in S, \mathbf{a}$ 都能被 $\mathbf{a}_1, \cdots, \mathbf{a}_n$ 线性表出，则称 $S$ 能被 $\mathbf{a}_1, \cdots, \mathbf{a}_n$ 线性表出。

若对于 $S, T \subset V$，$\forall \mathbf{a} \in S, \mathbf{a}$ 能被 $T$ 中有限个向量线性表出，则称 $S$ 能被 $T$ 线性表出。

- 不能线性表出的例子：$V = C[0, 1], S = C^{\infty}[0, 1], T = \{x^n \mid n \in \mathbb{N}\}$。

若对于 $S, T \subset V$，$S, T$ 能互相线性表出，则称 $S, T$ 等价，记作 $S \sim T$。

若对于有限集 $S = \{\mathbf{a}_1, \cdots, \mathbf{a}_n\} \subset V$，$\exists \lambda_1, \cdots, \lambda_n \in \mathbb{F}$ 且非全零，使得 $\displaystyle\sum_{i = 1}^n \lambda_i \mathbf{a}_i = \mathbf{0}$，则称 $S$ 线性相关。

若无限集 $S$ 存在线性相关的有限子集，则称 $S$ 线性相关。

线性无关即非线性相关。

- 例如：$\{x^n \mid n \in \mathbb{N}\} \cup \{e^x\}$ 线性无关。

### 定义：极大线性无关组与秩

对于线性无关的 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_t}\} \subset \{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$，若任增加 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 中的一个向量得到的向量组都线性相关，则称 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_t}\}$ 为 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 的一个极大线性无关组（简称极大无关组）。

把第二章提到的东西搬过来，可知极大无关组的 $t$ 都相同，故可定义秩 $\operatorname{rank}(\mathbf{a}_1, \cdots, \mathbf{a}_n) = t$。

### 定义：维数

对于 $n \in \mathbb{N}$，称线性空间 $V$ 的维度为 $n$，当且仅当 $V$ 中有一个大小为 $n$ 的线性无关组，且任一大小为 $n + 1$ 的向量组都线性相关，此时记 $\dim V = n$。

若 $\forall n \in \mathbb{N}, V$ 中都有一个大小为 $n$ 的线性无关组，此时记 $\dim V = \infty$。

- 例如：$\dim \mathbb{P}[x] = \infty$。
- _今后，若不特别指出，默认讨论有限维线性空间。_

特别地，只含零元的线性空间的维数为 $0$。

[例 11] 求证：$\dim \mathbb{P}_2[x] = 3$。

- $\forall f \in \mathbb{P}_2[x], f$ 均可以被表示为 $f(x) = a_0 + a_1 x + a_2 x^2$ 的形式，其中 $a_0, a_1, a_2 \in \mathbb{R}$。
- (1) 先证 $\{1, x, x^2\}$ 线性无关。
- 假设 $\exists \lambda_0, \lambda_1, \lambda_2$ 非全零，使得 $\lambda_0 + \lambda_1 x + \lambda_2 x^2$ 恒为零。
- 考虑任取三点采样，通过范德蒙德行列式 / 取特殊值（如 $x = -1, 0, 1$）解出 $\lambda_0 = \lambda_1 = \lambda_2 = 0$。
- 矛盾，假设不成立，故 $\{1, x, x^2\}$ 线性无关。
- (2) 再证任取四个 $f$ 都线性相关。
- 设系数，列方程，由未知数多于方程数即得有非零解，具体过程略。
- 综上，$\dim \mathbb{P}_2[x] = 3$。

### 定义：基 Basis 与坐标

若 $\dim V = n$，且 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性无关，则称其为 $V$ 的一组基。

$\forall \mathbf{a} \in V$，由维数的定义可知 $\{\mathbf{a}, \mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性相关，则 $\exists \mu, \lambda_1, \cdots, \lambda_n \in \mathbb{F}$ 非全零，$\text{s.t. } \mu \mathbf{a} + \displaystyle\sum_{i = 1}^n \lambda_i \mathbf{e}_i = \mathbf{0}$。

若 $\mu = 0$ 则 $\{\mathbf{a}, \mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性相关，矛盾，故 $\mu \neq 0$，则 $\mathbf{a} = \displaystyle\sum_{i = 1}^n (-\dfrac{\lambda_i}{\mu}) \mathbf{e}_i$。

那么，这样的系数表示是否是唯一的呢？假设 $\mathbf{a} = \displaystyle\sum_{i = 1}^n a_i \mathbf{e}_i = \sum_{i = 1}^n a'_i \mathbf{e}_i$。

故 $\displaystyle\sum_{i = 1}^n (a'_i - a_i) \mathbf{e}_i = \mathbf{0}$，由基线性无关可知 $\forall i \in [1, n] \cap \mathbb{N}, a'_i - a_i = 0$，即任意两组系数相同，故系数表示唯一。

综上，$\exists ! (a_1, \cdots, a_n) \in \mathbb{F}^n, \text{s.t. } \mathbf{a} = \displaystyle\sum_{i = 1}^n a_i \mathbf{e}_i$，此时称该向量为 $\mathbf{a}$ 在基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 下的坐标，也记作：

$$
\mathbf{a} = (\mathbf{e}_1, \cdots, \mathbf{e}_n) \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix}
$$

#### 定理：若 $V$ 由线性无关组 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性表出，则 $\dim V = n$。

证明略。

[例 12] 求：(1) $\dim (\mathbb{C}; +, \cdot; \mathbb{C})$；(2) $\dim(\mathbb{C}; +, \cdot; \mathbb{R})$。

- (1) 取 $1$ 为基，可得答案为 $1$。
- (2) 取 $1, i$ 为基，可得答案为 $2$。
- _本题提示我们，数域的选取可能会影响基的选取。_

[例 13] 对于 $\mathbf{A} \in \mathbb{R}^{m \times n}$，求：(1) $\dim \mathcal{R}(\mathbf{A})$；(2) $\dim \ker(\mathbf{A})$。

- (1) $\mathcal{R}(A)$ 中的元素都能被 $\mathbf{A}$ 的列向量线性表出，取 $\mathbf{A}$ 的列向量的极大无关组 $S$，则 $\mathcal{R}(A)$ 可由 $S$ 线性表出，故 $\dim \mathcal{R}(\mathbf{A}) = |S| = \operatorname{rank}(\mathbf{A})$。
- (2) 由齐次线性方程组的解的结构可知：$\ker(\mathbf{A})$ 中的元素都能被基础解系给出的 $n - \operatorname{rank}(\mathbf{A})$ 个线性无关的向量线性表出，故 $\dim \ker(\mathbf{A}) = n - \operatorname{rank}(\mathbf{A})$。

[例 14] 给定 $\alpha, \beta \in \mathbb{R}$，求空间 $V = \{\{x_n\} \mid x_0, x_1 \in \mathbb{R}; \forall n \in \mathbb{N}, x_{n + 2} = \alpha x_{n + 1} + \beta x_n\}$ 的维数并给出一组基，这里序列的加法就是逐项相加，数乘一个实数就是逐项乘。

- $V$ 显然为线性空间。
- 对于**二阶齐次线性递推**，考虑其特征方程 $\lambda^2 - \alpha \lambda - \beta = 0$。
- (1) 若其有**不等**实根 $\lambda_1, \lambda_2 \in \mathbb{R}$，令 $X_1 = \{\lambda_1^n\}, X_2 = \{\lambda_2^n\}$。
- 一方面，$X_1, X_2$ 线性无关；另一方面，考虑将一般的递推数列表示为 $X_1, X_2$ 的线性组合。
- 考虑利用前两项的信息，即方程组 $\begin{cases} k_1 + k_2 = x_0 \\ \lambda_1 k_1 + \lambda_2 k_2 = x_1 \end{cases}$，求得 $\begin{cases} k_1 = \dfrac{x_1 - x_0 \lambda_2}{\lambda_1 - \lambda_2} \\ k_2 = \dfrac{x_0 \lambda_1 - x_1}{\lambda_1 - \lambda_2} \end{cases}$。
- 进而可以归纳出 $\forall n \in \mathbb{N}, x_n = k_1 \lambda_1^n + k_2 \lambda_2^n$，即 $X = k_1 X_1 + k_2 X_2$。
- 故 $\forall X \in V$，$X$ 可以被线性无关组 $\{X_1, X_2\}$ 表出，则 $\dim V = 2$ 且 $\{X_1, X_2\}$ 为一组基。
- (2) 若其有**重根** $\lambda \in \mathbb{R}$，令 $X_1 = \{\lambda^n\}, X_2 = \{n \lambda^n\}$。
- (3) 若其有**不等**复根 $\lambda_1 = p + i q, \lambda_2 = p - i q$，其中 $p, q \in \mathbb{R}$，令 $X_1 = \{\operatorname{Re} \lambda_1^n\}, X_2 = \{\operatorname{Im} \lambda_1^n\}$。
- 对于 (2)(3)，易验证 $\dim V = 2$ 且 $\{X_1, X_2\}$ 为一组基，过程略去。

### 基变换与坐标变换

- **注意：这里与几何向量的坐标变换的区别在于它没有“平移不变性”，进而也没有“原点”的概念。**

#### 定义：过渡阵

考虑 $n$ 维线性空间 $V$ 中的两组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}, \{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$。

将后者用前者线性表出，记 $\mathbf{T} = (t_{i, j})_{n \times n}$ 为系数阵，则用形式上的矩阵乘法可以表示为：

$$
\begin{bmatrix} \boldsymbol{\varepsilon}_1 & \cdots & \boldsymbol{\varepsilon}_n \end{bmatrix} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \mathbf{T}
$$

若 $\mathbf{a} = \displaystyle\sum_{i = 1}^n a'_i \boldsymbol{\varepsilon}_i$，则：

$$
\mathbf{a} = \sum_{i = 1}^n a_i' \sum_{j = 1}^n \mathbf{e}_j t_{j, i} \\
= \sum_{j = 1}^n \mathbf{e}_j \sum_{i = 1}^n t_{j, i} a_i' \\
$$

故有 $\begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix} = \mathbf{T} \begin{pmatrix} a'_1 \\ \vdots \\ a'_n \end{pmatrix}$。而有趣的是，形式与实质在此时达成了统一：

$$
\begin{bmatrix} \boldsymbol{\varepsilon}_1 & \cdots & \boldsymbol{\varepsilon}_n \end{bmatrix} \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix} = (\begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \mathbf{T}) \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{T} \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix})
$$

同理，也存在一个系数阵 $\boldsymbol{\tau} = (\tau_{i, j})_{n \times n}$，使得：

$$
\begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} = \begin{bmatrix} \boldsymbol{\varepsilon}_1 & \cdots & \boldsymbol{\varepsilon}_n \end{bmatrix} \boldsymbol{\tau}
$$

由于“变换过来又变换回去总是不变”，我们要求 $\forall$ 列向量 $\mathbf{v} \in \mathbb{F}^n, \mathbf{v} = \boldsymbol{\tau}(\mathbf{T} \mathbf{v})$ 即 $(\boldsymbol{\tau} \mathbf{T}) \mathbf{v} = \mathbf{I}_n \mathbf{v}$，故 $\mathbf{T} \boldsymbol{\tau} = \mathbf{I}_n$，进而可知 $\mathbf{T}, \boldsymbol{\tau}$ 均非奇异且互为逆矩阵。

我们称 $\mathbf{T}$ 为从 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 到 $\{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$ 的过渡阵，反之称 $\boldsymbol{\tau}$ 为从 $\{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$ 到 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 的过渡阵。

- 这里定义的“过渡阵”跟讨论几何向量的坐标变换时引入的过渡阵的含义是一致的。

#### 定理（向量与坐标的线性相关性）

内容：若 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 为线性空间 $(V; +, \cdot; \mathbb{F})$ 的一组基，且 $\forall i \in [1, s] \cap \mathbb{N}, \mathbf{a}_i \in V$ 在这组基下的坐标为 $\mathbf{x}_i \in \mathbb{F}^n$，则 $\{\mathbf{a}_1, \cdots, \mathbf{a}_s\}$ 线性相关当且仅当 $\{\mathbf{x}_1, \cdots, \mathbf{x}_s\}$ 线性相关。

证明：

- 下记 $\mathbf{x}_i = (x_{i, 1}, \cdots, x_{i, n})^T$。
- 充分性：设有非全零系数 $\lambda_1, \cdots, \lambda_s \in \mathbb{F}$，使得 $\displaystyle\sum_{i = 1}^s \lambda_i \mathbf{x}_i = \mathbf{0}$。
- 考虑上式的每一维，可得：

$$
\forall j \in [1, n] \cap \mathbb{N}, \sum_{i = 1}^s \lambda_i x_{i, j} = 0
$$

- 故有：

$$
\begin{aligned}
\sum_{i = 1}^s \lambda_i \mathbf{a}_i &= \sum_{i = 1}^s \lambda_i \sum_{j = 1}^n x_{i, j} \mathbf{e}_j \\
&= \sum_{j = 1}^n (\sum_{i = 1}^s \lambda_i x_{i, j}) \mathbf{e}_j \\
&= \sum_{j = 1}^n 0 \cdot \mathbf{e}_j \\
&= \mathbf{0}
\end{aligned}
$$

- 由 $\lambda_1, \cdots, \lambda_s$ 非全零可知 $\{\mathbf{a}_1, \cdots, \mathbf{a}_s\}$ 线性相关。
- 必要性：设有非全零系数 $\lambda_1, \cdots, \lambda_s \in \mathbb{F}$，使得 $\displaystyle\sum_{i = 1}^s \lambda_i \mathbf{a}_i = \mathbf{0}$。
- 故有：

$$
\begin{aligned}
\mathbf{0} &= \sum_{i = 1}^s \lambda_i \mathbf{a}_i \\
&= \sum_{i = 1}^s \lambda_i \sum_{j = 1}^n x_{i, j} \mathbf{e}_j \\
&= \sum_{j = 1}^n (\sum_{i = 1}^s \lambda_i x_{i, j}) \mathbf{e}_j \\
\end{aligned}
$$

- 由 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 为 $V$ 的一组基可知：

$$
\forall j \in [1, n] \cap \mathbb{N}, \sum_{i = 1}^s \lambda_i x_{i, j} = 0
$$

- 取 $\forall j \in [1, n] \cap \mathbb{N}, \tilde{\mathbf{e}}_j \in \mathbb{F}^n$ 仅有第 $j$ 维为 $1$、其他维为 $0$，则有：

$$
\begin{aligned}
\sum_{i = 1}^s \lambda_i \mathbf{x}_i &= \sum_{i = 1}^s \lambda_i \sum_{j = 1}^n x_{i, j} \tilde{\mathbf{e}}_j \\
&= \sum_{j = 1}^n (\sum_{i = 1}^s \lambda_i x_{i, j}) \tilde{\mathbf{e}}_j \\
&= \sum_{j = 1}^n 0 \cdot \tilde{\mathbf{e}}_j \\
&= \mathbf{0}
\end{aligned}
$$

- 由 $\lambda_1, \cdots, \lambda_s$ 非全零可知 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性相关。

### 线性子空间

#### 定义：线性子空间 Linear Subspace

对于线性空间 $(V; +, \cdot; \mathbb{F})$，若 $V' \subset V$ 且 $(V'; +, \cdot; \mathbb{F})$ 也为线性空间，则称 $V'$ 为 $V$ 的一个线性子空间，简称子空间。

- _这里写 $\subset$ 包含了等于的情况。_
- **注意：加法和数乘需要在 $V'$ 中封闭！**

例如：若采取一般的向量加法和数乘的定义，则 $\{(x, y, 0) \mid x, y \in \mathbb{R}\} \subset \mathbb{R}^3$（即 $z = 0$ 的平面）是一个子空间。

------

下面来讨论子空间的“结构”，或者说“如何生成一个子空间”。

#### 定义：张成 Span

对于线性空间 $(V; +, \cdot; \mathbb{F})$ 和 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\} \subset V$，记 $W = \{\displaystyle\sum_{i = 1}^n \lambda_i \mathbf{a}_i \mid \lambda_1, \cdots, \lambda_r \in \mathbb{F}\}$ 为 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 张成的子空间，记作 $\operatorname{span}(\mathbf{a}_1, \cdots, \mathbf{a}_n)$。

特别地，对于 $n$ 维空间 $V$ 和其一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$，有 $V = \operatorname{span}(\mathbf{a}_1, \cdots, \mathbf{a}_n)$。

当 $S$ 为无限集，记 $\operatorname{span}(S)$ 为所有能由 $S$ 中**有限**个向量线性组合得出的向量组成的集合。

#### 定理（张成与等价）

内容：若 $S, T \subset V$，则 $\text{span}(S) = \text{span}(T)$ 当且仅当 $S \sim T$。

证明：

- 充分性：$\forall \mathbf{u} \in \operatorname{span}(S)$，由 $\operatorname{span}$ 的定义可知：

$$
\exists \lambda_1, \cdots, \lambda_p \in \mathbb{F} \land \mathbf{v}_1, \cdots, \mathbf{v}_p \in S, \text{s.t. } \mathbf{u} = \sum_{i = 1}^p \lambda_i \mathbf{v}_i
$$

- 由 $S \sim T$ 可知 $S$ 可以被 $T$ 线性表出，即：

$$
\forall i \in [1, p] \cap \mathbb{N}, \exists \mu_{i, 1}, \cdots, \mu_{i, q} \in \mathbb{F} \land \mathbf{w}_{i, 1}, \cdots, \mathbf{w}_{i, q} \in T, \text{s.t. } \mathbf{v}_i = \sum_{j = 1}^q \mu_{i, j} \mathbf{w}_{i, j}
$$

- 故有：

$$
\mathbf{u} = \sum_{i = 1}^p \sum_{j = 1}^q (\lambda_i \mu_{i, j}) \mathbf{w}_{i, j}
$$

- 因此 $\mathbf{u}$ 可以被 $T$ 中的 $pq$ 个向量表出，则 $\mathbf{u} \in \operatorname{span}(T)$。
- 由 $\mathbf{u}$ 的任意性可知 $\operatorname{span}(S) \subset \operatorname{span}(T)$。
- 同理有 $\operatorname{span}(T) \subset \operatorname{span}(S)$，因此 $\operatorname{span}(S) = \operatorname{span}(T)$。
- 必要性：由 $T \subset \operatorname{span}(T) = \operatorname{span}(S)$ 可知 $T$ 可以被 $S$ 线性表出。
- 同理有 $S$ 可以被 $T$ 线性表出，因此 $S \sim T$。

#### 定理（张成关于线性组合的封闭性）

内容：$\dim (\operatorname{span}(\mathbf{a}_1, \cdots, \mathbf{a}_n)) = \operatorname{rank}(\mathbf{a}_1, \cdots, \mathbf{a}_n)$。

证明：

- 令 $r = \operatorname{rank}(\mathbf{a}_1, \cdots, \mathbf{a}_n)$，不妨设 $\{\mathbf{e}_1, \cdots, \mathbf{e}_r\}$ 为 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 的一组基。
- 故 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\} \sim \{\mathbf{e}_1, \cdots, \mathbf{e}_r\}$，则令 $W \equiv \operatorname{span}(\mathbf{a}_1, \cdots, \mathbf{a}_n) = \operatorname{span}(\mathbf{e}_1, \cdots, \mathbf{e}_r)$。
- 由于 $\{\mathbf{e}_1, \cdots, \mathbf{e}_r\}$ 线性无关且可以线性表出 $W$，故 $\dim W = r$。

[例 15] 求证：$\forall \mathbb{R}^n$ 的一个子空间 $V$，$\exists m \in \mathbb{N} \cap \mathbf{A} \in \mathbb{R}^{m \times n}, \text{s.t. } V = \ker(\mathbf{A})$。

设 $V$ 的一组基为 $\{\mathbf{e}_1, \cdots, \mathbf{e}_r\}$，则 $\forall i \in [1, r] \cap \mathbb{N}, \mathbf{A} \mathbf{e}_r = \mathbf{0}_m$。

- _Motivation：“对偶”？_

考虑上式的第 $j$ 个分量，设 $\mathbf{A}$ 的**行**向量分别为 $\mathbf{a}_1, \cdots, \mathbf{a}_m$，则 $\forall i \in [1, r] \cap \mathbb{N}, \mathbf{a}_j \cdot \mathbf{e}_i = 0 \Leftrightarrow \mathbf{e}_i^T \cdot \mathbf{a}_j^T = 0$。

构造以 $\mathbf{e}_1^T, \cdots, \mathbf{e}_r^T$ 为行向量的矩阵 $\mathbf{E} \in \mathbb{R}^{r \times n}$，则 $\forall j \in [1, r], \text{s.t. } \mathbf{E} \mathbf{a}_j^T = \mathbf{0}$。

对于齐次线性方程组 $\mathbf{E} \mathbf{x} = \mathbf{0}$，由于 $\operatorname{rank}(\mathbf{E}) = r$，考察其解的结构可知：

$$
\mathbf{x} = \sum_{i = 1}^{n - r} c_i \boldsymbol{\eta}_i
$$

其中 $\boldsymbol{\eta}_1, \cdots, \boldsymbol{\eta}_{n - r}$ **线性无关**。故令 $m = n - r$，取 $\forall i \in [1, m] \cap \mathbb{N}, \mathbf{a}_i = \boldsymbol{\eta}_i^T$ 即可。

- 这里也可以采取“构造线性方程组”的视角。

#### 定理（原空间的基与子空间的基）

内容：子空间的任意一组基一定可以扩充为原空间的一组基。

证明：

- 设线性空间 $V$ 的维数为 $n$，子空间 $V' \subset V$ 的维数为 $m \leq n$，任取其一组基为 $\{\mathbf{e}_1, \cdots, \mathbf{e}_m\}$。
- (1) $m = n$：$\forall \mathbf{v} \in V$，由于 $V$ 的维数为 $n$，大小为 $n + 1$ 的向量组 $\{\mathbf{e}_1, \cdots, \mathbf{e}_m, \mathbf{v}\}$ 线性相关。
- 又因为 $\{\mathbf{e}_1, \cdots, \mathbf{e}_m\}$ 线性无关，可知其为 $V$ 的一组基。
- (2) $m < n$：此时 $V' \subsetneq V$，故可取 $\mathbf{e}_{m + 1} \in V \backslash V'$。
- 设有 $\lambda_1, \cdots, \lambda_{m + 1} \in \mathbb{F}$，使得 $\displaystyle\sum_{i = 1}^{m + 1} \lambda_i \mathbf{e}_i = \mathbf{0}$。
- I. 若 $\lambda_{m + 1} = 0$，由 $\{\mathbf{e}_1, \cdots, \mathbf{e}_m\}$ 线性无关可知 $\lambda_1 = \cdots = \lambda_m = 0$。
- II. 若 $\lambda_{m + 1} \neq 0$，则 $\mathbf{e}_{m + 1} = \displaystyle\sum_{i = 1}^m (-\frac{\lambda_i}{\lambda_{m + 1}}) \mathbf{e}_i$，故 $\mathbf{e}_{m + 1} \in \operatorname{span}(\mathbf{e}_1, \cdots, \mathbf{e}_m) = V'$，与 $\mathbf{e}_{m + 1} \in V \backslash V'$ 矛盾。
- 综合 I 和 II，可知 $\lambda_1 = \cdots = \lambda_{m + 1} = 0$，故 $\{\mathbf{e}_1, \cdots, \mathbf{e}_{m + 1}\}$ 线性无关。
- 进而可以考察基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_{m + 1}\}$ 张成的维数为 $m + 1$ 的子空间 $\operatorname{span}(\mathbf{e}_1, \cdots, \mathbf{e}_{m + 1})$。
- 如此续行，直至子空间维数为 $n$，转化为 (1) 的情况。
- 综上，$V'$ 的任意一组基一定可以扩充为 $V$ 的一组基。

#### Gram-Schmidt 正交化

对于实线性空间 $V$，若在其上定义内积，则可以从 $V$ 的任意一组基向量出发构造一组**单位正交基**，过程如下：

- 设这组基为 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$，我们将构造单位正交基 $\{\tilde{\mathbf{e}}_1, \cdots, \tilde{\mathbf{e}}_n\}$。
- 遍历 $i$ 从 $1$ 到 $n$：
- (1) 令 $\overline{\mathbf{e}}_i = \mathbf{e}_i - \displaystyle\sum_{j = 1}^{i - 1} (\mathbf{e}_i, \tilde{\mathbf{e}}_j) \tilde{\mathbf{e}}_j$，则 $\forall j \in [1, i) \cap \mathbb{N}, (\overline{\mathbf{e}}_i, \tilde{\mathbf{e}}_j) = (\mathbf{e}_i, \tilde{\mathbf{e}}_j) - ((\mathbf{e}_i, \tilde{\mathbf{e}}_j) \tilde{\mathbf{e}}_j, \tilde{\mathbf{e}}_j) = 0$，即 $\overline{\mathbf{e}}_i \perp \tilde{\mathbf{e}}_j$。
- (2) 易知 $\overline{\mathbf{e}}_i \neq 0$，故可令 $\tilde{\mathbf{e}}_i = \dfrac{\overline{\mathbf{e}}_i}{||\overline{\mathbf{e}}_i||}$，则 $\tilde{\mathbf{e}}_i$ 为单位向量，且继承了 $\overline{\mathbf{e}}_i$ 与 $\forall j \in [1, i) \cap \mathbb{N}, \tilde{\mathbf{e}}_j$ 的正交性。

下面验证其线性无关性：

- 假设 $\lambda_1, \cdots, \lambda_n \in \mathbb{R}$ 满足 $\displaystyle\sum_{i = 1}^n \lambda_i \tilde{\mathbf{e}}_i = \mathbf{0}$。
- 由内积运算的线性性可知：

$$
\begin{aligned}
0 &= (\sum_{i = 1}^n \lambda_i \tilde{\mathbf{e}}_i, \sum_{i = 1}^n \lambda_i \tilde{\mathbf{e}}_i) \\
&= \sum_{i = 1}^n \sum_{j = 1}^n \lambda_i \lambda_j (\tilde{\mathbf{e}}_i, \tilde{\mathbf{e}}_j) \\
&= \sum_{i = 1}^n \sum_{j = 1}^n \lambda_i \lambda_j \cdot [i = j] \\
&= \sum_{i = 1}^n \lambda_i^2
\end{aligned}
$$

- 由 $\lambda_i \in \mathbb{R}$ 可知 $\lambda_1 = \cdots = \lambda_n = 0$，故 $\{\tilde{\mathbf{e}}_1, \cdots, \tilde{\mathbf{e}}_n\}$ 线性无关。

### 子空间的交、和与直和

#### 定义：子空间的交与和

若 $V_1, V_2$ 为线性空间 $V$ 的子空间，则称 $V_1 \cap V_2 = \{\mathbf{v} \mid \mathbf{v} \in V_1 \land \mathbf{v} \in V_2\}$ 为其交，$V_1 + V_2 = \{\mathbf{a} + \mathbf{b} \mid \mathbf{a} \in V_1 \land \mathbf{b} \in V_2\}$ 为其和。

设 $V_1 = \operatorname{span}(\mathbf{e}_1, \cdots, \mathbf{e}_s), V_2 = \operatorname{span}(\mathbf{f}_1, \cdots, \mathbf{f}_t)$，则不难发现 $V_1 + V_2 = \operatorname{span}(\mathbf{e}_1, \cdots, \mathbf{e}_s, \mathbf{f}_1, \cdots, \mathbf{f}_t)$。

#### 定理（交与和的“封闭性”）

内容：线性空间的子空间的交与和仍为其子空间。

证明：考虑加法与数乘在交与和中封闭即可，略。

------

[例 16] 若 $V_1 = \ker (\mathbf{A}_{m \times n}), V_2 = \ker (\mathbf{B}_{k \times n})$，求 $V_1 \cap V_2$。

$$
\begin{aligned}
&\mathbf{x} \in (V_1 \cap V_2) \\
\Leftrightarrow &\begin{cases} \mathbf{x} \in V_1 \\ \mathbf{x} \in V_2 \end{cases} \\
\Leftrightarrow &\begin{cases} \mathbf{A} \mathbf{x} = \mathbf{0} \\ \mathbf{B} \mathbf{x} = \mathbf{0} \end{cases} \\
\Leftrightarrow &\begin{bmatrix} \mathbf{A} \\ \mathbf{B} \end{bmatrix} \mathbf{x} = \mathbf{0} \\
\Leftrightarrow &\mathbf{x} \in \ker (\begin{bmatrix} \mathbf{A} \\ \mathbf{B} \end{bmatrix})
\end{aligned}
$$

故 $V_1 \cap V_2 = \ker(\begin{bmatrix} \mathbf{A} \\ \mathbf{B} \end{bmatrix})$。

#### 交与和的运算性质

容易证明，线性空间 $V$ 的子空间的交与和有如下性质：

- (1) 交换律：$V_1 \cap V_2 = V_2 \cap V_1, V_1 + V_2 = V_2 + V_1$。
- (2) 结合律：$(V_1 \cap V_2) \cap V_3 = V_1 \cap (V_2 \cap V_3), V_1 + (V_2 + V_3) = (V_1 + V_2) + V_3$。

由此可见，多个子空间的交与和与顺序无关，故可以定义 $\displaystyle\bigcap_{i = 1}^k V_i, \displaystyle\sum_{i = 1}^k V_i$。

------

考虑更形式化地描述子空间之间的运算关系。令 $\mathcal{V} = \{V' \mid V' 为 V 的一个子空间\}$，则可以发现：

- 由于任意子空间与 $V$ 求交后不变，$(\mathcal{V}, \cap, V)$ 是一个交换幺半群。
- 由于任意子空间与 $\{\mathbf{0}\}$ 求和后不变，$(\mathcal{V}, \cup, \{\mathbf{0}\})$ 是一个交换幺半群。

#### 定理（子空间的子集关系）

内容：若 $V_1, V_2$ 为线性空间 $V$ 的子空间，则 $V_1 \subset V_2 \Leftrightarrow V_1 + V_2 = V_2$。

证明略。

#### 维数定理

内容：若 $V_1, V_2$ 为线性空间 $V$ 的子空间，则 $\dim (V_1 \cap V_2) + \dim (V_1 + V_2) = \dim V_1 + \dim V_2$。

证明：

- _Motivation：结论与 $|S \cap T| + |S \cup T| = |S| + |T|$ 同构，考察基？_
- 取 $\{\mathbf{e}_1, \cdots, \mathbf{e}_p\}$ 为 $V_1 \cap V_2$ 的一组基。
- 由于 $(V_1 \cap V_2) \subset V_1, V_2$，可以将其分别**扩充**为 $V_1, V_2$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_p, \mathbf{f}_1, \cdots, \mathbf{f}_q\}, \{\mathbf{e}_1, \cdots, \mathbf{e}_p, \mathbf{g}_1, \cdots, \mathbf{g}_r\}$。
- 只需证明 $\dim (V_1 + V_2) = p + q + r$，即证 $\{\mathbf{e}_1, \cdots, \mathbf{e}_p, \mathbf{f}_1, \cdots, \mathbf{f}_q, \mathbf{g}_1, \cdots, \mathbf{g}_r\}$ 是 $V_1 + V_2$ 的一组基。
- 分别说明可线性表出与线性无关即可，略。

推论：

- $\dim (V_1 + V_2) \leq \dim V_1 + \dim V_2$。
- 若 $\dim (V_1 + V_2) < \dim V_1 + \dim V_2$，则 $V_1 \cap V_2$ 中有非零元。

#### 定义：直和 Direct Sum

若 $V_1, V_2$ 为线性空间 $V$ 的子空间，且 $\forall \mathbf{c} \in (V_1 + V_2), \exists ! \mathbf{a} \in V_1, \mathbf{b} \in V_2, \text{s.t. } \mathbf{c} = \mathbf{a} + \mathbf{b}$，则定义 $V_1 \oplus V_2$ 为 $V_1 + V_2$，称作 $V_1, V_2$ 的直和。

- “直和”可以视为基意义下的“不交并”。

#### 定理（直和的等价命题）

内容：下面四个命题等价：

- (1) $V_1 + V_2$ 为直和。
- (2) $\mathbf{0}$ 的分解唯一，即只要 $\mathbf{a} \in V_1, \mathbf{b} \in V_2, \mathbf{a} + \mathbf{b} = \mathbf{0}$，就有 $\mathbf{a} = \mathbf{b} = \mathbf{0}$。
- (3) $V_1 \cap V_2 = \{\mathbf{0}\}$。
- (4) $\dim (V_1 + V_2) = \dim V_1 + \dim V_2$。

证明：

- $(1) \Rightarrow (2)$：由于 $\mathbf{0} \in V_1, V_2, V_1 + V_2$ 且 $\mathbf{0} = \mathbf{0} + \mathbf{0}$，而 $V_1 + V_2$ 为直和，故有该唯一分解。
- $(2) \Rightarrow (3)$：若 $\exists \mathbf{a} \in (V_1 \cap V_2) \backslash \{\mathbf{0}\}$，则 $\mathbf{0}, \mathbf{a} \in V_1, V_2$，而 $\mathbf{a}$ 有两种分解 $\mathbf{0} + \mathbf{a}, \mathbf{a} + \mathbf{0}$，矛盾。故 $\not\exists \mathbf{a} \in (V_1 \cap V_2) \backslash \{\mathbf{0}\}$，即 $V_1 \cap V_2 = \{\mathbf{0}\}$。
- $(3) \Rightarrow (4)$：由维数定理立即可得。
- $(4) \Rightarrow (1)$：令 $s = \dim V_1, t = \dim V_2$，则 $\dim (V_1 + V_2) = s + t$。
- 取 $V_1$ 的一组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_s\}$ 和 $V_2$ 的一组基 $\{\mathbf{f}_1, \cdots, \mathbf{f}_t\}$，则 $V_1 + V_2 = \operatorname{span}(\mathbf{e}_1, \cdots, \mathbf{e}_s, \mathbf{f}_1, \cdots, \mathbf{f}_t)$。
- 故 $\operatorname{rank}(\mathbf{e}_1, \cdots, \mathbf{e}_s, \mathbf{f}_1, \cdots, \mathbf{f}_t) = \dim (V_1 + V_2) = s + t$，则 $\{\mathbf{e}_1, \cdots, \mathbf{e}_s, \mathbf{f}_1, \cdots, \mathbf{f}_t\}$ 为  $V_1 + V_2$ 的一组基。
- 设有 $\mathbf{a}_1, \tilde{\mathbf{a}}_1 \in V_1, \mathbf{a}_2, \tilde{\mathbf{a}}_2 \in V_2$，且使得 $\mathbf{a}_1 + \mathbf{a}_2 = \tilde{\mathbf{a}}_1 + \tilde{\mathbf{a}}_2$，由 $V_1 + V_2$ 中坐标表示的唯一性立即可得 $\mathbf{a}_1 = \tilde{\mathbf{a}}_1, \mathbf{a}_2 = \tilde{\mathbf{a}}_2$。
- 因此 $V_1 + V_2$ 中向量在 $V_1, V_2$ 中有唯一分解，故 $V_1 + V_2$ 为直和。

#### 定理（直和分解的存在性）

内容：若 $V_1$ 为线性空间 $V$ 的子空间，则 $\exists V_2$ 也为 $V$ 的子空间，$\text{s.t. } V = V_1 \oplus V_2$。

证明：

- 令 $n = \dim V, r = \dim V_1$，取 $\{\mathbf{e}_1, \cdots, \mathbf{e}_r\}$ 为 $V_1$ 的一组基。
- 故可补充 $n - r$ 个向量 $\{\mathbf{e}_{r + 1}, \cdots, \mathbf{e}_n\}$，使得 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 为 $V$ 的一组基。
- 令 $V_2 = \operatorname{span}(\mathbf{e}_{r + 1}, \cdots, \mathbf{e}_n)$，由 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ **线性无关**可知 $V_1 \cap V_2 = \{\mathbf{0}\}$。
- 由直和的等价命题可知 $V = V_1 \oplus V_2$。

需要注意的是，直和分解往往不唯一，例如：

- 考虑 $V = \mathbb{R}^3$，取 $\Pi$ 为空间内一平面，则任一与 $\Pi$ 相交的直线 $L$ 都满足 $\Pi \oplus L = \mathbb{R}$。

#### 定义：多个子空间的直和

若 $V_1, \cdots, V_k$ 为线性空间的 $V$ 的子空间，且 $\forall \mathbf{a} \in \displaystyle\sum_{i = 1}^k V_i, \exists ! \mathbf{a}_i \in V_i (\forall i \in [1, k] \cap \mathbb{N}), \text{s.t. } \mathbf{a} = \sum_{i = 1}^k \mathbf{a}_i$，则定义 $\displaystyle\bigcap_{i = 1}^k V_i$ 为 $\displaystyle\sum_{i = 1}^k V_i$，称作 $V_1, \cdots, V_k$ 的直和。

- 该定义的合法性可以递归地确立。

#### 定理（多个子空间的直和的等价命题）

内容：下面四个命题等价：

- (1) $\displaystyle\sum_{i = 1}^k V_i$ 为直和。
- (2) $\mathbf{0}$ 的分解唯一，即只要 $\forall i \in [1, k] \cap \mathbb{N}, \mathbf{a}_i \in V_i; \displaystyle\sum_{i = 1}^k \mathbf{a}_i = \mathbf{0}$，就有 $\forall i \in [1, k] \cap \mathbb{N}, \mathbf{a}_i = \mathbf{0}$。
- (3) $\forall i \in [1, k] \cap \mathbb{N}, V_i \cap \displaystyle\sum_{j \neq i} V_j = \{\mathbf{0}\}$。
- (4) $\dim (\displaystyle\sum_{i = 1}^k V_i) = \sum_{i = 1}^k \dim V_i$。

证明：

- $(1) \Rightarrow (2)$：同上由定义即得。
- $(2) \Rightarrow (3)$：同上由反证即得。
- $(3) \Rightarrow (4)$：考虑数学归纳法：
- I. 当 $k = 2$，由上即得。
- II. 当 $k > 2$，设结论对 $k - 1$ 成立。
- 当 $i < k$，由 $\displaystyle\sum_{j \neq i, j < k} V_j \subset \sum_{j \neq i} V_j$ 可知 $V_i \cap \displaystyle\sum_{j \neq i, j < k} V_j = \{\mathbf{0}\}$。
- 故结论对 $(V_1, \cdots, V_{k - 1})$ 成立，则 $\dim (\displaystyle\sum_{i = 1}^{k - 1} V_i) = \sum_{i = 1}^{k - 1} \dim V_i$。
- 据 $i = k$ 的条件并由上可知 $\dim (\displaystyle\sum_{i = 1}^k V_i) = \dim ((\sum_{i = 1}^{k - 1} V_i) + V_k) = (\sum_{i = 1}^{k - 1} \dim V_i) + V_k = \sum_{i = 1}^k \dim V_i$。
- 综上，结论对 $k \in \mathbb{N}_{\geq 2}$ 总成立，遂得证。
- $(4) \Rightarrow (1)$：同上即证。

#### 另一个视角：笛卡尔积与外直和 Outer Direct Sum

事实上，在直和的定义中，我们可以绕开线性空间 $V$。设 $V_1, V_2$ 为 $\mathbb{F}$ 上的线性空间，且 $V_1 + V_2$ 为直和。

由于 $V_1 \oplus V_2$ 中向量有**唯一分解**，用 $V$ 上定义的**加法**的形式给出的、和用**笛卡尔积**的形式给出的结果是“一致”的——或者说，存在两者之间的**一一映射**。

具体而言，笛卡尔积形式指的是：

$$
\tilde{V} = V_1 \tilde{\oplus} V_2 = \{(\mathbf{a}, \mathbf{b}) \mid \mathbf{a} \in V_1, \mathbf{b} \in V_2\}
$$

定义 $\tilde{V}$ 上的加法为 pair 的两维相加，数乘为 pair 的两维分别乘，易证 $\tilde{V}$ 也构成一个线性空间。

并给出下列映射：

- $f : V \to \tilde{V}$：对于 $\mathbf{v} \in V_1 + V_2$，写出其唯一分解 $\mathbf{v} = \mathbf{a} + \mathbf{b}$，其中 $\mathbf{a} \in V_1, \mathbf{b} \in V_2$，定义 $f(\mathbf{v}) = (\mathbf{a}, \mathbf{b})$。
- $g : \tilde{V} \to V$：$\forall \mathbf{a} \in V_1, \mathbf{b} \in V_2$，定义 $g((\mathbf{a}, \mathbf{b})) = \mathbf{a} + \mathbf{b}$。

易证 $f, g$ 互为反函数。

我们称这样定义的 $\tilde{V}$ 为 $V_1, V_2$ 的外直和。~~That's how free monoid works!~~

------

可以发现，上面的构造与“坐标”其实是一致的，且 $V_1, V_2$ 具有某种“独立性”。

如此，我们不再要求 $V_1, V_2$ 是“相同”的对象，而是允许他们具有各自的零元 $\mathbf{0}_1, \mathbf{0}_2$、加法 $+_1, +_2$ 和数乘，考虑下面的 $\tilde{V}_1, \tilde{V}_2$：

$$
\begin{cases}
\tilde{V}_1 = \{(\mathbf{a}, \mathbf{0}_2) \mid \mathbf{a} \in V_1\} \\
\tilde{V}_2 = \{(\mathbf{0}_1, \mathbf{b}) \mid \mathbf{b} \in V_2\}
\end{cases}
$$

此时定义：

$$
W_1 \oplus W_2 = \{(\mathbf{a}_1 +_1 \mathbf{a}_2, \mathbf{b}_1 +_2 \mathbf{b}_2) \mid (\mathbf{a}_1, \mathbf{b}_1) \in W_1, (\mathbf{a}_2, \mathbf{b}_2) \in W_2\}
$$

则有 $\tilde{V} = \tilde{V}_1 + \tilde{V}_2$。
