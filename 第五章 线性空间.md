# 第五章 线性空间

### 定义：线性空间

称 $(V; +, \cdot; \mathbb{F})$ 为数域 $\mathbb{F}$ 上的线性空间，若：

1. 加法 $+ : V \times V \to V$ 封闭，且满足：

- (1) 交换律：$\mathbf{a} + \mathbf{b} = \mathbf{b} + \mathbf{a}$。
- (2) 结合律：$\mathbf{a} + (\mathbf{b} + \mathbf{c}) = (\mathbf{a} + \mathbf{b}) + \mathbf{c}$。
- (3) 零元：$\exists \mathbf{0} = (0, \cdots, 0) \in \mathbb{F}^n, \text{s.t. } \forall a \in \mathbb{F}^n, \mathbf{a} + \mathbf{0} = \mathbf{0} + \mathbf{a} = \mathbf{a}$。
- (4) 负元：$\forall \mathbf{a} \in \mathbb{F}^n, \exists (-\mathbf{a}) \in \mathbb{F}^n, \text{s.t. } \mathbf{a} + (-\mathbf{a}) = (-\mathbf{a}) + \mathbf{a} = \mathbf{0}$。

2. 数乘 $\cdot : \mathbb{F} \times V \to V$ 封闭，且满足：

- (1) 关于向量的分配律：$\lambda (\mathbf{a} + \mathbf{b}) = \lambda \mathbf{a} + \lambda \mathbf{b}$。
- (2) 关于标量的分配律：$(\lambda + \mu) \mathbf{a} = \lambda \mathbf{a} + \mu \mathbf{a}$。
- (3) 关于标量的结合律：$\lambda (\mu \mathbf{a}) = (\lambda \mu) \mathbf{a}$。
- (4) 单位元：$\exists 1 \in \mathbb{F}, \text{s.t. } \forall \mathbf{a} \in \mathbb{F}^n, 1 \cdot \mathbf{a} = \mathbf{a}$。

[例 1] $\mathbb{R}$ 上的 $n$ 维**行**向量空间，加法就是逐分量相加，数乘就是逐分量乘；$\mathbb{R}$ 上的 $n$ 维**列**向量空间亦然。

但当 $n \neq 1$，这两者并非相同的线性空间，因为行向量和列向量不能直接相加。

不过注意到通过**转置**，我们可以在两者间建立一一映射，这也是为什么我们在使用中将两者等同。

[例 2] 三维几何向量空间，定义 $\overrightarrow{AB} + \overrightarrow{BC} = \overrightarrow{AC}$（三角形法则）和基于延长与截取的数乘。

找一组放射坐标系的基，我们可以在三维几何向量和 $\mathbb{R}$ 上的三维行 / 列向量间建立一一映射。

[例 3] $n$ 阶实系数多项式空间 $\mathbb{P}_n[x] = \{\displaystyle\sum_{i = 0}^n a_i x^i \mid a_i \in \mathbb{R}\}$，加法就是逐系数相加，数乘就是逐系数乘。

- 这里可以不理解为“代数式”的运算，而是理解为对系数的操作。

[例 4] 实系数多项式空间 $\mathbb{P}[x] = \cup_{n \in \mathbb{N}} \mathbb{P}_n[x]$，加法就是对齐到高阶者后逐系数相加，数乘就是逐系数乘。

- 由于**零元唯一**，这里认为各 $\mathbb{P}_n[x]$ 中的系数全零的多项式都是零。
- 进一步地，只要 $\forall x \in \mathbb{R}, f(x) = g(x)$，就认为多项式函数 $f, g$ 相等。于是，我们认为添加或删去“前导零”得到的多项式与原多项式一致。
- 这里不包括 $e^x$ 这样的东西，因为它不能被**有限阶**多项式表出。

[例 5] （有限元法 Finite Element Method）我们尝试拟合函数 $f : [0, 1] \to \mathbb{R}$。

考虑采样 $\forall i \in \mathbb{N}_{\leq n}, f(\dfrac{i}{n})$，此时构造**折线**拟合 $\forall x \in [0, 1), \tilde{f}(x) = f(\dfrac{i}{n}) + n(f(\dfrac{i + 1}{n}) - f(\dfrac{i}{n}))) (x - \dfrac{i}{n})$，其中 $x \in [\dfrac{i}{n}, \dfrac{i + 1}{n})$。

可以发现 $f(\dfrac{i}{n})$ 对 $\tilde{f}(x)$ 的影响在区间 $[\max(\dfrac{i - 1}{n}, 0), \min(\dfrac{i + 1}{n}, 1)]$ 上形如两段折线，不妨记作 $f(\dfrac{i}{n}) e_i(x)$，其中：

$$
e_i(x) = \begin{cases}
n(x - \dfrac{i - 1}{n}), &\quad x \in [\dfrac{i - 1}{n}, \dfrac{i}{n}] \cap [0, 1] \\
n(\dfrac{i + 1}{n} - x), &\quad x \in [\dfrac{i}{n}, \dfrac{i + 1}{n}] \cap [0, 1] \\
0, &\quad x \in [0, 1] \backslash [\dfrac{i - 1}{n}, \dfrac{i + 1}{n}]
\end{cases}
$$

在此基础上，构造 $[0, 1]$ 上的分段线性函数空间 $V = \{\tilde{f} = \displaystyle\sum_{i = 0}^n f_i e_i \mid f_i \in \mathbb{R}\}$，加法就是逐系数相加，数乘就是逐系数乘。

[例 6] 闭区间 $[0, 1]$ 上的实连续函数空间 $C[0, 1]$，加法就是“逐点值”相加，数乘就是“逐点值”乘。

- 这里“逐点值”即 $\forall x \in [0, 1], (f + g)(x) \equiv f(x) + g(x), (\lambda f)(x) \equiv \lambda f(x)$。

[例 7] 定义线性空间 $(V; \oplus, \odot; \mathbb{R}^+)$，其中 $\oplus$ 表示正实数的乘法（即 $a \oplus b = ab$）、其零元为 $1$、逆元为其导数，$\odot$ 表示正实数的乘方（即 $\lambda \odot x = x^{\lambda}$）、其单位元为 $1$。

可以从两个角度来理解这个问题：

- (1) 考虑映射 $\ln : \mathbb{R}^+ \to \mathbb{R}$，则原域上的 $\oplus$（$\times$）和 $\odot$ 被映射到新域上的 $+$ 和 $\times$。
- (2) 考虑先在自然数上研究问题，可以发现 $+, \times$ 和幂的 Peano 公理化定义是同构的。

[例 8] $\mathbb{R}^{m \times n}$ 上的矩阵空间，加法就是逐分量相加，数乘就是逐分量乘。

令 $\mathbf{E}_{x, y} = ([i = x] [j = y])_{m \times n}$，则 $\mathbf{A} = (a_{i, j})_{m \times n} = \displaystyle\sum_{i = 1}^m \sum_{j = 1}^n a_{i, j} \mathbf{E}_{i, j}$；反之亦然。

由此可见 $\mathbb{R}^{m \times n}$ 与 $\mathbb{R}^{mn}$ 一一对应，即“排成表”和“排成行 / 列”的表示是同构的。

[例 9] 像空间 Image / Range Space $\mathcal{R}(\mathbf{A}_{n \times m}) = \{\mathbf{A} \mathbf{x} \mid \mathbf{x} \in \mathbb{R}^n\} \subset \mathbb{R}^m$，其中的加法和数乘继承自 $\mathbb{R}^m$。

由继承可知加法的性质 (1)(2) 和数乘的各项性质均被保留，下面验证封闭性和其他性质：

- 由定义可知 $\forall \mathbf{u}, \mathbf{v} \in \mathcal{R}(\mathbf{A}), \exists \mathbf{x}, \mathbf{y} \in \mathbb{R}^n, \text{s.t. } \mathbf{A} \mathbf{x} = \mathbf{u}, \mathbf{A} \mathbf{y} = \mathbf{v}$。
- (1) 加法的**封闭性**：$\mathbf{u} + \mathbf{v} = \mathbf{A} \mathbf{x} + \mathbf{A} \mathbf{y} = \mathbf{A} (\mathbf{x} + \mathbf{y}) \in \mathcal{R}(\mathbf{A})$。
- (2) 数乘的**封闭性**：$\lambda \mathbf{u} = \lambda (\mathbf{A} \mathbf{x}) = \mathbf{A} (\lambda \mathbf{x}) \in \mathcal{R}(\mathbf{A})$。
- (3) 加法的零元：$\mathbf{A} \mathbf{0}_n = \mathbf{0}_m \in \mathcal{R}(\mathbf{A})$，$\mathbf{u} + \mathbf{0}_m = \mathbf{u}$。
- (4) 加法的负元：$\mathbf{u} + \mathbf{A} (-\mathbf{x}) = \mathbf{u} + (-\mathbf{u}) = \mathbf{0}_m$。

[例 10] 对 $\mathbf{A} \in \mathbb{R}^{m \times n}$ 而言，其核空间 Kernal Space $\ker(\mathbf{A})$ / 零空间 Null Space $\mathcal{N}(\mathbf{A})$ 为 $\{\mathbf{x} \in \mathbb{R}^n \mid \mathbf{A} \mathbf{x} = \mathbf{0}_m\} \subset \mathbb{R}^n$，其中的加法和数乘继承自 $\mathbb{R}^n$。

可同例 9 验证性质，不再赘述。

--------

线性空间的八条性质已经在第二章中证明过了，不再赘述。

### 定义：线性表出、线性组合与线性相关

在线性空间 $V$ 中，若 $\exists \lambda_1, \cdots, \lambda_n \in \mathbb{F}, \text{s.t. } \mathbf{a} = \displaystyle\sum_{i = 1}^n \lambda_i \mathbf{a}_i$，则称 $\mathbf{a}$ 能被 $\mathbf{a}_1, \cdots, \mathbf{a}_n$ 线性表出，$\mathbf{a}$ 是 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 的一个线性组合，

若对于 $S \subset V$，$\forall \mathbf{a} \in S, \mathbf{a}$ 都能被 $\mathbf{a}_1, \cdots, \mathbf{a}_n$ 线性表出，则称 $S$ 能被 $\mathbf{a}_1, \cdots, \mathbf{a}_n$ 线性表出。

若对于 $S, T \subset V$，$\forall \mathbf{a} \in S, \mathbf{a}$ 能被 $T$ 中有限个向量线性表出，则称 $S$ 能被 $T$ 线性表出。

- 不能线性表出的例子：$V = C[0, 1], S = C^{\infty}[0, 1], T = \{x^n \mid n \in \mathbb{N}\}$。

若对于 $S, T \subset V$，$S, T$ 能互相线性表出，则称 $S, T$ 等价，记作 $S \sim T$。

若对于有限集 $S \subset V$，$V$ 可由 $S$ 线性表出，则称 $V$ 为有限生成的，记作 $V = \operatorname{span}(S)$。

若对于有限集 $S = \{\mathbf{a}_1, \cdots, \mathbf{a}_n\} \subset V$，$\exists \lambda_1, \cdots, \lambda_n \in \mathbb{F}$ 且非全零，使得 $\displaystyle\sum_{i = 1}^n \lambda_i \mathbf{a}_i = \mathbf{0}$，则称 $S$ 线性相关。

若无限集 $S$ 存在线性相关的有限子集，则称 $S$ 线性相关。

线性无关即非线性相关。

- 例如：$\{x^n \mid n \in \mathbb{N}\} \cup \{e^x\}$ 线性无关。

### 定义：极大线性无关组与秩

对于线性无关的 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_t}\} \subset \{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$，若任增加 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 中的一个向量得到的向量组都线性相关，则称 $\{\mathbf{a}_{i_1}, \cdots, \mathbf{a}_{i_t}\}$ 为 $\{\mathbf{a}_1, \cdots, \mathbf{a}_n\}$ 的一个极大线性无关组（简称极大无关组）。

把第二章提到的东西搬过来，可知极大无关组的 $t$ 都相同，故可定义秩 $\operatorname{rank}(\mathbf{a}_1, \cdots, \mathbf{a}_n) = t$。

### 定义：维数

对于 $n \in \mathbb{N}$，称线性空间 $V$ 的维度为 $n$，当且仅当 $V$ 中有一个大小为 $n$ 的线性无关组，且任一大小为 $n + 1$ 的向量组都线性相关，此时记 $\dim V = n$。

若 $\forall n \in \mathbb{N}, V$ 中都有一个大小为 $n$ 的线性无关组，此时记 $\dim V = \infty$。

- 例如：$\dim \mathbb{P}[x] = \infty$。
- _今后，若不特别指出，默认讨论有限维线性空间。_

特别地，只含零元的线性空间的维数为 $0$。

[例 11] 求证：$\dim \mathbb{P}_2[x] = 3$。

- $\forall f \in \mathbb{P}_2[x], f$ 均可以被表示为 $f(x) = a_0 + a_1 x + a_2 x^2$ 的形式，其中 $a_0, a_1, a_2 \in \mathbb{R}$。
- (1) 先证 $\{1, x, x^2\}$ 线性无关。
- 假设 $\exists \lambda_0, \lambda_1, \lambda_2$ 非全零，使得 $\lambda_0 + \lambda_1 x + \lambda_2 x^2$ 恒为零。
- 考虑任取三点采样，通过范德蒙德行列式 / 取特殊值（如 $x = -1, 0, 1$）解出 $\lambda_0 = \lambda_1 = \lambda_2 = 0$。
- 矛盾，假设不成立，故 $\{1, x, x^2\}$ 线性无关。
- (2) 再证任取四个 $f$ 都线性相关。
- 设系数，列方程，由未知数多于方程数即得有非零解，具体过程略。
- 综上，$\dim \mathbb{P}_2[x] = 3$。

### 定义：基 Basis 与坐标

若 $\dim V = n$，且 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性无关，则称其为 $V$ 的一组基。

$\forall \mathbf{a} \in V$，由维数的定义可知 $\{\mathbf{a}, \mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性相关，则 $\exists \mu, \lambda_1, \cdots, \lambda_n \in \mathbb{F}$ 非全零，$\text{s.t. } \mu \mathbf{a} + \displaystyle\sum_{i = 1}^n \lambda_i \mathbf{e}_i = \mathbf{0}$。

若 $\mu = 0$ 则 $\{\mathbf{a}, \mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性相关，矛盾，故 $\mu \neq 0$，则 $\mathbf{a} = \displaystyle\sum_{i = 1}^n (-\dfrac{\lambda_i}{\mu}) \mathbf{e}_i$。

那么，这样的系数表示是否是唯一的呢？假设 $\mathbf{a} = \displaystyle\sum_{i = 1}^n a_i \mathbf{e}_i = \sum_{i = 1}^n a'_i \mathbf{e}_i$。

故 $\displaystyle\sum_{i = 1}^n (a'_i - a_i) \mathbf{e}_i = \mathbf{0}$，由基线性无关可知 $\forall i \in [1, n] \cap \mathbb{N}, a'_i - a_i = 0$，即任意两组系数相同，故系数表示唯一。

综上，$\exists ! (a_1, \cdots, a_n) \in \mathbb{F}^n, \text{s.t. } \mathbf{a} = \displaystyle\sum_{i = 1}^n a_i \mathbf{e}_i$，此时称该向量为 $\mathbf{a}$ 在基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 下的坐标，也记作：

$$
\mathbf{a} = (\mathbf{e}_1, \cdots, \mathbf{e}_n) \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix}
$$

#### 定理：若 $V$ 由线性无关组 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 线性表出，则 $\dim V = n$。

证明略。

[例 12] 求：(1) $\dim (\mathbb{C}; +, \cdot; \mathbb{C})$；(2) $\dim(\mathbb{C}; +, \cdot; \mathbb{R})$。

- (1) 取 $1$ 为基，可得答案为 $1$。
- (2) 取 $1, i$ 为基，可得答案为 $2$。
- _本题提示我们，数域的选取可能会影响基的选取。_

[例 13] 对于 $\mathbf{A} \in \mathbb{R}^{m \times n}$，求：(1) $\dim \mathcal{R}(\mathbf{A})$；(2) $\dim \ker(\mathbf{A})$。

- (1) $\mathcal{R}(A)$ 中的元素都能被 $\mathbf{A}$ 的列向量线性表出，取 $\mathbf{A}$ 的列向量的极大无关组 $S$，则 $\mathcal{R}(A)$ 可由 $S$ 线性表出，故 $\dim \mathcal{R}(\mathbf{A}) = |S| = \operatorname{rank}(\mathbf{A})$。
- (2) 由齐次线性方程组的解的结构可知：$\ker(\mathbf{A})$ 中的元素都能被基础解系给出的 $n - \operatorname{rank}(\mathbf{A})$ 个线性无关的向量线性表出，故 $\dim \ker(\mathbf{A}) = n - \operatorname{rank}(\mathbf{A})$。

[例 14] 给定 $\alpha, \beta \in \mathbb{R}$，求空间 $V = \{\{x_n\} \mid x_0, x_1 \in \mathbb{R}; \forall n \in \mathbb{N}, x_{n + 2} = \alpha x_{n + 1} + \beta x_n\}$ 的维数并给出一组基，这里序列的加法就是逐项相加，数乘一个实数就是逐项乘。

- $V$ 显然为线性空间。
- 对于**二阶齐次线性递推**，考虑其特征方程 $\lambda^2 - \alpha \lambda - \beta = 0$。
- (1) 若其有**不等**实根 $\lambda_1, \lambda_2 \in \mathbb{R}$，令 $X_1 = \{\lambda_1^n\}, X_2 = \{\lambda_2^n\}$。
- 一方面，$X_1, X_2$ 线性无关；另一方面，考虑将一般的递推数列表示为 $X_1, X_2$ 的线性组合。
- 考虑利用前两项的信息，即方程组 $\begin{cases} k_1 + k_2 = x_0 \\ \lambda_1 k_1 + \lambda_2 k_2 = x_1 \end{cases}$，求得 $\begin{cases} k_1 = \dfrac{x_1 - x_0 \lambda_2}{\lambda_1 - \lambda_2} \\ k_2 = \dfrac{x_0 \lambda_1 - x_1}{\lambda_1 - \lambda_2} \end{cases}$。
- 进而可以归纳出 $\forall n \in \mathbb{N}, x_n = k_1 \lambda_1^n + k_2 \lambda_2^n$，即 $X = k_1 X_1 + k_2 X_2$。
- 故 $\forall X \in V$，$X$ 可以被线性无关组 $\{X_1, X_2\}$ 表出，则 $\dim V = 2$ 且 $\{X_1, X_2\}$ 为一组基。
- (2) 若其有**重根** $\lambda \in \mathbb{R}$，令 $X_1 = \{\lambda^n\}, X_2 = \{n \lambda^n\}$。
- (3) 若其有**不等**复根 $\lambda_1 = p + i q, \lambda_2 = p - i q$，其中 $p, q \in \mathbb{R}$，令 $X_1 = \{\operatorname{Re} \lambda_1^n\}, X_2 = \{\operatorname{Im} \lambda_1^n\}$。
- 对于 (2)(3)，易验证 $\dim V = 2$ 且 $\{X_1, X_2\}$ 为一组基，过程略去。

### 基变换与坐标变换

- **注意：这里与几何向量的坐标变换的区别在于它没有“平移不变性”，进而也没有“原点”的概念。**

#### 定义：过渡阵

考虑 $n$ 维线性空间 $V$ 中的两组基 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}, \{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$。

将后者用前者线性表出，记 $\mathbf{T} = (t_{i, j})_{n \times n}$ 为系数阵，则用形式上的矩阵乘法可以表示为：

$$
\begin{bmatrix} \boldsymbol{\varepsilon}_1 & \cdots & \boldsymbol{\varepsilon}_n \end{bmatrix} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \mathbf{T}
$$

若 $\mathbf{a} = \displaystyle\sum_{i = 1}^n a'_i \boldsymbol{\varepsilon}_i$，则：

$$
\mathbf{a} = \sum_{i = 1}^n a_i' \sum_{j = 1}^n \mathbf{e}_j t_{j, i} \\
= \sum_{j = 1}^n \mathbf{e}_j \sum_{i = 1}^n t_{j, i} a_i' \\
$$

故有 $\begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix} = \mathbf{T} \begin{pmatrix} a'_1 \\ \vdots \\ a'_n \end{pmatrix}$。而有趣的是，形式与实质在此时达成了统一：

$$
\begin{bmatrix} \boldsymbol{\varepsilon}_1 & \cdots & \boldsymbol{\varepsilon}_n \end{bmatrix} \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix} = (\begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} \mathbf{T}) \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix} = \begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} (\mathbf{T} \begin{pmatrix} a_1 \\ \vdots \\ a_n \end{pmatrix})
$$

同理，也存在一个系数阵 $\boldsymbol{\tau} = (\tau_{i, j})_{n \times n}$，使得：

$$
\begin{bmatrix} \mathbf{e}_1 & \cdots & \mathbf{e}_n \end{bmatrix} = \begin{bmatrix} \boldsymbol{\varepsilon}_1 & \cdots & \boldsymbol{\varepsilon}_n \end{bmatrix} \boldsymbol{\tau}
$$

由于“变换过来又变换回去总是不变”，我们要求 $\forall$ 列向量 $\mathbf{v} \in \mathbb{F}^n, \mathbf{v} = \boldsymbol{\tau}(\mathbf{T} \mathbf{v})$ 即 $(\boldsymbol{\tau} \mathbf{T}) \mathbf{v} = \mathbf{I}_n \mathbf{v}$，故 $\mathbf{T} \boldsymbol{\tau} = \mathbf{I}_n$，进而可知 $\mathbf{T}, \boldsymbol{\tau}$ 均非奇异且互为逆矩阵。

我们称 $\mathbf{T}$ 为从 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 到 $\{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$ 的过渡阵，反之称 $\boldsymbol{\tau}$ 为从 $\{\boldsymbol{\varepsilon}_1, \cdots, \boldsymbol{\varepsilon}_n\}$ 到 $\{\mathbf{e}_1, \cdots, \mathbf{e}_n\}$ 的过渡阵。

- 这里定义的“过渡阵”跟讨论几何向量的坐标变换时引入的过渡阵的含义是一致的。
